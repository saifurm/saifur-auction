var ES=t=>{throw TypeError(t)};var Ji=(t,e,n)=>e.has(t)?ES("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n);function TS(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function k_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var A_={exports:{}},ku={},b_={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ha=Symbol.for("react.element"),wS=Symbol.for("react.portal"),SS=Symbol.for("react.fragment"),CS=Symbol.for("react.strict_mode"),IS=Symbol.for("react.profiler"),RS=Symbol.for("react.provider"),xS=Symbol.for("react.context"),kS=Symbol.for("react.forward_ref"),AS=Symbol.for("react.suspense"),bS=Symbol.for("react.memo"),PS=Symbol.for("react.lazy"),Lm=Symbol.iterator;function NS(t){return t===null||typeof t!="object"?null:(t=Lm&&t[Lm]||t["@@iterator"],typeof t=="function"?t:null)}var P_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N_=Object.assign,D_={};function ki(t,e,n){this.props=t,this.context=e,this.refs=D_,this.updater=n||P_}ki.prototype.isReactComponent={};ki.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ki.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function V_(){}V_.prototype=ki.prototype;function Kh(t,e,n){this.props=t,this.context=e,this.refs=D_,this.updater=n||P_}var Qh=Kh.prototype=new V_;Qh.constructor=Kh;N_(Qh,ki.prototype);Qh.isPureReactComponent=!0;var jm=Array.isArray,M_=Object.prototype.hasOwnProperty,Yh={current:null},O_={key:!0,ref:!0,__self:!0,__source:!0};function L_(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)M_.call(e,r)&&!O_.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ha,type:t,key:i,ref:o,props:s,_owner:Yh.current}}function DS(t,e){return{$$typeof:ha,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Jh(t){return typeof t=="object"&&t!==null&&t.$$typeof===ha}function VS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Fm=/\/+/g;function Pc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?VS(""+t.key):e.toString(36)}function pl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ha:case wS:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Pc(o,0):r,jm(s)?(n="",t!=null&&(n=t.replace(Fm,"$&/")+"/"),pl(s,e,n,"",function(c){return c})):s!=null&&(Jh(s)&&(s=DS(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Fm,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",jm(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Pc(i,l);o+=pl(i,e,n,u,s)}else if(u=NS(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Pc(i,l++),o+=pl(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Wa(t,e,n){if(t==null)return t;var r=[],s=0;return pl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function MS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Lt={current:null},ml={transition:null},OS={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:ml,ReactCurrentOwner:Yh};function j_(){throw Error("act(...) is not supported in production builds of React.")}ge.Children={map:Wa,forEach:function(t,e,n){Wa(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Wa(t,function(){e++}),e},toArray:function(t){return Wa(t,function(e){return e})||[]},only:function(t){if(!Jh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ge.Component=ki;ge.Fragment=SS;ge.Profiler=IS;ge.PureComponent=Kh;ge.StrictMode=CS;ge.Suspense=AS;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OS;ge.act=j_;ge.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=N_({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Yh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)M_.call(e,u)&&!O_.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:ha,type:t.type,key:s,ref:i,props:r,_owner:o}};ge.createContext=function(t){return t={$$typeof:xS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:RS,_context:t},t.Consumer=t};ge.createElement=L_;ge.createFactory=function(t){var e=L_.bind(null,t);return e.type=t,e};ge.createRef=function(){return{current:null}};ge.forwardRef=function(t){return{$$typeof:kS,render:t}};ge.isValidElement=Jh;ge.lazy=function(t){return{$$typeof:PS,_payload:{_status:-1,_result:t},_init:MS}};ge.memo=function(t,e){return{$$typeof:bS,type:t,compare:e===void 0?null:e}};ge.startTransition=function(t){var e=ml.transition;ml.transition={};try{t()}finally{ml.transition=e}};ge.unstable_act=j_;ge.useCallback=function(t,e){return Lt.current.useCallback(t,e)};ge.useContext=function(t){return Lt.current.useContext(t)};ge.useDebugValue=function(){};ge.useDeferredValue=function(t){return Lt.current.useDeferredValue(t)};ge.useEffect=function(t,e){return Lt.current.useEffect(t,e)};ge.useId=function(){return Lt.current.useId()};ge.useImperativeHandle=function(t,e,n){return Lt.current.useImperativeHandle(t,e,n)};ge.useInsertionEffect=function(t,e){return Lt.current.useInsertionEffect(t,e)};ge.useLayoutEffect=function(t,e){return Lt.current.useLayoutEffect(t,e)};ge.useMemo=function(t,e){return Lt.current.useMemo(t,e)};ge.useReducer=function(t,e,n){return Lt.current.useReducer(t,e,n)};ge.useRef=function(t){return Lt.current.useRef(t)};ge.useState=function(t){return Lt.current.useState(t)};ge.useSyncExternalStore=function(t,e,n){return Lt.current.useSyncExternalStore(t,e,n)};ge.useTransition=function(){return Lt.current.useTransition()};ge.version="18.3.1";b_.exports=ge;var D=b_.exports;const LS=k_(D);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jS=D,FS=Symbol.for("react.element"),BS=Symbol.for("react.fragment"),US=Object.prototype.hasOwnProperty,$S=jS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zS={key:!0,ref:!0,__self:!0,__source:!0};function F_(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)US.call(e,r)&&!zS.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:FS,type:t,key:i,ref:o,props:s,_owner:$S.current}}ku.Fragment=BS;ku.jsx=F_;ku.jsxs=F_;A_.exports=ku;var g=A_.exports,md={},B_={exports:{}},ln={},U_={exports:{}},$_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,te){var H=$.length;$.push(te);e:for(;0<H;){var ce=H-1>>>1,le=$[ce];if(0<s(le,te))$[ce]=te,$[H]=le,H=ce;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var te=$[0],H=$.pop();if(H!==te){$[0]=H;e:for(var ce=0,le=$.length,de=le>>>1;ce<de;){var $e=2*(ce+1)-1,At=$[$e],gt=$e+1,rt=$[gt];if(0>s(At,H))gt<le&&0>s(rt,At)?($[ce]=rt,$[gt]=H,ce=gt):($[ce]=At,$[$e]=H,ce=$e);else if(gt<le&&0>s(rt,H))$[ce]=rt,$[gt]=H,ce=gt;else break e}}return te}function s($,te){var H=$.sortIndex-te.sortIndex;return H!==0?H:$.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],d=1,p=null,m=3,v=!1,R=!1,b=!1,V=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x($){for(var te=n(c);te!==null;){if(te.callback===null)r(c);else if(te.startTime<=$)r(c),te.sortIndex=te.expirationTime,e(u,te);else break;te=n(c)}}function L($){if(b=!1,x($),!R)if(n(u)!==null)R=!0,ne(z);else{var te=n(c);te!==null&&fe(L,te.startTime-$)}}function z($,te){R=!1,b&&(b=!1,w(_),_=-1),v=!0;var H=m;try{for(x(te),p=n(u);p!==null&&(!(p.expirationTime>te)||$&&!A());){var ce=p.callback;if(typeof ce=="function"){p.callback=null,m=p.priorityLevel;var le=ce(p.expirationTime<=te);te=t.unstable_now(),typeof le=="function"?p.callback=le:p===n(u)&&r(u),x(te)}else r(u);p=n(u)}if(p!==null)var de=!0;else{var $e=n(c);$e!==null&&fe(L,$e.startTime-te),de=!1}return de}finally{p=null,m=H,v=!1}}var B=!1,S=null,_=-1,C=5,I=-1;function A(){return!(t.unstable_now()-I<C)}function k(){if(S!==null){var $=t.unstable_now();I=$;var te=!0;try{te=S(!0,$)}finally{te?T():(B=!1,S=null)}}else B=!1}var T;if(typeof E=="function")T=function(){E(k)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,G=oe.port2;oe.port1.onmessage=k,T=function(){G.postMessage(null)}}else T=function(){V(k,0)};function ne($){S=$,B||(B=!0,T())}function fe($,te){_=V(function(){$(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){R||v||(R=!0,ne(z))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function($){switch(m){case 1:case 2:case 3:var te=3;break;default:te=m}var H=m;m=te;try{return $()}finally{m=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,te){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var H=m;m=$;try{return te()}finally{m=H}},t.unstable_scheduleCallback=function($,te,H){var ce=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?ce+H:ce):H=ce,$){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=H+le,$={id:d++,callback:te,priorityLevel:$,startTime:H,expirationTime:le,sortIndex:-1},H>ce?($.sortIndex=H,e(c,$),n(u)===null&&$===n(c)&&(b?(w(_),_=-1):b=!0,fe(L,H-ce))):($.sortIndex=le,e(u,$),R||v||(R=!0,ne(z))),$},t.unstable_shouldYield=A,t.unstable_wrapCallback=function($){var te=m;return function(){var H=m;m=te;try{return $.apply(this,arguments)}finally{m=H}}}})($_);U_.exports=$_;var qS=U_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WS=D,an=qS;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var z_=new Set,Lo={};function Ps(t,e){gi(t,e),gi(t+"Capture",e)}function gi(t,e){for(Lo[t]=e,t=0;t<e.length;t++)z_.add(e[t])}var Zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gd=Object.prototype.hasOwnProperty,HS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bm={},Um={};function GS(t){return gd.call(Um,t)?!0:gd.call(Bm,t)?!1:HS.test(t)?Um[t]=!0:(Bm[t]=!0,!1)}function KS(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function QS(t,e,n,r){if(e===null||typeof e>"u"||KS(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function jt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var pt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){pt[t]=new jt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];pt[e]=new jt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){pt[t]=new jt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){pt[t]=new jt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){pt[t]=new jt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){pt[t]=new jt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){pt[t]=new jt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){pt[t]=new jt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){pt[t]=new jt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Xh=/[\-:]([a-z])/g;function Zh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Xh,Zh);pt[e]=new jt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Xh,Zh);pt[e]=new jt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Xh,Zh);pt[e]=new jt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){pt[t]=new jt(t,1,!1,t.toLowerCase(),null,!1,!1)});pt.xlinkHref=new jt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){pt[t]=new jt(t,1,!1,t.toLowerCase(),null,!0,!0)});function ef(t,e,n,r){var s=pt.hasOwnProperty(e)?pt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(QS(e,n,s,r)&&(n=null),r||s===null?GS(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var lr=WS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ha=Symbol.for("react.element"),Qs=Symbol.for("react.portal"),Ys=Symbol.for("react.fragment"),tf=Symbol.for("react.strict_mode"),yd=Symbol.for("react.profiler"),q_=Symbol.for("react.provider"),W_=Symbol.for("react.context"),nf=Symbol.for("react.forward_ref"),_d=Symbol.for("react.suspense"),vd=Symbol.for("react.suspense_list"),rf=Symbol.for("react.memo"),yr=Symbol.for("react.lazy"),H_=Symbol.for("react.offscreen"),$m=Symbol.iterator;function Xi(t){return t===null||typeof t!="object"?null:(t=$m&&t[$m]||t["@@iterator"],typeof t=="function"?t:null)}var Be=Object.assign,Nc;function lo(t){if(Nc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Nc=e&&e[1]||""}return`
`+Nc+t}var Dc=!1;function Vc(t,e){if(!t||Dc)return"";Dc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Dc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?lo(t):""}function YS(t){switch(t.tag){case 5:return lo(t.type);case 16:return lo("Lazy");case 13:return lo("Suspense");case 19:return lo("SuspenseList");case 0:case 2:case 15:return t=Vc(t.type,!1),t;case 11:return t=Vc(t.type.render,!1),t;case 1:return t=Vc(t.type,!0),t;default:return""}}function Ed(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ys:return"Fragment";case Qs:return"Portal";case yd:return"Profiler";case tf:return"StrictMode";case _d:return"Suspense";case vd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case W_:return(t.displayName||"Context")+".Consumer";case q_:return(t._context.displayName||"Context")+".Provider";case nf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case rf:return e=t.displayName||null,e!==null?e:Ed(t.type)||"Memo";case yr:e=t._payload,t=t._init;try{return Ed(t(e))}catch{}}return null}function JS(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ed(e);case 8:return e===tf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Br(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function G_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function XS(t){var e=G_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ga(t){t._valueTracker||(t._valueTracker=XS(t))}function K_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=G_(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function jl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Td(t,e){var n=e.checked;return Be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function zm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Br(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Q_(t,e){e=e.checked,e!=null&&ef(t,"checked",e,!1)}function wd(t,e){Q_(t,e);var n=Br(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Sd(t,e.type,n):e.hasOwnProperty("defaultValue")&&Sd(t,e.type,Br(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function qm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Sd(t,e,n){(e!=="number"||jl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var uo=Array.isArray;function li(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Br(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Cd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return Be({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Wm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(uo(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Br(n)}}function Y_(t,e){var n=Br(e.value),r=Br(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Hm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function J_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Id(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?J_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ka,X_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ka=Ka||document.createElement("div"),Ka.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ka.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function jo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var vo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ZS=["Webkit","ms","Moz","O"];Object.keys(vo).forEach(function(t){ZS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),vo[e]=vo[t]})});function Z_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||vo.hasOwnProperty(t)&&vo[t]?(""+e).trim():e+"px"}function ev(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Z_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var eC=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rd(t,e){if(e){if(eC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function xd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kd=null;function sf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ad=null,ui=null,ci=null;function Gm(t){if(t=ma(t)){if(typeof Ad!="function")throw Error(U(280));var e=t.stateNode;e&&(e=Du(e),Ad(t.stateNode,t.type,e))}}function tv(t){ui?ci?ci.push(t):ci=[t]:ui=t}function nv(){if(ui){var t=ui,e=ci;if(ci=ui=null,Gm(t),e)for(t=0;t<e.length;t++)Gm(e[t])}}function rv(t,e){return t(e)}function sv(){}var Mc=!1;function iv(t,e,n){if(Mc)return t(e,n);Mc=!0;try{return rv(t,e,n)}finally{Mc=!1,(ui!==null||ci!==null)&&(sv(),nv())}}function Fo(t,e){var n=t.stateNode;if(n===null)return null;var r=Du(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var bd=!1;if(Zn)try{var Zi={};Object.defineProperty(Zi,"passive",{get:function(){bd=!0}}),window.addEventListener("test",Zi,Zi),window.removeEventListener("test",Zi,Zi)}catch{bd=!1}function tC(t,e,n,r,s,i,o,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var Eo=!1,Fl=null,Bl=!1,Pd=null,nC={onError:function(t){Eo=!0,Fl=t}};function rC(t,e,n,r,s,i,o,l,u){Eo=!1,Fl=null,tC.apply(nC,arguments)}function sC(t,e,n,r,s,i,o,l,u){if(rC.apply(this,arguments),Eo){if(Eo){var c=Fl;Eo=!1,Fl=null}else throw Error(U(198));Bl||(Bl=!0,Pd=c)}}function Ns(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function ov(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Km(t){if(Ns(t)!==t)throw Error(U(188))}function iC(t){var e=t.alternate;if(!e){if(e=Ns(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Km(s),t;if(i===r)return Km(s),e;i=i.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function av(t){return t=iC(t),t!==null?lv(t):null}function lv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lv(t);if(e!==null)return e;t=t.sibling}return null}var uv=an.unstable_scheduleCallback,Qm=an.unstable_cancelCallback,oC=an.unstable_shouldYield,aC=an.unstable_requestPaint,Ge=an.unstable_now,lC=an.unstable_getCurrentPriorityLevel,of=an.unstable_ImmediatePriority,cv=an.unstable_UserBlockingPriority,Ul=an.unstable_NormalPriority,uC=an.unstable_LowPriority,dv=an.unstable_IdlePriority,Au=null,Dn=null;function cC(t){if(Dn&&typeof Dn.onCommitFiberRoot=="function")try{Dn.onCommitFiberRoot(Au,t,void 0,(t.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:fC,dC=Math.log,hC=Math.LN2;function fC(t){return t>>>=0,t===0?32:31-(dC(t)/hC|0)|0}var Qa=64,Ya=4194304;function co(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function $l(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=co(l):(i&=o,i!==0&&(r=co(i)))}else o=n&~s,o!==0?r=co(o):i!==0&&(r=co(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-wn(e),s=1<<n,r|=t[n],e&=~s;return r}function pC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mC(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-wn(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=pC(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Nd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function hv(){var t=Qa;return Qa<<=1,!(Qa&4194240)&&(Qa=64),t}function Oc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function fa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-wn(e),t[e]=n}function gC(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-wn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function af(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-wn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ie=0;function fv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pv,lf,mv,gv,yv,Dd=!1,Ja=[],Ir=null,Rr=null,xr=null,Bo=new Map,Uo=new Map,vr=[],yC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ym(t,e){switch(t){case"focusin":case"focusout":Ir=null;break;case"dragenter":case"dragleave":Rr=null;break;case"mouseover":case"mouseout":xr=null;break;case"pointerover":case"pointerout":Bo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uo.delete(e.pointerId)}}function eo(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=ma(e),e!==null&&lf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function _C(t,e,n,r,s){switch(e){case"focusin":return Ir=eo(Ir,t,e,n,r,s),!0;case"dragenter":return Rr=eo(Rr,t,e,n,r,s),!0;case"mouseover":return xr=eo(xr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Bo.set(i,eo(Bo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Uo.set(i,eo(Uo.get(i)||null,t,e,n,r,s)),!0}return!1}function _v(t){var e=fs(t.target);if(e!==null){var n=Ns(e);if(n!==null){if(e=n.tag,e===13){if(e=ov(n),e!==null){t.blockedOn=e,yv(t.priority,function(){mv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function gl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Vd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);kd=r,n.target.dispatchEvent(r),kd=null}else return e=ma(n),e!==null&&lf(e),t.blockedOn=n,!1;e.shift()}return!0}function Jm(t,e,n){gl(t)&&n.delete(e)}function vC(){Dd=!1,Ir!==null&&gl(Ir)&&(Ir=null),Rr!==null&&gl(Rr)&&(Rr=null),xr!==null&&gl(xr)&&(xr=null),Bo.forEach(Jm),Uo.forEach(Jm)}function to(t,e){t.blockedOn===e&&(t.blockedOn=null,Dd||(Dd=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,vC)))}function $o(t){function e(s){return to(s,t)}if(0<Ja.length){to(Ja[0],t);for(var n=1;n<Ja.length;n++){var r=Ja[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ir!==null&&to(Ir,t),Rr!==null&&to(Rr,t),xr!==null&&to(xr,t),Bo.forEach(e),Uo.forEach(e),n=0;n<vr.length;n++)r=vr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<vr.length&&(n=vr[0],n.blockedOn===null);)_v(n),n.blockedOn===null&&vr.shift()}var di=lr.ReactCurrentBatchConfig,zl=!0;function EC(t,e,n,r){var s=Ie,i=di.transition;di.transition=null;try{Ie=1,uf(t,e,n,r)}finally{Ie=s,di.transition=i}}function TC(t,e,n,r){var s=Ie,i=di.transition;di.transition=null;try{Ie=4,uf(t,e,n,r)}finally{Ie=s,di.transition=i}}function uf(t,e,n,r){if(zl){var s=Vd(t,e,n,r);if(s===null)Hc(t,e,r,ql,n),Ym(t,r);else if(_C(s,t,e,n,r))r.stopPropagation();else if(Ym(t,r),e&4&&-1<yC.indexOf(t)){for(;s!==null;){var i=ma(s);if(i!==null&&pv(i),i=Vd(t,e,n,r),i===null&&Hc(t,e,r,ql,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Hc(t,e,r,null,n)}}var ql=null;function Vd(t,e,n,r){if(ql=null,t=sf(r),t=fs(t),t!==null)if(e=Ns(t),e===null)t=null;else if(n=e.tag,n===13){if(t=ov(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ql=t,null}function vv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lC()){case of:return 1;case cv:return 4;case Ul:case uC:return 16;case dv:return 536870912;default:return 16}default:return 16}}var Tr=null,cf=null,yl=null;function Ev(){if(yl)return yl;var t,e=cf,n=e.length,r,s="value"in Tr?Tr.value:Tr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return yl=s.slice(t,1<r?1-r:void 0)}function _l(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Xa(){return!0}function Xm(){return!1}function un(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Xa:Xm,this.isPropagationStopped=Xm,this}return Be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Xa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Xa)},persist:function(){},isPersistent:Xa}),e}var Ai={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},df=un(Ai),pa=Be({},Ai,{view:0,detail:0}),wC=un(pa),Lc,jc,no,bu=Be({},pa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==no&&(no&&t.type==="mousemove"?(Lc=t.screenX-no.screenX,jc=t.screenY-no.screenY):jc=Lc=0,no=t),Lc)},movementY:function(t){return"movementY"in t?t.movementY:jc}}),Zm=un(bu),SC=Be({},bu,{dataTransfer:0}),CC=un(SC),IC=Be({},pa,{relatedTarget:0}),Fc=un(IC),RC=Be({},Ai,{animationName:0,elapsedTime:0,pseudoElement:0}),xC=un(RC),kC=Be({},Ai,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),AC=un(kC),bC=Be({},Ai,{data:0}),eg=un(bC),PC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},DC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function VC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=DC[t])?!!e[t]:!1}function hf(){return VC}var MC=Be({},pa,{key:function(t){if(t.key){var e=PC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=_l(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?NC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hf,charCode:function(t){return t.type==="keypress"?_l(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?_l(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),OC=un(MC),LC=Be({},bu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tg=un(LC),jC=Be({},pa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hf}),FC=un(jC),BC=Be({},Ai,{propertyName:0,elapsedTime:0,pseudoElement:0}),UC=un(BC),$C=Be({},bu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),zC=un($C),qC=[9,13,27,32],ff=Zn&&"CompositionEvent"in window,To=null;Zn&&"documentMode"in document&&(To=document.documentMode);var WC=Zn&&"TextEvent"in window&&!To,Tv=Zn&&(!ff||To&&8<To&&11>=To),ng=" ",rg=!1;function wv(t,e){switch(t){case"keyup":return qC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sv(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Js=!1;function HC(t,e){switch(t){case"compositionend":return Sv(e);case"keypress":return e.which!==32?null:(rg=!0,ng);case"textInput":return t=e.data,t===ng&&rg?null:t;default:return null}}function GC(t,e){if(Js)return t==="compositionend"||!ff&&wv(t,e)?(t=Ev(),yl=cf=Tr=null,Js=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Tv&&e.locale!=="ko"?null:e.data;default:return null}}var KC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!KC[t.type]:e==="textarea"}function Cv(t,e,n,r){tv(r),e=Wl(e,"onChange"),0<e.length&&(n=new df("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var wo=null,zo=null;function QC(t){Mv(t,0)}function Pu(t){var e=ei(t);if(K_(e))return t}function YC(t,e){if(t==="change")return e}var Iv=!1;if(Zn){var Bc;if(Zn){var Uc="oninput"in document;if(!Uc){var ig=document.createElement("div");ig.setAttribute("oninput","return;"),Uc=typeof ig.oninput=="function"}Bc=Uc}else Bc=!1;Iv=Bc&&(!document.documentMode||9<document.documentMode)}function og(){wo&&(wo.detachEvent("onpropertychange",Rv),zo=wo=null)}function Rv(t){if(t.propertyName==="value"&&Pu(zo)){var e=[];Cv(e,zo,t,sf(t)),iv(QC,e)}}function JC(t,e,n){t==="focusin"?(og(),wo=e,zo=n,wo.attachEvent("onpropertychange",Rv)):t==="focusout"&&og()}function XC(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Pu(zo)}function ZC(t,e){if(t==="click")return Pu(e)}function e1(t,e){if(t==="input"||t==="change")return Pu(e)}function t1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Cn=typeof Object.is=="function"?Object.is:t1;function qo(t,e){if(Cn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!gd.call(e,s)||!Cn(t[s],e[s]))return!1}return!0}function ag(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function lg(t,e){var n=ag(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ag(n)}}function xv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?xv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function kv(){for(var t=window,e=jl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=jl(t.document)}return e}function pf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function n1(t){var e=kv(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&xv(n.ownerDocument.documentElement,n)){if(r!==null&&pf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=lg(n,i);var o=lg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var r1=Zn&&"documentMode"in document&&11>=document.documentMode,Xs=null,Md=null,So=null,Od=!1;function ug(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Od||Xs==null||Xs!==jl(r)||(r=Xs,"selectionStart"in r&&pf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),So&&qo(So,r)||(So=r,r=Wl(Md,"onSelect"),0<r.length&&(e=new df("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xs)))}function Za(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Zs={animationend:Za("Animation","AnimationEnd"),animationiteration:Za("Animation","AnimationIteration"),animationstart:Za("Animation","AnimationStart"),transitionend:Za("Transition","TransitionEnd")},$c={},Av={};Zn&&(Av=document.createElement("div").style,"AnimationEvent"in window||(delete Zs.animationend.animation,delete Zs.animationiteration.animation,delete Zs.animationstart.animation),"TransitionEvent"in window||delete Zs.transitionend.transition);function Nu(t){if($c[t])return $c[t];if(!Zs[t])return t;var e=Zs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Av)return $c[t]=e[n];return t}var bv=Nu("animationend"),Pv=Nu("animationiteration"),Nv=Nu("animationstart"),Dv=Nu("transitionend"),Vv=new Map,cg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yr(t,e){Vv.set(t,e),Ps(e,[t])}for(var zc=0;zc<cg.length;zc++){var qc=cg[zc],s1=qc.toLowerCase(),i1=qc[0].toUpperCase()+qc.slice(1);Yr(s1,"on"+i1)}Yr(bv,"onAnimationEnd");Yr(Pv,"onAnimationIteration");Yr(Nv,"onAnimationStart");Yr("dblclick","onDoubleClick");Yr("focusin","onFocus");Yr("focusout","onBlur");Yr(Dv,"onTransitionEnd");gi("onMouseEnter",["mouseout","mouseover"]);gi("onMouseLeave",["mouseout","mouseover"]);gi("onPointerEnter",["pointerout","pointerover"]);gi("onPointerLeave",["pointerout","pointerover"]);Ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ps("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),o1=new Set("cancel close invalid load scroll toggle".split(" ").concat(ho));function dg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,sC(r,e,void 0,t),t.currentTarget=null}function Mv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;dg(s,l,c),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,c=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;dg(s,l,c),i=u}}}if(Bl)throw t=Pd,Bl=!1,Pd=null,t}function Ne(t,e){var n=e[Ud];n===void 0&&(n=e[Ud]=new Set);var r=t+"__bubble";n.has(r)||(Ov(e,t,2,!1),n.add(r))}function Wc(t,e,n){var r=0;e&&(r|=4),Ov(n,t,r,e)}var el="_reactListening"+Math.random().toString(36).slice(2);function Wo(t){if(!t[el]){t[el]=!0,z_.forEach(function(n){n!=="selectionchange"&&(o1.has(n)||Wc(n,!1,t),Wc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[el]||(e[el]=!0,Wc("selectionchange",!1,e))}}function Ov(t,e,n,r){switch(vv(e)){case 1:var s=EC;break;case 4:s=TC;break;default:s=uf}n=s.bind(null,e,n,t),s=void 0,!bd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Hc(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=fs(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}iv(function(){var c=i,d=sf(n),p=[];e:{var m=Vv.get(t);if(m!==void 0){var v=df,R=t;switch(t){case"keypress":if(_l(n)===0)break e;case"keydown":case"keyup":v=OC;break;case"focusin":R="focus",v=Fc;break;case"focusout":R="blur",v=Fc;break;case"beforeblur":case"afterblur":v=Fc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Zm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=CC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=FC;break;case bv:case Pv:case Nv:v=xC;break;case Dv:v=UC;break;case"scroll":v=wC;break;case"wheel":v=zC;break;case"copy":case"cut":case"paste":v=AC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=tg}var b=(e&4)!==0,V=!b&&t==="scroll",w=b?m!==null?m+"Capture":null:m;b=[];for(var E=c,x;E!==null;){x=E;var L=x.stateNode;if(x.tag===5&&L!==null&&(x=L,w!==null&&(L=Fo(E,w),L!=null&&b.push(Ho(E,L,x)))),V)break;E=E.return}0<b.length&&(m=new v(m,R,null,n,d),p.push({event:m,listeners:b}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",m&&n!==kd&&(R=n.relatedTarget||n.fromElement)&&(fs(R)||R[er]))break e;if((v||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,v?(R=n.relatedTarget||n.toElement,v=c,R=R?fs(R):null,R!==null&&(V=Ns(R),R!==V||R.tag!==5&&R.tag!==6)&&(R=null)):(v=null,R=c),v!==R)){if(b=Zm,L="onMouseLeave",w="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(b=tg,L="onPointerLeave",w="onPointerEnter",E="pointer"),V=v==null?m:ei(v),x=R==null?m:ei(R),m=new b(L,E+"leave",v,n,d),m.target=V,m.relatedTarget=x,L=null,fs(d)===c&&(b=new b(w,E+"enter",R,n,d),b.target=x,b.relatedTarget=V,L=b),V=L,v&&R)t:{for(b=v,w=R,E=0,x=b;x;x=zs(x))E++;for(x=0,L=w;L;L=zs(L))x++;for(;0<E-x;)b=zs(b),E--;for(;0<x-E;)w=zs(w),x--;for(;E--;){if(b===w||w!==null&&b===w.alternate)break t;b=zs(b),w=zs(w)}b=null}else b=null;v!==null&&hg(p,m,v,b,!1),R!==null&&V!==null&&hg(p,V,R,b,!0)}}e:{if(m=c?ei(c):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var z=YC;else if(sg(m))if(Iv)z=e1;else{z=XC;var B=JC}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(z=ZC);if(z&&(z=z(t,c))){Cv(p,z,n,d);break e}B&&B(t,m,c),t==="focusout"&&(B=m._wrapperState)&&B.controlled&&m.type==="number"&&Sd(m,"number",m.value)}switch(B=c?ei(c):window,t){case"focusin":(sg(B)||B.contentEditable==="true")&&(Xs=B,Md=c,So=null);break;case"focusout":So=Md=Xs=null;break;case"mousedown":Od=!0;break;case"contextmenu":case"mouseup":case"dragend":Od=!1,ug(p,n,d);break;case"selectionchange":if(r1)break;case"keydown":case"keyup":ug(p,n,d)}var S;if(ff)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Js?wv(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(Tv&&n.locale!=="ko"&&(Js||_!=="onCompositionStart"?_==="onCompositionEnd"&&Js&&(S=Ev()):(Tr=d,cf="value"in Tr?Tr.value:Tr.textContent,Js=!0)),B=Wl(c,_),0<B.length&&(_=new eg(_,t,null,n,d),p.push({event:_,listeners:B}),S?_.data=S:(S=Sv(n),S!==null&&(_.data=S)))),(S=WC?HC(t,n):GC(t,n))&&(c=Wl(c,"onBeforeInput"),0<c.length&&(d=new eg("onBeforeInput","beforeinput",null,n,d),p.push({event:d,listeners:c}),d.data=S))}Mv(p,e)})}function Ho(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Wl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Fo(t,n),i!=null&&r.unshift(Ho(t,i,s)),i=Fo(t,e),i!=null&&r.push(Ho(t,i,s))),t=t.return}return r}function zs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function hg(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,c=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&c!==null&&(l=c,s?(u=Fo(n,i),u!=null&&o.unshift(Ho(n,u,l))):s||(u=Fo(n,i),u!=null&&o.push(Ho(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var a1=/\r\n?/g,l1=/\u0000|\uFFFD/g;function fg(t){return(typeof t=="string"?t:""+t).replace(a1,`
`).replace(l1,"")}function tl(t,e,n){if(e=fg(e),fg(t)!==e&&n)throw Error(U(425))}function Hl(){}var Ld=null,jd=null;function Fd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Bd=typeof setTimeout=="function"?setTimeout:void 0,u1=typeof clearTimeout=="function"?clearTimeout:void 0,pg=typeof Promise=="function"?Promise:void 0,c1=typeof queueMicrotask=="function"?queueMicrotask:typeof pg<"u"?function(t){return pg.resolve(null).then(t).catch(d1)}:Bd;function d1(t){setTimeout(function(){throw t})}function Gc(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),$o(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);$o(e)}function kr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function mg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var bi=Math.random().toString(36).slice(2),Nn="__reactFiber$"+bi,Go="__reactProps$"+bi,er="__reactContainer$"+bi,Ud="__reactEvents$"+bi,h1="__reactListeners$"+bi,f1="__reactHandles$"+bi;function fs(t){var e=t[Nn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[er]||n[Nn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=mg(t);t!==null;){if(n=t[Nn])return n;t=mg(t)}return e}t=n,n=t.parentNode}return null}function ma(t){return t=t[Nn]||t[er],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ei(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function Du(t){return t[Go]||null}var $d=[],ti=-1;function Jr(t){return{current:t}}function De(t){0>ti||(t.current=$d[ti],$d[ti]=null,ti--)}function Ae(t,e){ti++,$d[ti]=t.current,t.current=e}var Ur={},xt=Jr(Ur),qt=Jr(!1),ws=Ur;function yi(t,e){var n=t.type.contextTypes;if(!n)return Ur;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Wt(t){return t=t.childContextTypes,t!=null}function Gl(){De(qt),De(xt)}function gg(t,e,n){if(xt.current!==Ur)throw Error(U(168));Ae(xt,e),Ae(qt,n)}function Lv(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,JS(t)||"Unknown",s));return Be({},n,r)}function Kl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ur,ws=xt.current,Ae(xt,t),Ae(qt,qt.current),!0}function yg(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=Lv(t,e,ws),r.__reactInternalMemoizedMergedChildContext=t,De(qt),De(xt),Ae(xt,t)):De(qt),Ae(qt,n)}var Qn=null,Vu=!1,Kc=!1;function jv(t){Qn===null?Qn=[t]:Qn.push(t)}function p1(t){Vu=!0,jv(t)}function Xr(){if(!Kc&&Qn!==null){Kc=!0;var t=0,e=Ie;try{var n=Qn;for(Ie=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Qn=null,Vu=!1}catch(s){throw Qn!==null&&(Qn=Qn.slice(t+1)),uv(of,Xr),s}finally{Ie=e,Kc=!1}}return null}var ni=[],ri=0,Ql=null,Yl=0,cn=[],dn=0,Ss=null,Yn=1,Jn="";function us(t,e){ni[ri++]=Yl,ni[ri++]=Ql,Ql=t,Yl=e}function Fv(t,e,n){cn[dn++]=Yn,cn[dn++]=Jn,cn[dn++]=Ss,Ss=t;var r=Yn;t=Jn;var s=32-wn(r)-1;r&=~(1<<s),n+=1;var i=32-wn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Yn=1<<32-wn(e)+s|n<<s|r,Jn=i+t}else Yn=1<<i|n<<s|r,Jn=t}function mf(t){t.return!==null&&(us(t,1),Fv(t,1,0))}function gf(t){for(;t===Ql;)Ql=ni[--ri],ni[ri]=null,Yl=ni[--ri],ni[ri]=null;for(;t===Ss;)Ss=cn[--dn],cn[dn]=null,Jn=cn[--dn],cn[dn]=null,Yn=cn[--dn],cn[dn]=null}var rn=null,tn=null,Me=!1,Tn=null;function Bv(t,e){var n=hn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function _g(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,rn=t,tn=kr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,rn=t,tn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ss!==null?{id:Yn,overflow:Jn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=hn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,rn=t,tn=null,!0):!1;default:return!1}}function zd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function qd(t){if(Me){var e=tn;if(e){var n=e;if(!_g(t,e)){if(zd(t))throw Error(U(418));e=kr(n.nextSibling);var r=rn;e&&_g(t,e)?Bv(r,n):(t.flags=t.flags&-4097|2,Me=!1,rn=t)}}else{if(zd(t))throw Error(U(418));t.flags=t.flags&-4097|2,Me=!1,rn=t}}}function vg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;rn=t}function nl(t){if(t!==rn)return!1;if(!Me)return vg(t),Me=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Fd(t.type,t.memoizedProps)),e&&(e=tn)){if(zd(t))throw Uv(),Error(U(418));for(;e;)Bv(t,e),e=kr(e.nextSibling)}if(vg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){tn=kr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}tn=null}}else tn=rn?kr(t.stateNode.nextSibling):null;return!0}function Uv(){for(var t=tn;t;)t=kr(t.nextSibling)}function _i(){tn=rn=null,Me=!1}function yf(t){Tn===null?Tn=[t]:Tn.push(t)}var m1=lr.ReactCurrentBatchConfig;function ro(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function rl(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Eg(t){var e=t._init;return e(t._payload)}function $v(t){function e(w,E){if(t){var x=w.deletions;x===null?(w.deletions=[E],w.flags|=16):x.push(E)}}function n(w,E){if(!t)return null;for(;E!==null;)e(w,E),E=E.sibling;return null}function r(w,E){for(w=new Map;E!==null;)E.key!==null?w.set(E.key,E):w.set(E.index,E),E=E.sibling;return w}function s(w,E){return w=Nr(w,E),w.index=0,w.sibling=null,w}function i(w,E,x){return w.index=x,t?(x=w.alternate,x!==null?(x=x.index,x<E?(w.flags|=2,E):x):(w.flags|=2,E)):(w.flags|=1048576,E)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function l(w,E,x,L){return E===null||E.tag!==6?(E=td(x,w.mode,L),E.return=w,E):(E=s(E,x),E.return=w,E)}function u(w,E,x,L){var z=x.type;return z===Ys?d(w,E,x.props.children,L,x.key):E!==null&&(E.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===yr&&Eg(z)===E.type)?(L=s(E,x.props),L.ref=ro(w,E,x),L.return=w,L):(L=Il(x.type,x.key,x.props,null,w.mode,L),L.ref=ro(w,E,x),L.return=w,L)}function c(w,E,x,L){return E===null||E.tag!==4||E.stateNode.containerInfo!==x.containerInfo||E.stateNode.implementation!==x.implementation?(E=nd(x,w.mode,L),E.return=w,E):(E=s(E,x.children||[]),E.return=w,E)}function d(w,E,x,L,z){return E===null||E.tag!==7?(E=vs(x,w.mode,L,z),E.return=w,E):(E=s(E,x),E.return=w,E)}function p(w,E,x){if(typeof E=="string"&&E!==""||typeof E=="number")return E=td(""+E,w.mode,x),E.return=w,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ha:return x=Il(E.type,E.key,E.props,null,w.mode,x),x.ref=ro(w,null,E),x.return=w,x;case Qs:return E=nd(E,w.mode,x),E.return=w,E;case yr:var L=E._init;return p(w,L(E._payload),x)}if(uo(E)||Xi(E))return E=vs(E,w.mode,x,null),E.return=w,E;rl(w,E)}return null}function m(w,E,x,L){var z=E!==null?E.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return z!==null?null:l(w,E,""+x,L);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ha:return x.key===z?u(w,E,x,L):null;case Qs:return x.key===z?c(w,E,x,L):null;case yr:return z=x._init,m(w,E,z(x._payload),L)}if(uo(x)||Xi(x))return z!==null?null:d(w,E,x,L,null);rl(w,x)}return null}function v(w,E,x,L,z){if(typeof L=="string"&&L!==""||typeof L=="number")return w=w.get(x)||null,l(E,w,""+L,z);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case Ha:return w=w.get(L.key===null?x:L.key)||null,u(E,w,L,z);case Qs:return w=w.get(L.key===null?x:L.key)||null,c(E,w,L,z);case yr:var B=L._init;return v(w,E,x,B(L._payload),z)}if(uo(L)||Xi(L))return w=w.get(x)||null,d(E,w,L,z,null);rl(E,L)}return null}function R(w,E,x,L){for(var z=null,B=null,S=E,_=E=0,C=null;S!==null&&_<x.length;_++){S.index>_?(C=S,S=null):C=S.sibling;var I=m(w,S,x[_],L);if(I===null){S===null&&(S=C);break}t&&S&&I.alternate===null&&e(w,S),E=i(I,E,_),B===null?z=I:B.sibling=I,B=I,S=C}if(_===x.length)return n(w,S),Me&&us(w,_),z;if(S===null){for(;_<x.length;_++)S=p(w,x[_],L),S!==null&&(E=i(S,E,_),B===null?z=S:B.sibling=S,B=S);return Me&&us(w,_),z}for(S=r(w,S);_<x.length;_++)C=v(S,w,_,x[_],L),C!==null&&(t&&C.alternate!==null&&S.delete(C.key===null?_:C.key),E=i(C,E,_),B===null?z=C:B.sibling=C,B=C);return t&&S.forEach(function(A){return e(w,A)}),Me&&us(w,_),z}function b(w,E,x,L){var z=Xi(x);if(typeof z!="function")throw Error(U(150));if(x=z.call(x),x==null)throw Error(U(151));for(var B=z=null,S=E,_=E=0,C=null,I=x.next();S!==null&&!I.done;_++,I=x.next()){S.index>_?(C=S,S=null):C=S.sibling;var A=m(w,S,I.value,L);if(A===null){S===null&&(S=C);break}t&&S&&A.alternate===null&&e(w,S),E=i(A,E,_),B===null?z=A:B.sibling=A,B=A,S=C}if(I.done)return n(w,S),Me&&us(w,_),z;if(S===null){for(;!I.done;_++,I=x.next())I=p(w,I.value,L),I!==null&&(E=i(I,E,_),B===null?z=I:B.sibling=I,B=I);return Me&&us(w,_),z}for(S=r(w,S);!I.done;_++,I=x.next())I=v(S,w,_,I.value,L),I!==null&&(t&&I.alternate!==null&&S.delete(I.key===null?_:I.key),E=i(I,E,_),B===null?z=I:B.sibling=I,B=I);return t&&S.forEach(function(k){return e(w,k)}),Me&&us(w,_),z}function V(w,E,x,L){if(typeof x=="object"&&x!==null&&x.type===Ys&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Ha:e:{for(var z=x.key,B=E;B!==null;){if(B.key===z){if(z=x.type,z===Ys){if(B.tag===7){n(w,B.sibling),E=s(B,x.props.children),E.return=w,w=E;break e}}else if(B.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===yr&&Eg(z)===B.type){n(w,B.sibling),E=s(B,x.props),E.ref=ro(w,B,x),E.return=w,w=E;break e}n(w,B);break}else e(w,B);B=B.sibling}x.type===Ys?(E=vs(x.props.children,w.mode,L,x.key),E.return=w,w=E):(L=Il(x.type,x.key,x.props,null,w.mode,L),L.ref=ro(w,E,x),L.return=w,w=L)}return o(w);case Qs:e:{for(B=x.key;E!==null;){if(E.key===B)if(E.tag===4&&E.stateNode.containerInfo===x.containerInfo&&E.stateNode.implementation===x.implementation){n(w,E.sibling),E=s(E,x.children||[]),E.return=w,w=E;break e}else{n(w,E);break}else e(w,E);E=E.sibling}E=nd(x,w.mode,L),E.return=w,w=E}return o(w);case yr:return B=x._init,V(w,E,B(x._payload),L)}if(uo(x))return R(w,E,x,L);if(Xi(x))return b(w,E,x,L);rl(w,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,E!==null&&E.tag===6?(n(w,E.sibling),E=s(E,x),E.return=w,w=E):(n(w,E),E=td(x,w.mode,L),E.return=w,w=E),o(w)):n(w,E)}return V}var vi=$v(!0),zv=$v(!1),Jl=Jr(null),Xl=null,si=null,_f=null;function vf(){_f=si=Xl=null}function Ef(t){var e=Jl.current;De(Jl),t._currentValue=e}function Wd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function hi(t,e){Xl=t,_f=si=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(zt=!0),t.firstContext=null)}function pn(t){var e=t._currentValue;if(_f!==t)if(t={context:t,memoizedValue:e,next:null},si===null){if(Xl===null)throw Error(U(308));si=t,Xl.dependencies={lanes:0,firstContext:t}}else si=si.next=t;return e}var ps=null;function Tf(t){ps===null?ps=[t]:ps.push(t)}function qv(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Tf(e)):(n.next=s.next,s.next=n),e.interleaved=n,tr(t,r)}function tr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var _r=!1;function wf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Xn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ar(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Te&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,tr(t,n)}return s=r.interleaved,s===null?(e.next=e,Tf(r)):(e.next=s.next,s.next=e),r.interleaved=e,tr(t,n)}function vl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,af(t,n)}}function Tg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Zl(t,e,n,r){var s=t.updateQueue;_r=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,c=u.next;u.next=null,o===null?i=c:o.next=c,o=u;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u))}if(i!==null){var p=s.baseState;o=0,d=c=u=null,l=i;do{var m=l.lane,v=l.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=t,b=l;switch(m=e,v=n,b.tag){case 1:if(R=b.payload,typeof R=="function"){p=R.call(v,p,m);break e}p=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=b.payload,m=typeof R=="function"?R.call(v,p,m):R,m==null)break e;p=Be({},p,m);break e;case 2:_r=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else v={eventTime:v,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(c=d=v,u=p):d=d.next=v,o|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(d===null&&(u=p),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Is|=o,t.lanes=o,t.memoizedState=p}}function wg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var ga={},Vn=Jr(ga),Ko=Jr(ga),Qo=Jr(ga);function ms(t){if(t===ga)throw Error(U(174));return t}function Sf(t,e){switch(Ae(Qo,e),Ae(Ko,t),Ae(Vn,ga),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Id(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Id(e,t)}De(Vn),Ae(Vn,e)}function Ei(){De(Vn),De(Ko),De(Qo)}function Hv(t){ms(Qo.current);var e=ms(Vn.current),n=Id(e,t.type);e!==n&&(Ae(Ko,t),Ae(Vn,n))}function Cf(t){Ko.current===t&&(De(Vn),De(Ko))}var Le=Jr(0);function eu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Qc=[];function If(){for(var t=0;t<Qc.length;t++)Qc[t]._workInProgressVersionPrimary=null;Qc.length=0}var El=lr.ReactCurrentDispatcher,Yc=lr.ReactCurrentBatchConfig,Cs=0,Fe=null,et=null,it=null,tu=!1,Co=!1,Yo=0,g1=0;function Tt(){throw Error(U(321))}function Rf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Cn(t[n],e[n]))return!1;return!0}function xf(t,e,n,r,s,i){if(Cs=i,Fe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,El.current=t===null||t.memoizedState===null?E1:T1,t=n(r,s),Co){i=0;do{if(Co=!1,Yo=0,25<=i)throw Error(U(301));i+=1,it=et=null,e.updateQueue=null,El.current=w1,t=n(r,s)}while(Co)}if(El.current=nu,e=et!==null&&et.next!==null,Cs=0,it=et=Fe=null,tu=!1,e)throw Error(U(300));return t}function kf(){var t=Yo!==0;return Yo=0,t}function bn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return it===null?Fe.memoizedState=it=t:it=it.next=t,it}function mn(){if(et===null){var t=Fe.alternate;t=t!==null?t.memoizedState:null}else t=et.next;var e=it===null?Fe.memoizedState:it.next;if(e!==null)it=e,et=t;else{if(t===null)throw Error(U(310));et=t,t={memoizedState:et.memoizedState,baseState:et.baseState,baseQueue:et.baseQueue,queue:et.queue,next:null},it===null?Fe.memoizedState=it=t:it=it.next=t}return it}function Jo(t,e){return typeof e=="function"?e(t):e}function Jc(t){var e=mn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=et,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,c=i;do{var d=c.lane;if((Cs&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var p={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=p,o=r):u=u.next=p,Fe.lanes|=d,Is|=d}c=c.next}while(c!==null&&c!==i);u===null?o=r:u.next=l,Cn(r,e.memoizedState)||(zt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Fe.lanes|=i,Is|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Xc(t){var e=mn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Cn(i,e.memoizedState)||(zt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Gv(){}function Kv(t,e){var n=Fe,r=mn(),s=e(),i=!Cn(r.memoizedState,s);if(i&&(r.memoizedState=s,zt=!0),r=r.queue,Af(Jv.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||it!==null&&it.memoizedState.tag&1){if(n.flags|=2048,Xo(9,Yv.bind(null,n,r,s,e),void 0,null),at===null)throw Error(U(349));Cs&30||Qv(n,e,s)}return s}function Qv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Fe.updateQueue,e===null?(e={lastEffect:null,stores:null},Fe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Yv(t,e,n,r){e.value=n,e.getSnapshot=r,Xv(e)&&Zv(t)}function Jv(t,e,n){return n(function(){Xv(e)&&Zv(t)})}function Xv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Cn(t,n)}catch{return!0}}function Zv(t){var e=tr(t,1);e!==null&&Sn(e,t,1,-1)}function Sg(t){var e=bn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jo,lastRenderedState:t},e.queue=t,t=t.dispatch=v1.bind(null,Fe,t),[e.memoizedState,t]}function Xo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Fe.updateQueue,e===null?(e={lastEffect:null,stores:null},Fe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function e0(){return mn().memoizedState}function Tl(t,e,n,r){var s=bn();Fe.flags|=t,s.memoizedState=Xo(1|e,n,void 0,r===void 0?null:r)}function Mu(t,e,n,r){var s=mn();r=r===void 0?null:r;var i=void 0;if(et!==null){var o=et.memoizedState;if(i=o.destroy,r!==null&&Rf(r,o.deps)){s.memoizedState=Xo(e,n,i,r);return}}Fe.flags|=t,s.memoizedState=Xo(1|e,n,i,r)}function Cg(t,e){return Tl(8390656,8,t,e)}function Af(t,e){return Mu(2048,8,t,e)}function t0(t,e){return Mu(4,2,t,e)}function n0(t,e){return Mu(4,4,t,e)}function r0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function s0(t,e,n){return n=n!=null?n.concat([t]):null,Mu(4,4,r0.bind(null,e,t),n)}function bf(){}function i0(t,e){var n=mn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Rf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function o0(t,e){var n=mn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Rf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function a0(t,e,n){return Cs&21?(Cn(n,e)||(n=hv(),Fe.lanes|=n,Is|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,zt=!0),t.memoizedState=n)}function y1(t,e){var n=Ie;Ie=n!==0&&4>n?n:4,t(!0);var r=Yc.transition;Yc.transition={};try{t(!1),e()}finally{Ie=n,Yc.transition=r}}function l0(){return mn().memoizedState}function _1(t,e,n){var r=Pr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},u0(t))c0(e,n);else if(n=qv(t,e,n,r),n!==null){var s=Vt();Sn(n,t,r,s),d0(n,e,r)}}function v1(t,e,n){var r=Pr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(u0(t))c0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Cn(l,o)){var u=e.interleaved;u===null?(s.next=s,Tf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=qv(t,e,s,r),n!==null&&(s=Vt(),Sn(n,t,r,s),d0(n,e,r))}}function u0(t){var e=t.alternate;return t===Fe||e!==null&&e===Fe}function c0(t,e){Co=tu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function d0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,af(t,n)}}var nu={readContext:pn,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},E1={readContext:pn,useCallback:function(t,e){return bn().memoizedState=[t,e===void 0?null:e],t},useContext:pn,useEffect:Cg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Tl(4194308,4,r0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Tl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Tl(4,2,t,e)},useMemo:function(t,e){var n=bn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=bn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=_1.bind(null,Fe,t),[r.memoizedState,t]},useRef:function(t){var e=bn();return t={current:t},e.memoizedState=t},useState:Sg,useDebugValue:bf,useDeferredValue:function(t){return bn().memoizedState=t},useTransition:function(){var t=Sg(!1),e=t[0];return t=y1.bind(null,t[1]),bn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Fe,s=bn();if(Me){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),at===null)throw Error(U(349));Cs&30||Qv(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Cg(Jv.bind(null,r,i,t),[t]),r.flags|=2048,Xo(9,Yv.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=bn(),e=at.identifierPrefix;if(Me){var n=Jn,r=Yn;n=(r&~(1<<32-wn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Yo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=g1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},T1={readContext:pn,useCallback:i0,useContext:pn,useEffect:Af,useImperativeHandle:s0,useInsertionEffect:t0,useLayoutEffect:n0,useMemo:o0,useReducer:Jc,useRef:e0,useState:function(){return Jc(Jo)},useDebugValue:bf,useDeferredValue:function(t){var e=mn();return a0(e,et.memoizedState,t)},useTransition:function(){var t=Jc(Jo)[0],e=mn().memoizedState;return[t,e]},useMutableSource:Gv,useSyncExternalStore:Kv,useId:l0,unstable_isNewReconciler:!1},w1={readContext:pn,useCallback:i0,useContext:pn,useEffect:Af,useImperativeHandle:s0,useInsertionEffect:t0,useLayoutEffect:n0,useMemo:o0,useReducer:Xc,useRef:e0,useState:function(){return Xc(Jo)},useDebugValue:bf,useDeferredValue:function(t){var e=mn();return et===null?e.memoizedState=t:a0(e,et.memoizedState,t)},useTransition:function(){var t=Xc(Jo)[0],e=mn().memoizedState;return[t,e]},useMutableSource:Gv,useSyncExternalStore:Kv,useId:l0,unstable_isNewReconciler:!1};function vn(t,e){if(t&&t.defaultProps){e=Be({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Hd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Be({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ou={isMounted:function(t){return(t=t._reactInternals)?Ns(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Vt(),s=Pr(t),i=Xn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ar(t,i,s),e!==null&&(Sn(e,t,s,r),vl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Vt(),s=Pr(t),i=Xn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ar(t,i,s),e!==null&&(Sn(e,t,s,r),vl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Vt(),r=Pr(t),s=Xn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ar(t,s,r),e!==null&&(Sn(e,t,r,n),vl(e,t,r))}};function Ig(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!qo(n,r)||!qo(s,i):!0}function h0(t,e,n){var r=!1,s=Ur,i=e.contextType;return typeof i=="object"&&i!==null?i=pn(i):(s=Wt(e)?ws:xt.current,r=e.contextTypes,i=(r=r!=null)?yi(t,s):Ur),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ou,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Rg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ou.enqueueReplaceState(e,e.state,null)}function Gd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},wf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=pn(i):(i=Wt(e)?ws:xt.current,s.context=yi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Hd(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ou.enqueueReplaceState(s,s.state,null),Zl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ti(t,e){try{var n="",r=e;do n+=YS(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Zc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Kd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var S1=typeof WeakMap=="function"?WeakMap:Map;function f0(t,e,n){n=Xn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){su||(su=!0,sh=r),Kd(t,e)},n}function p0(t,e,n){n=Xn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Kd(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Kd(t,e),typeof r!="function"&&(br===null?br=new Set([this]):br.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function xg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new S1;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=L1.bind(null,t,e,n),e.then(t,t))}function kg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Ag(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Xn(-1,1),e.tag=2,Ar(n,e,1))),n.lanes|=1),t)}var C1=lr.ReactCurrentOwner,zt=!1;function Nt(t,e,n,r){e.child=t===null?zv(e,null,n,r):vi(e,t.child,n,r)}function bg(t,e,n,r,s){n=n.render;var i=e.ref;return hi(e,s),r=xf(t,e,n,r,i,s),n=kf(),t!==null&&!zt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nr(t,e,s)):(Me&&n&&mf(e),e.flags|=1,Nt(t,e,r,s),e.child)}function Pg(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!jf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,m0(t,e,i,r,s)):(t=Il(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:qo,n(o,r)&&t.ref===e.ref)return nr(t,e,s)}return e.flags|=1,t=Nr(i,r),t.ref=e.ref,t.return=e,e.child=t}function m0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(qo(i,r)&&t.ref===e.ref)if(zt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(zt=!0);else return e.lanes=t.lanes,nr(t,e,s)}return Qd(t,e,n,r,s)}function g0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ae(oi,Zt),Zt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ae(oi,Zt),Zt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ae(oi,Zt),Zt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ae(oi,Zt),Zt|=r;return Nt(t,e,s,n),e.child}function y0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Qd(t,e,n,r,s){var i=Wt(n)?ws:xt.current;return i=yi(e,i),hi(e,s),n=xf(t,e,n,r,i,s),r=kf(),t!==null&&!zt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nr(t,e,s)):(Me&&r&&mf(e),e.flags|=1,Nt(t,e,n,s),e.child)}function Ng(t,e,n,r,s){if(Wt(n)){var i=!0;Kl(e)}else i=!1;if(hi(e,s),e.stateNode===null)wl(t,e),h0(e,n,r),Gd(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=pn(c):(c=Wt(n)?ws:xt.current,c=yi(e,c));var d=n.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==c)&&Rg(e,o,r,c),_r=!1;var m=e.memoizedState;o.state=m,Zl(e,r,o,s),u=e.memoizedState,l!==r||m!==u||qt.current||_r?(typeof d=="function"&&(Hd(e,n,d,r),u=e.memoizedState),(l=_r||Ig(e,n,l,r,m,u,c))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Wv(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:vn(e.type,l),o.props=c,p=e.pendingProps,m=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=pn(u):(u=Wt(n)?ws:xt.current,u=yi(e,u));var v=n.getDerivedStateFromProps;(d=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||m!==u)&&Rg(e,o,r,u),_r=!1,m=e.memoizedState,o.state=m,Zl(e,r,o,s);var R=e.memoizedState;l!==p||m!==R||qt.current||_r?(typeof v=="function"&&(Hd(e,n,v,r),R=e.memoizedState),(c=_r||Ig(e,n,c,r,m,R,u)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Yd(t,e,n,r,i,s)}function Yd(t,e,n,r,s,i){y0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&yg(e,n,!1),nr(t,e,i);r=e.stateNode,C1.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=vi(e,t.child,null,i),e.child=vi(e,null,l,i)):Nt(t,e,l,i),e.memoizedState=r.state,s&&yg(e,n,!0),e.child}function _0(t){var e=t.stateNode;e.pendingContext?gg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&gg(t,e.context,!1),Sf(t,e.containerInfo)}function Dg(t,e,n,r,s){return _i(),yf(s),e.flags|=256,Nt(t,e,n,r),e.child}var Jd={dehydrated:null,treeContext:null,retryLane:0};function Xd(t){return{baseLanes:t,cachePool:null,transitions:null}}function v0(t,e,n){var r=e.pendingProps,s=Le.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ae(Le,s&1),t===null)return qd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Fu(o,r,0,null),t=vs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Xd(n),e.memoizedState=Jd,t):Pf(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return I1(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Nr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Nr(l,i):(i=vs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Xd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Jd,r}return i=t.child,t=i.sibling,r=Nr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Pf(t,e){return e=Fu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function sl(t,e,n,r){return r!==null&&yf(r),vi(e,t.child,null,n),t=Pf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function I1(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Zc(Error(U(422))),sl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Fu({mode:"visible",children:r.children},s,0,null),i=vs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&vi(e,t.child,null,o),e.child.memoizedState=Xd(o),e.memoizedState=Jd,i);if(!(e.mode&1))return sl(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(U(419)),r=Zc(i,r,void 0),sl(t,e,o,r)}if(l=(o&t.childLanes)!==0,zt||l){if(r=at,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,tr(t,s),Sn(r,t,s,-1))}return Lf(),r=Zc(Error(U(421))),sl(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=j1.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,tn=kr(s.nextSibling),rn=e,Me=!0,Tn=null,t!==null&&(cn[dn++]=Yn,cn[dn++]=Jn,cn[dn++]=Ss,Yn=t.id,Jn=t.overflow,Ss=e),e=Pf(e,r.children),e.flags|=4096,e)}function Vg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Wd(t.return,e,n)}function ed(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function E0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Nt(t,e,r.children,n),r=Le.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Vg(t,n,e);else if(t.tag===19)Vg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ae(Le,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&eu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),ed(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&eu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}ed(e,!0,n,null,i);break;case"together":ed(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function wl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function nr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Is|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=Nr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Nr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function R1(t,e,n){switch(e.tag){case 3:_0(e),_i();break;case 5:Hv(e);break;case 1:Wt(e.type)&&Kl(e);break;case 4:Sf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ae(Jl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ae(Le,Le.current&1),e.flags|=128,null):n&e.child.childLanes?v0(t,e,n):(Ae(Le,Le.current&1),t=nr(t,e,n),t!==null?t.sibling:null);Ae(Le,Le.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return E0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ae(Le,Le.current),r)break;return null;case 22:case 23:return e.lanes=0,g0(t,e,n)}return nr(t,e,n)}var T0,Zd,w0,S0;T0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Zd=function(){};w0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ms(Vn.current);var i=null;switch(n){case"input":s=Td(t,s),r=Td(t,r),i=[];break;case"select":s=Be({},s,{value:void 0}),r=Be({},r,{value:void 0}),i=[];break;case"textarea":s=Cd(t,s),r=Cd(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Hl)}Rd(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var l=s[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Lo.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(l=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Lo.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Ne("scroll",t),i||l===u||(i=[])):(i=i||[]).push(c,u))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};S0=function(t,e,n,r){n!==r&&(e.flags|=4)};function so(t,e){if(!Me)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function wt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function x1(t,e,n){var r=e.pendingProps;switch(gf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wt(e),null;case 1:return Wt(e.type)&&Gl(),wt(e),null;case 3:return r=e.stateNode,Ei(),De(qt),De(xt),If(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(nl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Tn!==null&&(ah(Tn),Tn=null))),Zd(t,e),wt(e),null;case 5:Cf(e);var s=ms(Qo.current);if(n=e.type,t!==null&&e.stateNode!=null)w0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return wt(e),null}if(t=ms(Vn.current),nl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Nn]=e,r[Go]=i,t=(e.mode&1)!==0,n){case"dialog":Ne("cancel",r),Ne("close",r);break;case"iframe":case"object":case"embed":Ne("load",r);break;case"video":case"audio":for(s=0;s<ho.length;s++)Ne(ho[s],r);break;case"source":Ne("error",r);break;case"img":case"image":case"link":Ne("error",r),Ne("load",r);break;case"details":Ne("toggle",r);break;case"input":zm(r,i),Ne("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ne("invalid",r);break;case"textarea":Wm(r,i),Ne("invalid",r)}Rd(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&tl(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&tl(r.textContent,l,t),s=["children",""+l]):Lo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ne("scroll",r)}switch(n){case"input":Ga(r),qm(r,i,!0);break;case"textarea":Ga(r),Hm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Hl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=J_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Nn]=e,t[Go]=r,T0(t,e,!1,!1),e.stateNode=t;e:{switch(o=xd(n,r),n){case"dialog":Ne("cancel",t),Ne("close",t),s=r;break;case"iframe":case"object":case"embed":Ne("load",t),s=r;break;case"video":case"audio":for(s=0;s<ho.length;s++)Ne(ho[s],t);s=r;break;case"source":Ne("error",t),s=r;break;case"img":case"image":case"link":Ne("error",t),Ne("load",t),s=r;break;case"details":Ne("toggle",t),s=r;break;case"input":zm(t,r),s=Td(t,r),Ne("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Be({},r,{value:void 0}),Ne("invalid",t);break;case"textarea":Wm(t,r),s=Cd(t,r),Ne("invalid",t);break;default:s=r}Rd(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?ev(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&X_(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&jo(t,u):typeof u=="number"&&jo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Lo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ne("scroll",t):u!=null&&ef(t,i,u,o))}switch(n){case"input":Ga(t),qm(t,r,!1);break;case"textarea":Ga(t),Hm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Br(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?li(t,!!r.multiple,i,!1):r.defaultValue!=null&&li(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Hl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return wt(e),null;case 6:if(t&&e.stateNode!=null)S0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=ms(Qo.current),ms(Vn.current),nl(e)){if(r=e.stateNode,n=e.memoizedProps,r[Nn]=e,(i=r.nodeValue!==n)&&(t=rn,t!==null))switch(t.tag){case 3:tl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&tl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Nn]=e,e.stateNode=r}return wt(e),null;case 13:if(De(Le),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Me&&tn!==null&&e.mode&1&&!(e.flags&128))Uv(),_i(),e.flags|=98560,i=!1;else if(i=nl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[Nn]=e}else _i(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;wt(e),i=!1}else Tn!==null&&(ah(Tn),Tn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Le.current&1?tt===0&&(tt=3):Lf())),e.updateQueue!==null&&(e.flags|=4),wt(e),null);case 4:return Ei(),Zd(t,e),t===null&&Wo(e.stateNode.containerInfo),wt(e),null;case 10:return Ef(e.type._context),wt(e),null;case 17:return Wt(e.type)&&Gl(),wt(e),null;case 19:if(De(Le),i=e.memoizedState,i===null)return wt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)so(i,!1);else{if(tt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=eu(t),o!==null){for(e.flags|=128,so(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ae(Le,Le.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ge()>wi&&(e.flags|=128,r=!0,so(i,!1),e.lanes=4194304)}else{if(!r)if(t=eu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),so(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Me)return wt(e),null}else 2*Ge()-i.renderingStartTime>wi&&n!==1073741824&&(e.flags|=128,r=!0,so(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ge(),e.sibling=null,n=Le.current,Ae(Le,r?n&1|2:n&1),e):(wt(e),null);case 22:case 23:return Of(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Zt&1073741824&&(wt(e),e.subtreeFlags&6&&(e.flags|=8192)):wt(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function k1(t,e){switch(gf(e),e.tag){case 1:return Wt(e.type)&&Gl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ei(),De(qt),De(xt),If(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Cf(e),null;case 13:if(De(Le),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));_i()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return De(Le),null;case 4:return Ei(),null;case 10:return Ef(e.type._context),null;case 22:case 23:return Of(),null;case 24:return null;default:return null}}var il=!1,Rt=!1,A1=typeof WeakSet=="function"?WeakSet:Set,Z=null;function ii(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qe(t,e,r)}else n.current=null}function eh(t,e,n){try{n()}catch(r){qe(t,e,r)}}var Mg=!1;function b1(t,e){if(Ld=zl,t=kv(),pf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,c=0,d=0,p=t,m=null;t:for(;;){for(var v;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(u=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(v=p.firstChild)!==null;)m=p,p=v;for(;;){if(p===t)break t;if(m===n&&++c===s&&(l=o),m===i&&++d===r&&(u=o),(v=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=v}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(jd={focusedElem:t,selectionRange:n},zl=!1,Z=e;Z!==null;)if(e=Z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Z=t;else for(;Z!==null;){e=Z;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var b=R.memoizedProps,V=R.memoizedState,w=e.stateNode,E=w.getSnapshotBeforeUpdate(e.elementType===e.type?b:vn(e.type,b),V);w.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(L){qe(e,e.return,L)}if(t=e.sibling,t!==null){t.return=e.return,Z=t;break}Z=e.return}return R=Mg,Mg=!1,R}function Io(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&eh(e,n,i)}s=s.next}while(s!==r)}}function Lu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function th(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function C0(t){var e=t.alternate;e!==null&&(t.alternate=null,C0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Nn],delete e[Go],delete e[Ud],delete e[h1],delete e[f1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function I0(t){return t.tag===5||t.tag===3||t.tag===4}function Og(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||I0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function nh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Hl));else if(r!==4&&(t=t.child,t!==null))for(nh(t,e,n),t=t.sibling;t!==null;)nh(t,e,n),t=t.sibling}function rh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(rh(t,e,n),t=t.sibling;t!==null;)rh(t,e,n),t=t.sibling}var ut=null,En=!1;function gr(t,e,n){for(n=n.child;n!==null;)R0(t,e,n),n=n.sibling}function R0(t,e,n){if(Dn&&typeof Dn.onCommitFiberUnmount=="function")try{Dn.onCommitFiberUnmount(Au,n)}catch{}switch(n.tag){case 5:Rt||ii(n,e);case 6:var r=ut,s=En;ut=null,gr(t,e,n),ut=r,En=s,ut!==null&&(En?(t=ut,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ut.removeChild(n.stateNode));break;case 18:ut!==null&&(En?(t=ut,n=n.stateNode,t.nodeType===8?Gc(t.parentNode,n):t.nodeType===1&&Gc(t,n),$o(t)):Gc(ut,n.stateNode));break;case 4:r=ut,s=En,ut=n.stateNode.containerInfo,En=!0,gr(t,e,n),ut=r,En=s;break;case 0:case 11:case 14:case 15:if(!Rt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&eh(n,e,o),s=s.next}while(s!==r)}gr(t,e,n);break;case 1:if(!Rt&&(ii(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){qe(n,e,l)}gr(t,e,n);break;case 21:gr(t,e,n);break;case 22:n.mode&1?(Rt=(r=Rt)||n.memoizedState!==null,gr(t,e,n),Rt=r):gr(t,e,n);break;default:gr(t,e,n)}}function Lg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new A1),e.forEach(function(r){var s=F1.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function _n(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:ut=l.stateNode,En=!1;break e;case 3:ut=l.stateNode.containerInfo,En=!0;break e;case 4:ut=l.stateNode.containerInfo,En=!0;break e}l=l.return}if(ut===null)throw Error(U(160));R0(i,o,s),ut=null,En=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){qe(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)x0(e,t),e=e.sibling}function x0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(_n(e,t),An(t),r&4){try{Io(3,t,t.return),Lu(3,t)}catch(b){qe(t,t.return,b)}try{Io(5,t,t.return)}catch(b){qe(t,t.return,b)}}break;case 1:_n(e,t),An(t),r&512&&n!==null&&ii(n,n.return);break;case 5:if(_n(e,t),An(t),r&512&&n!==null&&ii(n,n.return),t.flags&32){var s=t.stateNode;try{jo(s,"")}catch(b){qe(t,t.return,b)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Q_(s,i),xd(l,o);var c=xd(l,i);for(o=0;o<u.length;o+=2){var d=u[o],p=u[o+1];d==="style"?ev(s,p):d==="dangerouslySetInnerHTML"?X_(s,p):d==="children"?jo(s,p):ef(s,d,p,c)}switch(l){case"input":wd(s,i);break;case"textarea":Y_(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?li(s,!!i.multiple,v,!1):m!==!!i.multiple&&(i.defaultValue!=null?li(s,!!i.multiple,i.defaultValue,!0):li(s,!!i.multiple,i.multiple?[]:"",!1))}s[Go]=i}catch(b){qe(t,t.return,b)}}break;case 6:if(_n(e,t),An(t),r&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(b){qe(t,t.return,b)}}break;case 3:if(_n(e,t),An(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{$o(e.containerInfo)}catch(b){qe(t,t.return,b)}break;case 4:_n(e,t),An(t);break;case 13:_n(e,t),An(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Vf=Ge())),r&4&&Lg(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Rt=(c=Rt)||d,_n(e,t),Rt=c):_n(e,t),An(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(Z=t,d=t.child;d!==null;){for(p=Z=d;Z!==null;){switch(m=Z,v=m.child,m.tag){case 0:case 11:case 14:case 15:Io(4,m,m.return);break;case 1:ii(m,m.return);var R=m.stateNode;if(typeof R.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(b){qe(r,n,b)}}break;case 5:ii(m,m.return);break;case 22:if(m.memoizedState!==null){Fg(p);continue}}v!==null?(v.return=m,Z=v):Fg(p)}d=d.sibling}e:for(d=null,p=t;;){if(p.tag===5){if(d===null){d=p;try{s=p.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Z_("display",o))}catch(b){qe(t,t.return,b)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=c?"":p.memoizedProps}catch(b){qe(t,t.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:_n(e,t),An(t),r&4&&Lg(t);break;case 21:break;default:_n(e,t),An(t)}}function An(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(I0(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(jo(s,""),r.flags&=-33);var i=Og(t);rh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Og(t);nh(t,l,o);break;default:throw Error(U(161))}}catch(u){qe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function P1(t,e,n){Z=t,k0(t)}function k0(t,e,n){for(var r=(t.mode&1)!==0;Z!==null;){var s=Z,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||il;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Rt;l=il;var c=Rt;if(il=o,(Rt=u)&&!c)for(Z=s;Z!==null;)o=Z,u=o.child,o.tag===22&&o.memoizedState!==null?Bg(s):u!==null?(u.return=o,Z=u):Bg(s);for(;i!==null;)Z=i,k0(i),i=i.sibling;Z=s,il=l,Rt=c}jg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Z=i):jg(t)}}function jg(t){for(;Z!==null;){var e=Z;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Rt||Lu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Rt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:vn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&wg(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}wg(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&$o(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}Rt||e.flags&512&&th(e)}catch(m){qe(e,e.return,m)}}if(e===t){Z=null;break}if(n=e.sibling,n!==null){n.return=e.return,Z=n;break}Z=e.return}}function Fg(t){for(;Z!==null;){var e=Z;if(e===t){Z=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Z=n;break}Z=e.return}}function Bg(t){for(;Z!==null;){var e=Z;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Lu(4,e)}catch(u){qe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){qe(e,s,u)}}var i=e.return;try{th(e)}catch(u){qe(e,i,u)}break;case 5:var o=e.return;try{th(e)}catch(u){qe(e,o,u)}}}catch(u){qe(e,e.return,u)}if(e===t){Z=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Z=l;break}Z=e.return}}var N1=Math.ceil,ru=lr.ReactCurrentDispatcher,Nf=lr.ReactCurrentOwner,fn=lr.ReactCurrentBatchConfig,Te=0,at=null,Je=null,ft=0,Zt=0,oi=Jr(0),tt=0,Zo=null,Is=0,ju=0,Df=0,Ro=null,$t=null,Vf=0,wi=1/0,Kn=null,su=!1,sh=null,br=null,ol=!1,wr=null,iu=0,xo=0,ih=null,Sl=-1,Cl=0;function Vt(){return Te&6?Ge():Sl!==-1?Sl:Sl=Ge()}function Pr(t){return t.mode&1?Te&2&&ft!==0?ft&-ft:m1.transition!==null?(Cl===0&&(Cl=hv()),Cl):(t=Ie,t!==0||(t=window.event,t=t===void 0?16:vv(t.type)),t):1}function Sn(t,e,n,r){if(50<xo)throw xo=0,ih=null,Error(U(185));fa(t,n,r),(!(Te&2)||t!==at)&&(t===at&&(!(Te&2)&&(ju|=n),tt===4&&Er(t,ft)),Ht(t,r),n===1&&Te===0&&!(e.mode&1)&&(wi=Ge()+500,Vu&&Xr()))}function Ht(t,e){var n=t.callbackNode;mC(t,e);var r=$l(t,t===at?ft:0);if(r===0)n!==null&&Qm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Qm(n),e===1)t.tag===0?p1(Ug.bind(null,t)):jv(Ug.bind(null,t)),c1(function(){!(Te&6)&&Xr()}),n=null;else{switch(fv(r)){case 1:n=of;break;case 4:n=cv;break;case 16:n=Ul;break;case 536870912:n=dv;break;default:n=Ul}n=O0(n,A0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function A0(t,e){if(Sl=-1,Cl=0,Te&6)throw Error(U(327));var n=t.callbackNode;if(fi()&&t.callbackNode!==n)return null;var r=$l(t,t===at?ft:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ou(t,r);else{e=r;var s=Te;Te|=2;var i=P0();(at!==t||ft!==e)&&(Kn=null,wi=Ge()+500,_s(t,e));do try{M1();break}catch(l){b0(t,l)}while(!0);vf(),ru.current=i,Te=s,Je!==null?e=0:(at=null,ft=0,e=tt)}if(e!==0){if(e===2&&(s=Nd(t),s!==0&&(r=s,e=oh(t,s))),e===1)throw n=Zo,_s(t,0),Er(t,r),Ht(t,Ge()),n;if(e===6)Er(t,r);else{if(s=t.current.alternate,!(r&30)&&!D1(s)&&(e=ou(t,r),e===2&&(i=Nd(t),i!==0&&(r=i,e=oh(t,i))),e===1))throw n=Zo,_s(t,0),Er(t,r),Ht(t,Ge()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:cs(t,$t,Kn);break;case 3:if(Er(t,r),(r&130023424)===r&&(e=Vf+500-Ge(),10<e)){if($l(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Vt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Bd(cs.bind(null,t,$t,Kn),e);break}cs(t,$t,Kn);break;case 4:if(Er(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-wn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*N1(r/1960))-r,10<r){t.timeoutHandle=Bd(cs.bind(null,t,$t,Kn),r);break}cs(t,$t,Kn);break;case 5:cs(t,$t,Kn);break;default:throw Error(U(329))}}}return Ht(t,Ge()),t.callbackNode===n?A0.bind(null,t):null}function oh(t,e){var n=Ro;return t.current.memoizedState.isDehydrated&&(_s(t,e).flags|=256),t=ou(t,e),t!==2&&(e=$t,$t=n,e!==null&&ah(e)),t}function ah(t){$t===null?$t=t:$t.push.apply($t,t)}function D1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Cn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Er(t,e){for(e&=~Df,e&=~ju,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-wn(e),r=1<<n;t[n]=-1,e&=~r}}function Ug(t){if(Te&6)throw Error(U(327));fi();var e=$l(t,0);if(!(e&1))return Ht(t,Ge()),null;var n=ou(t,e);if(t.tag!==0&&n===2){var r=Nd(t);r!==0&&(e=r,n=oh(t,r))}if(n===1)throw n=Zo,_s(t,0),Er(t,e),Ht(t,Ge()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,cs(t,$t,Kn),Ht(t,Ge()),null}function Mf(t,e){var n=Te;Te|=1;try{return t(e)}finally{Te=n,Te===0&&(wi=Ge()+500,Vu&&Xr())}}function Rs(t){wr!==null&&wr.tag===0&&!(Te&6)&&fi();var e=Te;Te|=1;var n=fn.transition,r=Ie;try{if(fn.transition=null,Ie=1,t)return t()}finally{Ie=r,fn.transition=n,Te=e,!(Te&6)&&Xr()}}function Of(){Zt=oi.current,De(oi)}function _s(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,u1(n)),Je!==null)for(n=Je.return;n!==null;){var r=n;switch(gf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Gl();break;case 3:Ei(),De(qt),De(xt),If();break;case 5:Cf(r);break;case 4:Ei();break;case 13:De(Le);break;case 19:De(Le);break;case 10:Ef(r.type._context);break;case 22:case 23:Of()}n=n.return}if(at=t,Je=t=Nr(t.current,null),ft=Zt=e,tt=0,Zo=null,Df=ju=Is=0,$t=Ro=null,ps!==null){for(e=0;e<ps.length;e++)if(n=ps[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ps=null}return t}function b0(t,e){do{var n=Je;try{if(vf(),El.current=nu,tu){for(var r=Fe.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}tu=!1}if(Cs=0,it=et=Fe=null,Co=!1,Yo=0,Nf.current=null,n===null||n.return===null){tt=1,Zo=e,Je=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=ft,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=l,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=kg(o);if(v!==null){v.flags&=-257,Ag(v,o,l,i,e),v.mode&1&&xg(i,c,e),e=v,u=c;var R=e.updateQueue;if(R===null){var b=new Set;b.add(u),e.updateQueue=b}else R.add(u);break e}else{if(!(e&1)){xg(i,c,e),Lf();break e}u=Error(U(426))}}else if(Me&&l.mode&1){var V=kg(o);if(V!==null){!(V.flags&65536)&&(V.flags|=256),Ag(V,o,l,i,e),yf(Ti(u,l));break e}}i=u=Ti(u,l),tt!==4&&(tt=2),Ro===null?Ro=[i]:Ro.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=f0(i,u,e);Tg(i,w);break e;case 1:l=u;var E=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(br===null||!br.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var L=p0(i,l,e);Tg(i,L);break e}}i=i.return}while(i!==null)}D0(n)}catch(z){e=z,Je===n&&n!==null&&(Je=n=n.return);continue}break}while(!0)}function P0(){var t=ru.current;return ru.current=nu,t===null?nu:t}function Lf(){(tt===0||tt===3||tt===2)&&(tt=4),at===null||!(Is&268435455)&&!(ju&268435455)||Er(at,ft)}function ou(t,e){var n=Te;Te|=2;var r=P0();(at!==t||ft!==e)&&(Kn=null,_s(t,e));do try{V1();break}catch(s){b0(t,s)}while(!0);if(vf(),Te=n,ru.current=r,Je!==null)throw Error(U(261));return at=null,ft=0,tt}function V1(){for(;Je!==null;)N0(Je)}function M1(){for(;Je!==null&&!oC();)N0(Je)}function N0(t){var e=M0(t.alternate,t,Zt);t.memoizedProps=t.pendingProps,e===null?D0(t):Je=e,Nf.current=null}function D0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=k1(n,e),n!==null){n.flags&=32767,Je=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{tt=6,Je=null;return}}else if(n=x1(n,e,Zt),n!==null){Je=n;return}if(e=e.sibling,e!==null){Je=e;return}Je=e=t}while(e!==null);tt===0&&(tt=5)}function cs(t,e,n){var r=Ie,s=fn.transition;try{fn.transition=null,Ie=1,O1(t,e,n,r)}finally{fn.transition=s,Ie=r}return null}function O1(t,e,n,r){do fi();while(wr!==null);if(Te&6)throw Error(U(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(gC(t,i),t===at&&(Je=at=null,ft=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ol||(ol=!0,O0(Ul,function(){return fi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=fn.transition,fn.transition=null;var o=Ie;Ie=1;var l=Te;Te|=4,Nf.current=null,b1(t,n),x0(n,t),n1(jd),zl=!!Ld,jd=Ld=null,t.current=n,P1(n),aC(),Te=l,Ie=o,fn.transition=i}else t.current=n;if(ol&&(ol=!1,wr=t,iu=s),i=t.pendingLanes,i===0&&(br=null),cC(n.stateNode),Ht(t,Ge()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(su)throw su=!1,t=sh,sh=null,t;return iu&1&&t.tag!==0&&fi(),i=t.pendingLanes,i&1?t===ih?xo++:(xo=0,ih=t):xo=0,Xr(),null}function fi(){if(wr!==null){var t=fv(iu),e=fn.transition,n=Ie;try{if(fn.transition=null,Ie=16>t?16:t,wr===null)var r=!1;else{if(t=wr,wr=null,iu=0,Te&6)throw Error(U(331));var s=Te;for(Te|=4,Z=t.current;Z!==null;){var i=Z,o=i.child;if(Z.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(Z=c;Z!==null;){var d=Z;switch(d.tag){case 0:case 11:case 15:Io(8,d,i)}var p=d.child;if(p!==null)p.return=d,Z=p;else for(;Z!==null;){d=Z;var m=d.sibling,v=d.return;if(C0(d),d===c){Z=null;break}if(m!==null){m.return=v,Z=m;break}Z=v}}}var R=i.alternate;if(R!==null){var b=R.child;if(b!==null){R.child=null;do{var V=b.sibling;b.sibling=null,b=V}while(b!==null)}}Z=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Z=o;else e:for(;Z!==null;){if(i=Z,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Io(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,Z=w;break e}Z=i.return}}var E=t.current;for(Z=E;Z!==null;){o=Z;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,Z=x;else e:for(o=E;Z!==null;){if(l=Z,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Lu(9,l)}}catch(z){qe(l,l.return,z)}if(l===o){Z=null;break e}var L=l.sibling;if(L!==null){L.return=l.return,Z=L;break e}Z=l.return}}if(Te=s,Xr(),Dn&&typeof Dn.onPostCommitFiberRoot=="function")try{Dn.onPostCommitFiberRoot(Au,t)}catch{}r=!0}return r}finally{Ie=n,fn.transition=e}}return!1}function $g(t,e,n){e=Ti(n,e),e=f0(t,e,1),t=Ar(t,e,1),e=Vt(),t!==null&&(fa(t,1,e),Ht(t,e))}function qe(t,e,n){if(t.tag===3)$g(t,t,n);else for(;e!==null;){if(e.tag===3){$g(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(br===null||!br.has(r))){t=Ti(n,t),t=p0(e,t,1),e=Ar(e,t,1),t=Vt(),e!==null&&(fa(e,1,t),Ht(e,t));break}}e=e.return}}function L1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Vt(),t.pingedLanes|=t.suspendedLanes&n,at===t&&(ft&n)===n&&(tt===4||tt===3&&(ft&130023424)===ft&&500>Ge()-Vf?_s(t,0):Df|=n),Ht(t,e)}function V0(t,e){e===0&&(t.mode&1?(e=Ya,Ya<<=1,!(Ya&130023424)&&(Ya=4194304)):e=1);var n=Vt();t=tr(t,e),t!==null&&(fa(t,e,n),Ht(t,n))}function j1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),V0(t,n)}function F1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),V0(t,n)}var M0;M0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||qt.current)zt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return zt=!1,R1(t,e,n);zt=!!(t.flags&131072)}else zt=!1,Me&&e.flags&1048576&&Fv(e,Yl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;wl(t,e),t=e.pendingProps;var s=yi(e,xt.current);hi(e,n),s=xf(null,e,r,t,s,n);var i=kf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Wt(r)?(i=!0,Kl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,wf(e),s.updater=Ou,e.stateNode=s,s._reactInternals=e,Gd(e,r,t,n),e=Yd(null,e,r,!0,i,n)):(e.tag=0,Me&&i&&mf(e),Nt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(wl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=U1(r),t=vn(r,t),s){case 0:e=Qd(null,e,r,t,n);break e;case 1:e=Ng(null,e,r,t,n);break e;case 11:e=bg(null,e,r,t,n);break e;case 14:e=Pg(null,e,r,vn(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),Qd(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),Ng(t,e,r,s,n);case 3:e:{if(_0(e),t===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Wv(t,e),Zl(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ti(Error(U(423)),e),e=Dg(t,e,r,n,s);break e}else if(r!==s){s=Ti(Error(U(424)),e),e=Dg(t,e,r,n,s);break e}else for(tn=kr(e.stateNode.containerInfo.firstChild),rn=e,Me=!0,Tn=null,n=zv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(_i(),r===s){e=nr(t,e,n);break e}Nt(t,e,r,n)}e=e.child}return e;case 5:return Hv(e),t===null&&qd(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Fd(r,s)?o=null:i!==null&&Fd(r,i)&&(e.flags|=32),y0(t,e),Nt(t,e,o,n),e.child;case 6:return t===null&&qd(e),null;case 13:return v0(t,e,n);case 4:return Sf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=vi(e,null,r,n):Nt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),bg(t,e,r,s,n);case 7:return Nt(t,e,e.pendingProps,n),e.child;case 8:return Nt(t,e,e.pendingProps.children,n),e.child;case 12:return Nt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ae(Jl,r._currentValue),r._currentValue=o,i!==null)if(Cn(i.value,o)){if(i.children===s.children&&!qt.current){e=nr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Xn(-1,n&-n),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Wd(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Wd(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Nt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,hi(e,n),s=pn(s),r=r(s),e.flags|=1,Nt(t,e,r,n),e.child;case 14:return r=e.type,s=vn(r,e.pendingProps),s=vn(r.type,s),Pg(t,e,r,s,n);case 15:return m0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),wl(t,e),e.tag=1,Wt(r)?(t=!0,Kl(e)):t=!1,hi(e,n),h0(e,r,s),Gd(e,r,s,n),Yd(null,e,r,!0,t,n);case 19:return E0(t,e,n);case 22:return g0(t,e,n)}throw Error(U(156,e.tag))};function O0(t,e){return uv(t,e)}function B1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hn(t,e,n,r){return new B1(t,e,n,r)}function jf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function U1(t){if(typeof t=="function")return jf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===nf)return 11;if(t===rf)return 14}return 2}function Nr(t,e){var n=t.alternate;return n===null?(n=hn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Il(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")jf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ys:return vs(n.children,s,i,e);case tf:o=8,s|=8;break;case yd:return t=hn(12,n,e,s|2),t.elementType=yd,t.lanes=i,t;case _d:return t=hn(13,n,e,s),t.elementType=_d,t.lanes=i,t;case vd:return t=hn(19,n,e,s),t.elementType=vd,t.lanes=i,t;case H_:return Fu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case q_:o=10;break e;case W_:o=9;break e;case nf:o=11;break e;case rf:o=14;break e;case yr:o=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=hn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function vs(t,e,n,r){return t=hn(7,t,r,e),t.lanes=n,t}function Fu(t,e,n,r){return t=hn(22,t,r,e),t.elementType=H_,t.lanes=n,t.stateNode={isHidden:!1},t}function td(t,e,n){return t=hn(6,t,null,e),t.lanes=n,t}function nd(t,e,n){return e=hn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function $1(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Oc(0),this.expirationTimes=Oc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ff(t,e,n,r,s,i,o,l,u){return t=new $1(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=hn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},wf(i),t}function z1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function L0(t){if(!t)return Ur;t=t._reactInternals;e:{if(Ns(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Wt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(Wt(n))return Lv(t,n,e)}return e}function j0(t,e,n,r,s,i,o,l,u){return t=Ff(n,r,!0,t,s,i,o,l,u),t.context=L0(null),n=t.current,r=Vt(),s=Pr(n),i=Xn(r,s),i.callback=e??null,Ar(n,i,s),t.current.lanes=s,fa(t,s,r),Ht(t,r),t}function Bu(t,e,n,r){var s=e.current,i=Vt(),o=Pr(s);return n=L0(n),e.context===null?e.context=n:e.pendingContext=n,e=Xn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ar(s,e,o),t!==null&&(Sn(t,s,o,i),vl(t,s,o)),o}function au(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function zg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Bf(t,e){zg(t,e),(t=t.alternate)&&zg(t,e)}function q1(){return null}var F0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Uf(t){this._internalRoot=t}Uu.prototype.render=Uf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));Bu(t,e,null,null)};Uu.prototype.unmount=Uf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Rs(function(){Bu(null,t,null,null)}),e[er]=null}};function Uu(t){this._internalRoot=t}Uu.prototype.unstable_scheduleHydration=function(t){if(t){var e=gv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<vr.length&&e!==0&&e<vr[n].priority;n++);vr.splice(n,0,t),n===0&&_v(t)}};function $f(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function $u(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function qg(){}function W1(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=au(o);i.call(c)}}var o=j0(e,r,t,0,null,!1,!1,"",qg);return t._reactRootContainer=o,t[er]=o.current,Wo(t.nodeType===8?t.parentNode:t),Rs(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var c=au(u);l.call(c)}}var u=Ff(t,0,!1,null,null,!1,!1,"",qg);return t._reactRootContainer=u,t[er]=u.current,Wo(t.nodeType===8?t.parentNode:t),Rs(function(){Bu(e,u,n,r)}),u}function zu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=au(o);l.call(u)}}Bu(e,o,t,s)}else o=W1(n,e,t,s,r);return au(o)}pv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=co(e.pendingLanes);n!==0&&(af(e,n|1),Ht(e,Ge()),!(Te&6)&&(wi=Ge()+500,Xr()))}break;case 13:Rs(function(){var r=tr(t,1);if(r!==null){var s=Vt();Sn(r,t,1,s)}}),Bf(t,1)}};lf=function(t){if(t.tag===13){var e=tr(t,134217728);if(e!==null){var n=Vt();Sn(e,t,134217728,n)}Bf(t,134217728)}};mv=function(t){if(t.tag===13){var e=Pr(t),n=tr(t,e);if(n!==null){var r=Vt();Sn(n,t,e,r)}Bf(t,e)}};gv=function(){return Ie};yv=function(t,e){var n=Ie;try{return Ie=t,e()}finally{Ie=n}};Ad=function(t,e,n){switch(e){case"input":if(wd(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Du(r);if(!s)throw Error(U(90));K_(r),wd(r,s)}}}break;case"textarea":Y_(t,n);break;case"select":e=n.value,e!=null&&li(t,!!n.multiple,e,!1)}};rv=Mf;sv=Rs;var H1={usingClientEntryPoint:!1,Events:[ma,ei,Du,tv,nv,Mf]},io={findFiberByHostInstance:fs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},G1={bundleType:io.bundleType,version:io.version,rendererPackageName:io.rendererPackageName,rendererConfig:io.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=av(t),t===null?null:t.stateNode},findFiberByHostInstance:io.findFiberByHostInstance||q1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{Au=al.inject(G1),Dn=al}catch{}}ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H1;ln.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$f(e))throw Error(U(200));return z1(t,e,null,n)};ln.createRoot=function(t,e){if(!$f(t))throw Error(U(299));var n=!1,r="",s=F0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Ff(t,1,!1,null,null,n,!1,r,s),t[er]=e.current,Wo(t.nodeType===8?t.parentNode:t),new Uf(e)};ln.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=av(e),t=t===null?null:t.stateNode,t};ln.flushSync=function(t){return Rs(t)};ln.hydrate=function(t,e,n){if(!$u(e))throw Error(U(200));return zu(null,t,e,!0,n)};ln.hydrateRoot=function(t,e,n){if(!$f(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=F0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=j0(e,null,t,1,n??null,s,!1,i,o),t[er]=e.current,Wo(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Uu(e)};ln.render=function(t,e,n){if(!$u(e))throw Error(U(200));return zu(null,t,e,!1,n)};ln.unmountComponentAtNode=function(t){if(!$u(t))throw Error(U(40));return t._reactRootContainer?(Rs(function(){zu(null,null,t,!1,function(){t._reactRootContainer=null,t[er]=null})}),!0):!1};ln.unstable_batchedUpdates=Mf;ln.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!$u(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return zu(t,e,n,!1,r)};ln.version="18.3.1-next-f1338f8080-20240426";function B0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(B0)}catch(t){console.error(t)}}B0(),B_.exports=ln;var K1=B_.exports,Wg=K1;md.createRoot=Wg.createRoot,md.hydrateRoot=Wg.hydrateRoot;const Q1=()=>{};var Hg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Y1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},$0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,c=u?t[s+2]:0,d=i>>2,p=(i&3)<<4|l>>4;let m=(l&15)<<2|c>>6,v=c&63;u||(v=64,o||(m=64)),r.push(n[d],n[p],n[m],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(U0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Y1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||c==null||p==null)throw new J1;const m=i<<2|l>>4;if(r.push(m),c!==64){const v=l<<4&240|c>>2;if(r.push(v),p!==64){const R=c<<6&192|p;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class J1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const X1=function(t){const e=U0(t);return $0.encodeByteArray(e,!0)},lu=function(t){return X1(t).replace(/\./g,"")},Z1=function(t){try{return $0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI=()=>eI().__FIREBASE_DEFAULTS__,nI=()=>{if(typeof process>"u"||typeof Hg>"u")return;const t=Hg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},rI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Z1(t[1]);return e&&JSON.parse(e)},zf=()=>{try{return Q1()||tI()||nI()||rI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},sI=t=>{var e,n;return(n=(e=zf())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},iI=t=>{const e=sI(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},z0=()=>{var t;return(t=zf())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qf(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function aI(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[lu(JSON.stringify(n)),lu(JSON.stringify(o)),""].join(".")}const ko={};function uI(){const t={prod:[],emulator:[]};for(const e of Object.keys(ko))ko[e]?t.emulator.push(e):t.prod.push(e);return t}function cI(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Gg=!1;function dI(t,e){if(typeof window>"u"||typeof document>"u"||!qf(window.location.host)||ko[t]===e||ko[t]||Gg)return;ko[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=uI().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function l(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,v){m.setAttribute("width","24"),m.setAttribute("id",v),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Gg=!0,o()},m}function d(m,v){m.setAttribute("id",v),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=cI(r),v=n("text"),R=document.getElementById(v)||document.createElement("span"),b=n("learnmore"),V=document.getElementById(b)||document.createElement("a"),w=n("preprendIcon"),E=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const x=m.element;l(x),d(V,b);const L=c();u(E,w),x.append(E,R,V,L),document.body.appendChild(x)}i?(R.innerText="Preview backend disconnected.",E.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(E.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hI(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fI(){var t;const e=(t=zf())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function q0(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function pI(){return!fI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Wf(){try{return typeof indexedDB=="object"}catch{return!1}}function Hf(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function W0(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI="FirebaseError";class Zr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=mI,Object.setPrototypeOf(this,Zr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qu.prototype.create)}}class qu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?gI(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Zr(s,l,r)}}function gI(t,e){return t.replace(yI,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const yI=/\{\$([^}]+)}/g;function ea(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Kg(i)&&Kg(o)){if(!ea(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Kg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=1e3,vI=2,EI=4*60*60*1e3,TI=.5;function Qg(t,e=_I,n=vI){const r=e*Math.pow(n,t),s=Math.round(TI*r*(Math.random()-.5)*2);return Math.min(EI,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(t){return t&&t._delegate?t._delegate:t}class rr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ds="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new oI;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(CI(e))try{this.getOrInitializeService({instanceIdentifier:ds})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ds){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ds){return this.instances.has(e)}getOptions(e=ds){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:SI(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ds){return this.component?this.component.multipleInstances?e:ds:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function SI(t){return t===ds?void 0:t}function CI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new wI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ve;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ve||(ve={}));const RI={debug:ve.DEBUG,verbose:ve.VERBOSE,info:ve.INFO,warn:ve.WARN,error:ve.ERROR,silent:ve.SILENT},xI=ve.INFO,kI={[ve.DEBUG]:"log",[ve.VERBOSE]:"log",[ve.INFO]:"info",[ve.WARN]:"warn",[ve.ERROR]:"error"},AI=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=kI[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Gf{constructor(e){this.name=e,this._logLevel=xI,this._logHandler=AI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?RI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ve.DEBUG,...e),this._logHandler(this,ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ve.VERBOSE,...e),this._logHandler(this,ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ve.INFO,...e),this._logHandler(this,ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ve.WARN,...e),this._logHandler(this,ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ve.ERROR,...e),this._logHandler(this,ve.ERROR,...e)}}const bI=(t,e)=>e.some(n=>t instanceof n);let Yg,Jg;function PI(){return Yg||(Yg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function NI(){return Jg||(Jg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const H0=new WeakMap,lh=new WeakMap,G0=new WeakMap,rd=new WeakMap,Kf=new WeakMap;function DI(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Dr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&H0.set(n,t)}).catch(()=>{}),Kf.set(e,t),e}function VI(t){if(lh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});lh.set(t,e)}let uh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return lh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||G0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Dr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function MI(t){uh=t(uh)}function OI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(sd(this),e,...n);return G0.set(r,e.sort?e.sort():[e]),Dr(r)}:NI().includes(t)?function(...e){return t.apply(sd(this),e),Dr(H0.get(this))}:function(...e){return Dr(t.apply(sd(this),e))}}function LI(t){return typeof t=="function"?OI(t):(t instanceof IDBTransaction&&VI(t),bI(t,PI())?new Proxy(t,uh):t)}function Dr(t){if(t instanceof IDBRequest)return DI(t);if(rd.has(t))return rd.get(t);const e=LI(t);return e!==t&&(rd.set(t,e),Kf.set(e,t)),e}const sd=t=>Kf.get(t);function K0(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Dr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Dr(o.result),u.oldVersion,u.newVersion,Dr(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const jI=["get","getKey","getAll","getAllKeys","count"],FI=["put","add","delete","clear"],id=new Map;function Xg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(id.get(e))return id.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=FI.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||jI.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),s&&u.done]))[0]};return id.set(e,i),i}MI(t=>({...t,get:(e,n,r)=>Xg(e,n)||t.get(e,n,r),has:(e,n)=>!!Xg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(UI(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function UI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ch="@firebase/app",Zg="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr=new Gf("@firebase/app"),$I="@firebase/app-compat",zI="@firebase/analytics-compat",qI="@firebase/analytics",WI="@firebase/app-check-compat",HI="@firebase/app-check",GI="@firebase/auth",KI="@firebase/auth-compat",QI="@firebase/database",YI="@firebase/data-connect",JI="@firebase/database-compat",XI="@firebase/functions",ZI="@firebase/functions-compat",eR="@firebase/installations",tR="@firebase/installations-compat",nR="@firebase/messaging",rR="@firebase/messaging-compat",sR="@firebase/performance",iR="@firebase/performance-compat",oR="@firebase/remote-config",aR="@firebase/remote-config-compat",lR="@firebase/storage",uR="@firebase/storage-compat",cR="@firebase/firestore",dR="@firebase/ai",hR="@firebase/firestore-compat",fR="firebase",pR="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dh="[DEFAULT]",mR={[ch]:"fire-core",[$I]:"fire-core-compat",[qI]:"fire-analytics",[zI]:"fire-analytics-compat",[HI]:"fire-app-check",[WI]:"fire-app-check-compat",[GI]:"fire-auth",[KI]:"fire-auth-compat",[QI]:"fire-rtdb",[YI]:"fire-data-connect",[JI]:"fire-rtdb-compat",[XI]:"fire-fn",[ZI]:"fire-fn-compat",[eR]:"fire-iid",[tR]:"fire-iid-compat",[nR]:"fire-fcm",[rR]:"fire-fcm-compat",[sR]:"fire-perf",[iR]:"fire-perf-compat",[oR]:"fire-rc",[aR]:"fire-rc-compat",[lR]:"fire-gcs",[uR]:"fire-gcs-compat",[cR]:"fire-fst",[hR]:"fire-fst-compat",[dR]:"fire-vertex","fire-js":"fire-js",[fR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uu=new Map,gR=new Map,hh=new Map;function ey(t,e){try{t.container.addComponent(e)}catch(n){sr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function $r(t){const e=t.name;if(hh.has(e))return sr.debug(`There were multiple attempts to register component ${e}.`),!1;hh.set(e,t);for(const n of uu.values())ey(n,t);for(const n of gR.values())ey(n,t);return!0}function ya(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function yR(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vr=new qu("app","Firebase",_R);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new rr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ER=pR;function Q0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:dh,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw Vr.create("bad-app-name",{appName:String(s)});if(n||(n=z0()),!n)throw Vr.create("no-options");const i=uu.get(s);if(i){if(ea(n,i.options)&&ea(r,i.config))return i;throw Vr.create("duplicate-app",{appName:s})}const o=new II(s);for(const u of hh.values())o.addComponent(u);const l=new vR(n,r,o);return uu.set(s,l),l}function Y0(t=dh){const e=uu.get(t);if(!e&&t===dh&&z0())return Q0();if(!e)throw Vr.create("no-app",{appName:t});return e}function Mn(t,e,n){var r;let s=(r=mR[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),sr.warn(l.join(" "));return}$r(new rr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TR="firebase-heartbeat-database",wR=1,ta="firebase-heartbeat-store";let od=null;function J0(){return od||(od=K0(TR,wR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ta)}catch(n){console.warn(n)}}}}).catch(t=>{throw Vr.create("idb-open",{originalErrorMessage:t.message})})),od}async function SR(t){try{const n=(await J0()).transaction(ta),r=await n.objectStore(ta).get(X0(t));return await n.done,r}catch(e){if(e instanceof Zr)sr.warn(e.message);else{const n=Vr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});sr.warn(n.message)}}}async function ty(t,e){try{const r=(await J0()).transaction(ta,"readwrite");await r.objectStore(ta).put(e,X0(t)),await r.done}catch(n){if(n instanceof Zr)sr.warn(n.message);else{const r=Vr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});sr.warn(r.message)}}}function X0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR=1024,IR=30;class RR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new kR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ny();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>IR){const o=AR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){sr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=ny(),{heartbeatsToSend:r,unsentEntries:s}=xR(this._heartbeatsCache.heartbeats),i=lu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return sr.warn(n),""}}}function ny(){return new Date().toISOString().substring(0,10)}function xR(t,e=CR){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),ry(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),ry(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class kR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Wf()?Hf().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await SR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return ty(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return ty(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function ry(t){return lu(JSON.stringify({version:2,heartbeats:t})).length}function AR(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bR(t){$r(new rr("platform-logger",e=>new BI(e),"PRIVATE")),$r(new rr("heartbeat",e=>new RR(e),"PRIVATE")),Mn(ch,Zg,t),Mn(ch,Zg,"esm2017"),Mn("fire-js","")}bR("");var sy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Mr,Z0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,_){function C(){}C.prototype=_.prototype,S.D=_.prototype,S.prototype=new C,S.prototype.constructor=S,S.C=function(I,A,k){for(var T=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)T[oe-2]=arguments[oe];return _.prototype[A].apply(I,T)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,_,C){C||(C=0);var I=Array(16);if(typeof _=="string")for(var A=0;16>A;++A)I[A]=_.charCodeAt(C++)|_.charCodeAt(C++)<<8|_.charCodeAt(C++)<<16|_.charCodeAt(C++)<<24;else for(A=0;16>A;++A)I[A]=_[C++]|_[C++]<<8|_[C++]<<16|_[C++]<<24;_=S.g[0],C=S.g[1],A=S.g[2];var k=S.g[3],T=_+(k^C&(A^k))+I[0]+3614090360&4294967295;_=C+(T<<7&4294967295|T>>>25),T=k+(A^_&(C^A))+I[1]+3905402710&4294967295,k=_+(T<<12&4294967295|T>>>20),T=A+(C^k&(_^C))+I[2]+606105819&4294967295,A=k+(T<<17&4294967295|T>>>15),T=C+(_^A&(k^_))+I[3]+3250441966&4294967295,C=A+(T<<22&4294967295|T>>>10),T=_+(k^C&(A^k))+I[4]+4118548399&4294967295,_=C+(T<<7&4294967295|T>>>25),T=k+(A^_&(C^A))+I[5]+1200080426&4294967295,k=_+(T<<12&4294967295|T>>>20),T=A+(C^k&(_^C))+I[6]+2821735955&4294967295,A=k+(T<<17&4294967295|T>>>15),T=C+(_^A&(k^_))+I[7]+4249261313&4294967295,C=A+(T<<22&4294967295|T>>>10),T=_+(k^C&(A^k))+I[8]+1770035416&4294967295,_=C+(T<<7&4294967295|T>>>25),T=k+(A^_&(C^A))+I[9]+2336552879&4294967295,k=_+(T<<12&4294967295|T>>>20),T=A+(C^k&(_^C))+I[10]+4294925233&4294967295,A=k+(T<<17&4294967295|T>>>15),T=C+(_^A&(k^_))+I[11]+2304563134&4294967295,C=A+(T<<22&4294967295|T>>>10),T=_+(k^C&(A^k))+I[12]+1804603682&4294967295,_=C+(T<<7&4294967295|T>>>25),T=k+(A^_&(C^A))+I[13]+4254626195&4294967295,k=_+(T<<12&4294967295|T>>>20),T=A+(C^k&(_^C))+I[14]+2792965006&4294967295,A=k+(T<<17&4294967295|T>>>15),T=C+(_^A&(k^_))+I[15]+1236535329&4294967295,C=A+(T<<22&4294967295|T>>>10),T=_+(A^k&(C^A))+I[1]+4129170786&4294967295,_=C+(T<<5&4294967295|T>>>27),T=k+(C^A&(_^C))+I[6]+3225465664&4294967295,k=_+(T<<9&4294967295|T>>>23),T=A+(_^C&(k^_))+I[11]+643717713&4294967295,A=k+(T<<14&4294967295|T>>>18),T=C+(k^_&(A^k))+I[0]+3921069994&4294967295,C=A+(T<<20&4294967295|T>>>12),T=_+(A^k&(C^A))+I[5]+3593408605&4294967295,_=C+(T<<5&4294967295|T>>>27),T=k+(C^A&(_^C))+I[10]+38016083&4294967295,k=_+(T<<9&4294967295|T>>>23),T=A+(_^C&(k^_))+I[15]+3634488961&4294967295,A=k+(T<<14&4294967295|T>>>18),T=C+(k^_&(A^k))+I[4]+3889429448&4294967295,C=A+(T<<20&4294967295|T>>>12),T=_+(A^k&(C^A))+I[9]+568446438&4294967295,_=C+(T<<5&4294967295|T>>>27),T=k+(C^A&(_^C))+I[14]+3275163606&4294967295,k=_+(T<<9&4294967295|T>>>23),T=A+(_^C&(k^_))+I[3]+4107603335&4294967295,A=k+(T<<14&4294967295|T>>>18),T=C+(k^_&(A^k))+I[8]+1163531501&4294967295,C=A+(T<<20&4294967295|T>>>12),T=_+(A^k&(C^A))+I[13]+2850285829&4294967295,_=C+(T<<5&4294967295|T>>>27),T=k+(C^A&(_^C))+I[2]+4243563512&4294967295,k=_+(T<<9&4294967295|T>>>23),T=A+(_^C&(k^_))+I[7]+1735328473&4294967295,A=k+(T<<14&4294967295|T>>>18),T=C+(k^_&(A^k))+I[12]+2368359562&4294967295,C=A+(T<<20&4294967295|T>>>12),T=_+(C^A^k)+I[5]+4294588738&4294967295,_=C+(T<<4&4294967295|T>>>28),T=k+(_^C^A)+I[8]+2272392833&4294967295,k=_+(T<<11&4294967295|T>>>21),T=A+(k^_^C)+I[11]+1839030562&4294967295,A=k+(T<<16&4294967295|T>>>16),T=C+(A^k^_)+I[14]+4259657740&4294967295,C=A+(T<<23&4294967295|T>>>9),T=_+(C^A^k)+I[1]+2763975236&4294967295,_=C+(T<<4&4294967295|T>>>28),T=k+(_^C^A)+I[4]+1272893353&4294967295,k=_+(T<<11&4294967295|T>>>21),T=A+(k^_^C)+I[7]+4139469664&4294967295,A=k+(T<<16&4294967295|T>>>16),T=C+(A^k^_)+I[10]+3200236656&4294967295,C=A+(T<<23&4294967295|T>>>9),T=_+(C^A^k)+I[13]+681279174&4294967295,_=C+(T<<4&4294967295|T>>>28),T=k+(_^C^A)+I[0]+3936430074&4294967295,k=_+(T<<11&4294967295|T>>>21),T=A+(k^_^C)+I[3]+3572445317&4294967295,A=k+(T<<16&4294967295|T>>>16),T=C+(A^k^_)+I[6]+76029189&4294967295,C=A+(T<<23&4294967295|T>>>9),T=_+(C^A^k)+I[9]+3654602809&4294967295,_=C+(T<<4&4294967295|T>>>28),T=k+(_^C^A)+I[12]+3873151461&4294967295,k=_+(T<<11&4294967295|T>>>21),T=A+(k^_^C)+I[15]+530742520&4294967295,A=k+(T<<16&4294967295|T>>>16),T=C+(A^k^_)+I[2]+3299628645&4294967295,C=A+(T<<23&4294967295|T>>>9),T=_+(A^(C|~k))+I[0]+4096336452&4294967295,_=C+(T<<6&4294967295|T>>>26),T=k+(C^(_|~A))+I[7]+1126891415&4294967295,k=_+(T<<10&4294967295|T>>>22),T=A+(_^(k|~C))+I[14]+2878612391&4294967295,A=k+(T<<15&4294967295|T>>>17),T=C+(k^(A|~_))+I[5]+4237533241&4294967295,C=A+(T<<21&4294967295|T>>>11),T=_+(A^(C|~k))+I[12]+1700485571&4294967295,_=C+(T<<6&4294967295|T>>>26),T=k+(C^(_|~A))+I[3]+2399980690&4294967295,k=_+(T<<10&4294967295|T>>>22),T=A+(_^(k|~C))+I[10]+4293915773&4294967295,A=k+(T<<15&4294967295|T>>>17),T=C+(k^(A|~_))+I[1]+2240044497&4294967295,C=A+(T<<21&4294967295|T>>>11),T=_+(A^(C|~k))+I[8]+1873313359&4294967295,_=C+(T<<6&4294967295|T>>>26),T=k+(C^(_|~A))+I[15]+4264355552&4294967295,k=_+(T<<10&4294967295|T>>>22),T=A+(_^(k|~C))+I[6]+2734768916&4294967295,A=k+(T<<15&4294967295|T>>>17),T=C+(k^(A|~_))+I[13]+1309151649&4294967295,C=A+(T<<21&4294967295|T>>>11),T=_+(A^(C|~k))+I[4]+4149444226&4294967295,_=C+(T<<6&4294967295|T>>>26),T=k+(C^(_|~A))+I[11]+3174756917&4294967295,k=_+(T<<10&4294967295|T>>>22),T=A+(_^(k|~C))+I[2]+718787259&4294967295,A=k+(T<<15&4294967295|T>>>17),T=C+(k^(A|~_))+I[9]+3951481745&4294967295,S.g[0]=S.g[0]+_&4294967295,S.g[1]=S.g[1]+(A+(T<<21&4294967295|T>>>11))&4294967295,S.g[2]=S.g[2]+A&4294967295,S.g[3]=S.g[3]+k&4294967295}r.prototype.u=function(S,_){_===void 0&&(_=S.length);for(var C=_-this.blockSize,I=this.B,A=this.h,k=0;k<_;){if(A==0)for(;k<=C;)s(this,S,k),k+=this.blockSize;if(typeof S=="string"){for(;k<_;)if(I[A++]=S.charCodeAt(k++),A==this.blockSize){s(this,I),A=0;break}}else for(;k<_;)if(I[A++]=S[k++],A==this.blockSize){s(this,I),A=0;break}}this.h=A,this.o+=_},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var _=1;_<S.length-8;++_)S[_]=0;var C=8*this.o;for(_=S.length-8;_<S.length;++_)S[_]=C&255,C/=256;for(this.u(S),S=Array(16),_=C=0;4>_;++_)for(var I=0;32>I;I+=8)S[C++]=this.g[_]>>>I&255;return S};function i(S,_){var C=l;return Object.prototype.hasOwnProperty.call(C,S)?C[S]:C[S]=_(S)}function o(S,_){this.h=_;for(var C=[],I=!0,A=S.length-1;0<=A;A--){var k=S[A]|0;I&&k==_||(C[A]=k,I=!1)}this.g=C}var l={};function u(S){return-128<=S&&128>S?i(S,function(_){return new o([_|0],0>_?-1:0)}):new o([S|0],0>S?-1:0)}function c(S){if(isNaN(S)||!isFinite(S))return p;if(0>S)return V(c(-S));for(var _=[],C=1,I=0;S>=C;I++)_[I]=S/C|0,C*=4294967296;return new o(_,0)}function d(S,_){if(S.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(S.charAt(0)=="-")return V(d(S.substring(1),_));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=c(Math.pow(_,8)),I=p,A=0;A<S.length;A+=8){var k=Math.min(8,S.length-A),T=parseInt(S.substring(A,A+k),_);8>k?(k=c(Math.pow(_,k)),I=I.j(k).add(c(T))):(I=I.j(C),I=I.add(c(T)))}return I}var p=u(0),m=u(1),v=u(16777216);t=o.prototype,t.m=function(){if(b(this))return-V(this).m();for(var S=0,_=1,C=0;C<this.g.length;C++){var I=this.i(C);S+=(0<=I?I:4294967296+I)*_,_*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(R(this))return"0";if(b(this))return"-"+V(this).toString(S);for(var _=c(Math.pow(S,6)),C=this,I="";;){var A=L(C,_).g;C=w(C,A.j(_));var k=((0<C.g.length?C.g[0]:C.h)>>>0).toString(S);if(C=A,R(C))return k+I;for(;6>k.length;)k="0"+k;I=k+I}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function R(S){if(S.h!=0)return!1;for(var _=0;_<S.g.length;_++)if(S.g[_]!=0)return!1;return!0}function b(S){return S.h==-1}t.l=function(S){return S=w(this,S),b(S)?-1:R(S)?0:1};function V(S){for(var _=S.g.length,C=[],I=0;I<_;I++)C[I]=~S.g[I];return new o(C,~S.h).add(m)}t.abs=function(){return b(this)?V(this):this},t.add=function(S){for(var _=Math.max(this.g.length,S.g.length),C=[],I=0,A=0;A<=_;A++){var k=I+(this.i(A)&65535)+(S.i(A)&65535),T=(k>>>16)+(this.i(A)>>>16)+(S.i(A)>>>16);I=T>>>16,k&=65535,T&=65535,C[A]=T<<16|k}return new o(C,C[C.length-1]&-2147483648?-1:0)};function w(S,_){return S.add(V(_))}t.j=function(S){if(R(this)||R(S))return p;if(b(this))return b(S)?V(this).j(V(S)):V(V(this).j(S));if(b(S))return V(this.j(V(S)));if(0>this.l(v)&&0>S.l(v))return c(this.m()*S.m());for(var _=this.g.length+S.g.length,C=[],I=0;I<2*_;I++)C[I]=0;for(I=0;I<this.g.length;I++)for(var A=0;A<S.g.length;A++){var k=this.i(I)>>>16,T=this.i(I)&65535,oe=S.i(A)>>>16,G=S.i(A)&65535;C[2*I+2*A]+=T*G,E(C,2*I+2*A),C[2*I+2*A+1]+=k*G,E(C,2*I+2*A+1),C[2*I+2*A+1]+=T*oe,E(C,2*I+2*A+1),C[2*I+2*A+2]+=k*oe,E(C,2*I+2*A+2)}for(I=0;I<_;I++)C[I]=C[2*I+1]<<16|C[2*I];for(I=_;I<2*_;I++)C[I]=0;return new o(C,0)};function E(S,_){for(;(S[_]&65535)!=S[_];)S[_+1]+=S[_]>>>16,S[_]&=65535,_++}function x(S,_){this.g=S,this.h=_}function L(S,_){if(R(_))throw Error("division by zero");if(R(S))return new x(p,p);if(b(S))return _=L(V(S),_),new x(V(_.g),V(_.h));if(b(_))return _=L(S,V(_)),new x(V(_.g),_.h);if(30<S.g.length){if(b(S)||b(_))throw Error("slowDivide_ only works with positive integers.");for(var C=m,I=_;0>=I.l(S);)C=z(C),I=z(I);var A=B(C,1),k=B(I,1);for(I=B(I,2),C=B(C,2);!R(I);){var T=k.add(I);0>=T.l(S)&&(A=A.add(C),k=T),I=B(I,1),C=B(C,1)}return _=w(S,A.j(_)),new x(A,_)}for(A=p;0<=S.l(_);){for(C=Math.max(1,Math.floor(S.m()/_.m())),I=Math.ceil(Math.log(C)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),k=c(C),T=k.j(_);b(T)||0<T.l(S);)C-=I,k=c(C),T=k.j(_);R(k)&&(k=m),A=A.add(k),S=w(S,T)}return new x(A,S)}t.A=function(S){return L(this,S).h},t.and=function(S){for(var _=Math.max(this.g.length,S.g.length),C=[],I=0;I<_;I++)C[I]=this.i(I)&S.i(I);return new o(C,this.h&S.h)},t.or=function(S){for(var _=Math.max(this.g.length,S.g.length),C=[],I=0;I<_;I++)C[I]=this.i(I)|S.i(I);return new o(C,this.h|S.h)},t.xor=function(S){for(var _=Math.max(this.g.length,S.g.length),C=[],I=0;I<_;I++)C[I]=this.i(I)^S.i(I);return new o(C,this.h^S.h)};function z(S){for(var _=S.g.length+1,C=[],I=0;I<_;I++)C[I]=S.i(I)<<1|S.i(I-1)>>>31;return new o(C,S.h)}function B(S,_){var C=_>>5;_%=32;for(var I=S.g.length-C,A=[],k=0;k<I;k++)A[k]=0<_?S.i(k+C)>>>_|S.i(k+C+1)<<32-_:S.i(k+C);return new o(A,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Z0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Mr=o}).apply(typeof sy<"u"?sy:typeof self<"u"?self:typeof window<"u"?window:{});var ll=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var eE,fo,tE,Rl,fh,nE,rE,sE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,f){return a==Array.prototype||a==Object.prototype||(a[h]=f.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof ll=="object"&&ll];for(var h=0;h<a.length;++h){var f=a[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(a,h){if(h)e:{var f=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var P=a[y];if(!(P in f))break e;f=f[P]}a=a[a.length-1],y=f[a],h=h(y),h!=y&&h!=null&&e(f,a,{configurable:!0,writable:!0,value:h})}}function i(a,h){a instanceof String&&(a+="");var f=0,y=!1,P={next:function(){if(!y&&f<a.length){var O=f++;return{value:h(O,a[O]),done:!1}}return y=!0,{done:!0,value:void 0}}};return P[Symbol.iterator]=function(){return P},P}s("Array.prototype.values",function(a){return a||function(){return i(this,function(h,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function c(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function d(a,h,f){return a.call.apply(a.bind,arguments)}function p(a,h,f){if(!a)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var P=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(P,y),a.apply(h,P)}}return function(){return a.apply(h,arguments)}}function m(a,h,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:p,m.apply(null,arguments)}function v(a,h){var f=Array.prototype.slice.call(arguments,1);return function(){var y=f.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function R(a,h){function f(){}f.prototype=h.prototype,a.aa=h.prototype,a.prototype=new f,a.prototype.constructor=a,a.Qb=function(y,P,O){for(var q=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)q[ke-2]=arguments[ke];return h.prototype[P].apply(y,q)}}function b(a){const h=a.length;if(0<h){const f=Array(h);for(let y=0;y<h;y++)f[y]=a[y];return f}return[]}function V(a,h){for(let f=1;f<arguments.length;f++){const y=arguments[f];if(u(y)){const P=a.length||0,O=y.length||0;a.length=P+O;for(let q=0;q<O;q++)a[P+q]=y[q]}else a.push(y)}}class w{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function E(a){return/^[\s\xa0]*$/.test(a)}function x(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function L(a){return L[" "](a),a}L[" "]=function(){};var z=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function B(a,h,f){for(const y in a)h.call(f,a[y],y,a)}function S(a,h){for(const f in a)h.call(void 0,a[f],f,a)}function _(a){const h={};for(const f in a)h[f]=a[f];return h}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(a,h){let f,y;for(let P=1;P<arguments.length;P++){y=arguments[P];for(f in y)a[f]=y[f];for(let O=0;O<C.length;O++)f=C[O],Object.prototype.hasOwnProperty.call(y,f)&&(a[f]=y[f])}}function A(a){var h=1;a=a.split(":");const f=[];for(;0<h&&a.length;)f.push(a.shift()),h--;return a.length&&f.push(a.join(":")),f}function k(a){l.setTimeout(()=>{throw a},0)}function T(){var a=te;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class oe{constructor(){this.h=this.g=null}add(h,f){const y=G.get();y.set(h,f),this.h?this.h.next=y:this.g=y,this.h=y}}var G=new w(()=>new ne,a=>a.reset());class ne{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,$=!1,te=new oe,H=()=>{const a=l.Promise.resolve(void 0);fe=()=>{a.then(ce)}};var ce=()=>{for(var a;a=T();){try{a.h.call(a.g)}catch(f){k(f)}var h=G;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}$=!1};function le(){this.s=this.s,this.C=this.C}le.prototype.s=!1,le.prototype.ma=function(){this.s||(this.s=!0,this.N())},le.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function de(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}de.prototype.h=function(){this.defaultPrevented=!0};var $e=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const f=()=>{};l.addEventListener("test",f,h),l.removeEventListener("test",f,h)}catch{}return a}();function At(a,h){if(de.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var f=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(z){e:{try{L(h.nodeName);var P=!0;break e}catch{}P=!1}P||(h=null)}}else f=="mouseover"?h=a.fromElement:f=="mouseout"&&(h=a.toElement);this.relatedTarget=h,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:gt[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&At.aa.h.call(this)}}R(At,de);var gt={2:"touch",3:"pen",4:"mouse"};At.prototype.h=function(){At.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var rt="closure_listenable_"+(1e6*Math.random()|0),gn=0;function Yt(a,h,f,y,P){this.listener=a,this.proxy=null,this.src=h,this.type=f,this.capture=!!y,this.ha=P,this.key=++gn,this.da=this.fa=!1}function pe(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Re(a){this.src=a,this.g={},this.h=0}Re.prototype.add=function(a,h,f,y,P){var O=a.toString();a=this.g[O],a||(a=this.g[O]=[],this.h++);var q=yt(a,h,y,P);return-1<q?(h=a[q],f||(h.fa=!1)):(h=new Yt(h,this.src,O,!!y,P),h.fa=f,a.push(h)),h};function bt(a,h){var f=h.type;if(f in a.g){var y=a.g[f],P=Array.prototype.indexOf.call(y,h,void 0),O;(O=0<=P)&&Array.prototype.splice.call(y,P,1),O&&(pe(h),a.g[f].length==0&&(delete a.g[f],a.h--))}}function yt(a,h,f,y){for(var P=0;P<a.length;++P){var O=a[P];if(!O.da&&O.listener==h&&O.capture==!!f&&O.ha==y)return P}return-1}var _t="closure_lm_"+(1e6*Math.random()|0),zn={};function cr(a,h,f,y,P){if(Array.isArray(h)){for(var O=0;O<h.length;O++)cr(a,h[O],f,y,P);return null}return f=xn(f),a&&a[rt]?a.K(h,f,c(y)?!!y.capture:!1,P):ns(a,h,f,!1,y,P)}function ns(a,h,f,y,P,O){if(!h)throw Error("Invalid event type");var q=c(P)?!!P.capture:!!P,ke=hr(a);if(ke||(a[_t]=ke=new Re(a)),f=ke.add(h,f,y,q,O),f.proxy)return f;if(y=rs(),f.proxy=y,y.src=a,y.listener=f,a.addEventListener)$e||(P=q),P===void 0&&(P=!1),a.addEventListener(h.toString(),y,P);else if(a.attachEvent)a.attachEvent(js(h.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return f}function rs(){function a(f){return h.call(a.src,a.listener,f)}const h=Li;return a}function dr(a,h,f,y,P){if(Array.isArray(h))for(var O=0;O<h.length;O++)dr(a,h[O],f,y,P);else y=c(y)?!!y.capture:!!y,f=xn(f),a&&a[rt]?(a=a.i,h=String(h).toString(),h in a.g&&(O=a.g[h],f=yt(O,f,y,P),-1<f&&(pe(O[f]),Array.prototype.splice.call(O,f,1),O.length==0&&(delete a.g[h],a.h--)))):a&&(a=hr(a))&&(h=a.g[h.toString()],a=-1,h&&(a=yt(h,f,y,P)),(f=-1<a?h[a]:null)&&Rn(f))}function Rn(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[rt])bt(h.i,a);else{var f=a.type,y=a.proxy;h.removeEventListener?h.removeEventListener(f,y,a.capture):h.detachEvent?h.detachEvent(js(f),y):h.addListener&&h.removeListener&&h.removeListener(y),(f=hr(h))?(bt(f,a),f.h==0&&(f.src=null,h[_t]=null)):pe(a)}}}function js(a){return a in zn?zn[a]:zn[a]="on"+a}function Li(a,h){if(a.da)a=!0;else{h=new At(h,this);var f=a.listener,y=a.ha||a.src;a.fa&&Rn(a),a=f.call(y,h)}return a}function hr(a){return a=a[_t],a instanceof Re?a:null}var qn="__closure_events_fn_"+(1e9*Math.random()>>>0);function xn(a){return typeof a=="function"?a:(a[qn]||(a[qn]=function(h){return a.handleEvent(h)}),a[qn])}function Ve(){le.call(this),this.i=new Re(this),this.M=this,this.F=null}R(Ve,le),Ve.prototype[rt]=!0,Ve.prototype.removeEventListener=function(a,h,f,y){dr(this,a,h,f,y)};function M(a,h){var f,y=a.F;if(y)for(f=[];y;y=y.F)f.push(y);if(a=a.M,y=h.type||h,typeof h=="string")h=new de(h,a);else if(h instanceof de)h.target=h.target||a;else{var P=h;h=new de(y,a),I(h,P)}if(P=!0,f)for(var O=f.length-1;0<=O;O--){var q=h.g=f[O];P=Q(q,y,!0,h)&&P}if(q=h.g=a,P=Q(q,y,!0,h)&&P,P=Q(q,y,!1,h)&&P,f)for(O=0;O<f.length;O++)q=h.g=f[O],P=Q(q,y,!1,h)&&P}Ve.prototype.N=function(){if(Ve.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var f=a.g[h],y=0;y<f.length;y++)pe(f[y]);delete a.g[h],a.h--}}this.F=null},Ve.prototype.K=function(a,h,f,y){return this.i.add(String(a),h,!1,f,y)},Ve.prototype.L=function(a,h,f,y){return this.i.add(String(a),h,!0,f,y)};function Q(a,h,f,y){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var P=!0,O=0;O<h.length;++O){var q=h[O];if(q&&!q.da&&q.capture==f){var ke=q.listener,lt=q.ha||q.src;q.fa&&bt(a.i,q),P=ke.call(lt,y)!==!1&&P}}return P&&!y.defaultPrevented}function Y(a,h,f){if(typeof a=="function")f&&(a=m(a,f));else if(a&&typeof a.handleEvent=="function")a=m(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(a,h||0)}function X(a){a.g=Y(()=>{a.g=null,a.i&&(a.i=!1,X(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class me extends le{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:X(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function N(a){le.call(this),this.h=a,this.g={}}R(N,le);var K=[];function re(a){B(a.g,function(h,f){this.g.hasOwnProperty(f)&&Rn(h)},a),a.g={}}N.prototype.N=function(){N.aa.N.call(this),re(this)},N.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var be=l.JSON.stringify,Jt=l.JSON.parse,Ft=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function kn(){}kn.prototype.h=null;function ss(a){return a.h||(a.h=a.i())}function ji(){}var Fi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function yc(){de.call(this,"d")}R(yc,de);function _c(){de.call(this,"c")}R(_c,de);var is={},Kp=null;function ba(){return Kp=Kp||new Ve}is.La="serverreachability";function Qp(a){de.call(this,is.La,a)}R(Qp,de);function Bi(a){const h=ba();M(h,new Qp(h))}is.STAT_EVENT="statevent";function Yp(a,h){de.call(this,is.STAT_EVENT,a),this.stat=h}R(Yp,de);function Pt(a){const h=ba();M(h,new Yp(h,a))}is.Ma="timingevent";function Jp(a,h){de.call(this,is.Ma,a),this.size=h}R(Jp,de);function Ui(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},h)}function $i(){this.g=!0}$i.prototype.xa=function(){this.g=!1};function Jw(a,h,f,y,P,O){a.info(function(){if(a.g)if(O)for(var q="",ke=O.split("&"),lt=0;lt<ke.length;lt++){var we=ke[lt].split("=");if(1<we.length){var vt=we[0];we=we[1];var Et=vt.split("_");q=2<=Et.length&&Et[1]=="type"?q+(vt+"="+we+"&"):q+(vt+"=redacted&")}}else q=null;else q=O;return"XMLHTTP REQ ("+y+") [attempt "+P+"]: "+h+`
`+f+`
`+q})}function Xw(a,h,f,y,P,O,q){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+P+"]: "+h+`
`+f+`
`+O+" "+q})}function Fs(a,h,f,y){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+eS(a,f)+(y?" "+y:"")})}function Zw(a,h){a.info(function(){return"TIMEOUT: "+h})}$i.prototype.info=function(){};function eS(a,h){if(!a.g)return h;if(!h)return null;try{var f=JSON.parse(h);if(f){for(a=0;a<f.length;a++)if(Array.isArray(f[a])){var y=f[a];if(!(2>y.length)){var P=y[1];if(Array.isArray(P)&&!(1>P.length)){var O=P[0];if(O!="noop"&&O!="stop"&&O!="close")for(var q=1;q<P.length;q++)P[q]=""}}}}return be(f)}catch{return h}}var Pa={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Xp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},vc;function Na(){}R(Na,kn),Na.prototype.g=function(){return new XMLHttpRequest},Na.prototype.i=function(){return{}},vc=new Na;function fr(a,h,f,y){this.j=a,this.i=h,this.l=f,this.R=y||1,this.U=new N(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Zp}function Zp(){this.i=null,this.g="",this.h=!1}var em={},Ec={};function Tc(a,h,f){a.L=1,a.v=Oa(Wn(h)),a.m=f,a.P=!0,tm(a,null)}function tm(a,h){a.F=Date.now(),Da(a),a.A=Wn(a.v);var f=a.A,y=a.R;Array.isArray(y)||(y=[String(y)]),mm(f.i,"t",y),a.C=0,f=a.j.J,a.h=new Zp,a.g=Dm(a.j,f?h:null,!a.m),0<a.O&&(a.M=new me(m(a.Y,a,a.g),a.O)),h=a.U,f=a.g,y=a.ca;var P="readystatechange";Array.isArray(P)||(P&&(K[0]=P.toString()),P=K);for(var O=0;O<P.length;O++){var q=cr(f,P[O],y||h.handleEvent,!1,h.h||h);if(!q)break;h.g[q.key]=q}h=a.H?_(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),Bi(),Jw(a.i,a.u,a.A,a.l,a.R,a.m)}fr.prototype.ca=function(a){a=a.target;const h=this.M;h&&Hn(a)==3?h.j():this.Y(a)},fr.prototype.Y=function(a){try{if(a==this.g)e:{const Et=Hn(this.g);var h=this.g.Ba();const $s=this.g.Z();if(!(3>Et)&&(Et!=3||this.g&&(this.h.h||this.g.oa()||wm(this.g)))){this.J||Et!=4||h==7||(h==8||0>=$s?Bi(3):Bi(2)),wc(this);var f=this.g.Z();this.X=f;t:if(nm(this)){var y=wm(this.g);a="";var P=y.length,O=Hn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){os(this),zi(this);var q="";break t}this.h.i=new l.TextDecoder}for(h=0;h<P;h++)this.h.h=!0,a+=this.h.i.decode(y[h],{stream:!(O&&h==P-1)});y.length=0,this.h.g+=a,this.C=0,q=this.h.g}else q=this.g.oa();if(this.o=f==200,Xw(this.i,this.u,this.A,this.l,this.R,Et,f),this.o){if(this.T&&!this.K){t:{if(this.g){var ke,lt=this.g;if((ke=lt.g?lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(ke)){var we=ke;break t}}we=null}if(f=we)Fs(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Sc(this,f);else{this.o=!1,this.s=3,Pt(12),os(this),zi(this);break e}}if(this.P){f=!0;let yn;for(;!this.J&&this.C<q.length;)if(yn=tS(this,q),yn==Ec){Et==4&&(this.s=4,Pt(14),f=!1),Fs(this.i,this.l,null,"[Incomplete Response]");break}else if(yn==em){this.s=4,Pt(15),Fs(this.i,this.l,q,"[Invalid Chunk]"),f=!1;break}else Fs(this.i,this.l,yn,null),Sc(this,yn);if(nm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Et!=4||q.length!=0||this.h.h||(this.s=1,Pt(16),f=!1),this.o=this.o&&f,!f)Fs(this.i,this.l,q,"[Invalid Chunked Response]"),os(this),zi(this);else if(0<q.length&&!this.W){this.W=!0;var vt=this.j;vt.g==this&&vt.ba&&!vt.M&&(vt.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),Ac(vt),vt.M=!0,Pt(11))}}else Fs(this.i,this.l,q,null),Sc(this,q);Et==4&&os(this),this.o&&!this.J&&(Et==4?Am(this.j,this):(this.o=!1,Da(this)))}else _S(this.g),f==400&&0<q.indexOf("Unknown SID")?(this.s=3,Pt(12)):(this.s=0,Pt(13)),os(this),zi(this)}}}catch{}finally{}};function nm(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function tS(a,h){var f=a.C,y=h.indexOf(`
`,f);return y==-1?Ec:(f=Number(h.substring(f,y)),isNaN(f)?em:(y+=1,y+f>h.length?Ec:(h=h.slice(y,y+f),a.C=y+f,h)))}fr.prototype.cancel=function(){this.J=!0,os(this)};function Da(a){a.S=Date.now()+a.I,rm(a,a.I)}function rm(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Ui(m(a.ba,a),h)}function wc(a){a.B&&(l.clearTimeout(a.B),a.B=null)}fr.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(Zw(this.i,this.A),this.L!=2&&(Bi(),Pt(17)),os(this),this.s=2,zi(this)):rm(this,this.S-a)};function zi(a){a.j.G==0||a.J||Am(a.j,a)}function os(a){wc(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,re(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Sc(a,h){try{var f=a.j;if(f.G!=0&&(f.g==a||Cc(f.h,a))){if(!a.K&&Cc(f.h,a)&&f.G==3){try{var y=f.Da.g.parse(h)}catch{y=null}if(Array.isArray(y)&&y.length==3){var P=y;if(P[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<a.F)$a(f),Ba(f);else break e;kc(f),Pt(18)}}else f.za=P[1],0<f.za-f.T&&37500>P[2]&&f.F&&f.v==0&&!f.C&&(f.C=Ui(m(f.Za,f),6e3));if(1>=om(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else ls(f,11)}else if((a.K||f.g==a)&&$a(f),!E(h))for(P=f.Da.g.parse(h),h=0;h<P.length;h++){let we=P[h];if(f.T=we[0],we=we[1],f.G==2)if(we[0]=="c"){f.K=we[1],f.ia=we[2];const vt=we[3];vt!=null&&(f.la=vt,f.j.info("VER="+f.la));const Et=we[4];Et!=null&&(f.Aa=Et,f.j.info("SVER="+f.Aa));const $s=we[5];$s!=null&&typeof $s=="number"&&0<$s&&(y=1.5*$s,f.L=y,f.j.info("backChannelRequestTimeoutMs_="+y)),y=f;const yn=a.g;if(yn){const qa=yn.g?yn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qa){var O=y.h;O.g||qa.indexOf("spdy")==-1&&qa.indexOf("quic")==-1&&qa.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(Ic(O,O.h),O.h=null))}if(y.D){const bc=yn.g?yn.g.getResponseHeader("X-HTTP-Session-Id"):null;bc&&(y.ya=bc,Pe(y.I,y.D,bc))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-a.F,f.j.info("Handshake RTT: "+f.R+"ms")),y=f;var q=a;if(y.qa=Nm(y,y.J?y.ia:null,y.W),q.K){am(y.h,q);var ke=q,lt=y.L;lt&&(ke.I=lt),ke.B&&(wc(ke),Da(ke)),y.g=q}else xm(y);0<f.i.length&&Ua(f)}else we[0]!="stop"&&we[0]!="close"||ls(f,7);else f.G==3&&(we[0]=="stop"||we[0]=="close"?we[0]=="stop"?ls(f,7):xc(f):we[0]!="noop"&&f.l&&f.l.ta(we),f.v=0)}}Bi(4)}catch{}}var nS=class{constructor(a,h){this.g=a,this.map=h}};function sm(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function im(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function om(a){return a.h?1:a.g?a.g.size:0}function Cc(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Ic(a,h){a.g?a.g.add(h):a.h=h}function am(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}sm.prototype.cancel=function(){if(this.i=lm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function lm(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const f of a.g.values())h=h.concat(f.D);return h}return b(a.i)}function rS(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var h=[],f=a.length,y=0;y<f;y++)h.push(a[y]);return h}h=[],f=0;for(y in a)h[f++]=a[y];return h}function sS(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var h=[];a=a.length;for(var f=0;f<a;f++)h.push(f);return h}h=[],f=0;for(const y in a)h[f++]=y;return h}}}function um(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var f=sS(a),y=rS(a),P=y.length,O=0;O<P;O++)h.call(void 0,y[O],f&&f[O],a)}var cm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function iS(a,h){if(a){a=a.split("&");for(var f=0;f<a.length;f++){var y=a[f].indexOf("="),P=null;if(0<=y){var O=a[f].substring(0,y);P=a[f].substring(y+1)}else O=a[f];h(O,P?decodeURIComponent(P.replace(/\+/g," ")):"")}}}function as(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof as){this.h=a.h,Va(this,a.j),this.o=a.o,this.g=a.g,Ma(this,a.s),this.l=a.l;var h=a.i,f=new Hi;f.i=h.i,h.g&&(f.g=new Map(h.g),f.h=h.h),dm(this,f),this.m=a.m}else a&&(h=String(a).match(cm))?(this.h=!1,Va(this,h[1]||"",!0),this.o=qi(h[2]||""),this.g=qi(h[3]||"",!0),Ma(this,h[4]),this.l=qi(h[5]||"",!0),dm(this,h[6]||"",!0),this.m=qi(h[7]||"")):(this.h=!1,this.i=new Hi(null,this.h))}as.prototype.toString=function(){var a=[],h=this.j;h&&a.push(Wi(h,hm,!0),":");var f=this.g;return(f||h=="file")&&(a.push("//"),(h=this.o)&&a.push(Wi(h,hm,!0),"@"),a.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&a.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&a.push("/"),a.push(Wi(f,f.charAt(0)=="/"?lS:aS,!0))),(f=this.i.toString())&&a.push("?",f),(f=this.m)&&a.push("#",Wi(f,cS)),a.join("")};function Wn(a){return new as(a)}function Va(a,h,f){a.j=f?qi(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function Ma(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function dm(a,h,f){h instanceof Hi?(a.i=h,dS(a.i,a.h)):(f||(h=Wi(h,uS)),a.i=new Hi(h,a.h))}function Pe(a,h,f){a.i.set(h,f)}function Oa(a){return Pe(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function qi(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Wi(a,h,f){return typeof a=="string"?(a=encodeURI(a).replace(h,oS),f&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function oS(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var hm=/[#\/\?@]/g,aS=/[#\?:]/g,lS=/[#\?]/g,uS=/[#\?@]/g,cS=/#/g;function Hi(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function pr(a){a.g||(a.g=new Map,a.h=0,a.i&&iS(a.i,function(h,f){a.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}t=Hi.prototype,t.add=function(a,h){pr(this),this.i=null,a=Bs(this,a);var f=this.g.get(a);return f||this.g.set(a,f=[]),f.push(h),this.h+=1,this};function fm(a,h){pr(a),h=Bs(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function pm(a,h){return pr(a),h=Bs(a,h),a.g.has(h)}t.forEach=function(a,h){pr(this),this.g.forEach(function(f,y){f.forEach(function(P){a.call(h,P,y,this)},this)},this)},t.na=function(){pr(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),f=[];for(let y=0;y<h.length;y++){const P=a[y];for(let O=0;O<P.length;O++)f.push(h[y])}return f},t.V=function(a){pr(this);let h=[];if(typeof a=="string")pm(this,a)&&(h=h.concat(this.g.get(Bs(this,a))));else{a=Array.from(this.g.values());for(let f=0;f<a.length;f++)h=h.concat(a[f])}return h},t.set=function(a,h){return pr(this),this.i=null,a=Bs(this,a),pm(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function mm(a,h,f){fm(a,h),0<f.length&&(a.i=null,a.g.set(Bs(a,h),b(f)),a.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var f=0;f<h.length;f++){var y=h[f];const O=encodeURIComponent(String(y)),q=this.V(y);for(y=0;y<q.length;y++){var P=O;q[y]!==""&&(P+="="+encodeURIComponent(String(q[y]))),a.push(P)}}return this.i=a.join("&")};function Bs(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function dS(a,h){h&&!a.j&&(pr(a),a.i=null,a.g.forEach(function(f,y){var P=y.toLowerCase();y!=P&&(fm(this,y),mm(this,P,f))},a)),a.j=h}function hS(a,h){const f=new $i;if(l.Image){const y=new Image;y.onload=v(mr,f,"TestLoadImage: loaded",!0,h,y),y.onerror=v(mr,f,"TestLoadImage: error",!1,h,y),y.onabort=v(mr,f,"TestLoadImage: abort",!1,h,y),y.ontimeout=v(mr,f,"TestLoadImage: timeout",!1,h,y),l.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else h(!1)}function fS(a,h){const f=new $i,y=new AbortController,P=setTimeout(()=>{y.abort(),mr(f,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:y.signal}).then(O=>{clearTimeout(P),O.ok?mr(f,"TestPingServer: ok",!0,h):mr(f,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(P),mr(f,"TestPingServer: error",!1,h)})}function mr(a,h,f,y,P){try{P&&(P.onload=null,P.onerror=null,P.onabort=null,P.ontimeout=null),y(f)}catch{}}function pS(){this.g=new Ft}function mS(a,h,f){const y=f||"";try{um(a,function(P,O){let q=P;c(P)&&(q=be(P)),h.push(y+O+"="+encodeURIComponent(q))})}catch(P){throw h.push(y+"type="+encodeURIComponent("_badmap")),P}}function La(a){this.l=a.Ub||null,this.j=a.eb||!1}R(La,kn),La.prototype.g=function(){return new ja(this.l,this.j)},La.prototype.i=function(a){return function(){return a}}({});function ja(a,h){Ve.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(ja,Ve),t=ja.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,Ki(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Gi(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ki(this)),this.g&&(this.readyState=3,Ki(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;gm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function gm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Gi(this):Ki(this),this.readyState==3&&gm(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Gi(this))},t.Qa=function(a){this.g&&(this.response=a,Gi(this))},t.ga=function(){this.g&&Gi(this)};function Gi(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ki(a)}t.setRequestHeader=function(a,h){this.u.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var f=h.next();!f.done;)f=f.value,a.push(f[0]+": "+f[1]),f=h.next();return a.join(`\r
`)};function Ki(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(ja.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function ym(a){let h="";return B(a,function(f,y){h+=y,h+=":",h+=f,h+=`\r
`}),h}function Rc(a,h,f){e:{for(y in f){var y=!1;break e}y=!0}y||(f=ym(f),typeof a=="string"?f!=null&&encodeURIComponent(String(f)):Pe(a,h,f))}function ze(a){Ve.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(ze,Ve);var gS=/^https?$/i,yS=["POST","PUT"];t=ze.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,h,f,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():vc.g(),this.v=this.o?ss(this.o):ss(vc),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(O){_m(this,O);return}if(a=f||"",f=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var P in y)f.set(P,y[P]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const O of y.keys())f.set(O,y.get(O));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(f.keys()).find(O=>O.toLowerCase()=="content-type"),P=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(yS,h,void 0))||y||P||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[O,q]of f)this.g.setRequestHeader(O,q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Tm(this),this.u=!0,this.g.send(a),this.u=!1}catch(O){_m(this,O)}};function _m(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,vm(a),Fa(a)}function vm(a){a.A||(a.A=!0,M(a,"complete"),M(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,M(this,"complete"),M(this,"abort"),Fa(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Fa(this,!0)),ze.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Em(this):this.bb())},t.bb=function(){Em(this)};function Em(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Hn(a)!=4||a.Z()!=2)){if(a.u&&Hn(a)==4)Y(a.Ea,0,a);else if(M(a,"readystatechange"),Hn(a)==4){a.h=!1;try{const q=a.Z();e:switch(q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var y;if(y=q===0){var P=String(a.D).match(cm)[1]||null;!P&&l.self&&l.self.location&&(P=l.self.location.protocol.slice(0,-1)),y=!gS.test(P?P.toLowerCase():"")}f=y}if(f)M(a,"complete"),M(a,"success");else{a.m=6;try{var O=2<Hn(a)?a.g.statusText:""}catch{O=""}a.l=O+" ["+a.Z()+"]",vm(a)}}finally{Fa(a)}}}}function Fa(a,h){if(a.g){Tm(a);const f=a.g,y=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||M(a,"ready");try{f.onreadystatechange=y}catch{}}}function Tm(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function Hn(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<Hn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),Jt(h)}};function wm(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function _S(a){const h={};a=(a.g&&2<=Hn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(E(a[y]))continue;var f=A(a[y]);const P=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const O=h[P]||[];h[P]=O,O.push(f)}S(h,function(y){return y.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qi(a,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[a]||h}function Sm(a){this.Aa=0,this.i=[],this.j=new $i,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Qi("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Qi("baseRetryDelayMs",5e3,a),this.cb=Qi("retryDelaySeedMs",1e4,a),this.Wa=Qi("forwardChannelMaxRetries",2,a),this.wa=Qi("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new sm(a&&a.concurrentRequestLimit),this.Da=new pS,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Sm.prototype,t.la=8,t.G=1,t.connect=function(a,h,f,y){Pt(0),this.W=a,this.H=h||{},f&&y!==void 0&&(this.H.OSID=f,this.H.OAID=y),this.F=this.X,this.I=Nm(this,null,this.W),Ua(this)};function xc(a){if(Cm(a),a.G==3){var h=a.U++,f=Wn(a.I);if(Pe(f,"SID",a.K),Pe(f,"RID",h),Pe(f,"TYPE","terminate"),Yi(a,f),h=new fr(a,a.j,h),h.L=2,h.v=Oa(Wn(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=h.v,f=!0),f||(h.g=Dm(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Da(h)}Pm(a)}function Ba(a){a.g&&(Ac(a),a.g.cancel(),a.g=null)}function Cm(a){Ba(a),a.u&&(l.clearTimeout(a.u),a.u=null),$a(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function Ua(a){if(!im(a.h)&&!a.s){a.s=!0;var h=a.Ga;fe||H(),$||(fe(),$=!0),te.add(h,a),a.B=0}}function vS(a,h){return om(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Ui(m(a.Ga,a,h),bm(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const P=new fr(this,this.j,a);let O=this.o;if(this.S&&(O?(O=_(O),I(O,this.S)):O=this.S),this.m!==null||this.O||(P.H=O,O=null),this.P)e:{for(var h=0,f=0;f<this.i.length;f++){t:{var y=this.i[f];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(h+=y,4096<h){h=f;break e}if(h===4096||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=Rm(this,P,h),f=Wn(this.I),Pe(f,"RID",a),Pe(f,"CVER",22),this.D&&Pe(f,"X-HTTP-Session-Id",this.D),Yi(this,f),O&&(this.O?h="headers="+encodeURIComponent(String(ym(O)))+"&"+h:this.m&&Rc(f,this.m,O)),Ic(this.h,P),this.Ua&&Pe(f,"TYPE","init"),this.P?(Pe(f,"$req",h),Pe(f,"SID","null"),P.T=!0,Tc(P,f,null)):Tc(P,f,h),this.G=2}}else this.G==3&&(a?Im(this,a):this.i.length==0||im(this.h)||Im(this))};function Im(a,h){var f;h?f=h.l:f=a.U++;const y=Wn(a.I);Pe(y,"SID",a.K),Pe(y,"RID",f),Pe(y,"AID",a.T),Yi(a,y),a.m&&a.o&&Rc(y,a.m,a.o),f=new fr(a,a.j,f,a.B+1),a.m===null&&(f.H=a.o),h&&(a.i=h.D.concat(a.i)),h=Rm(a,f,1e3),f.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Ic(a.h,f),Tc(f,y,h)}function Yi(a,h){a.H&&B(a.H,function(f,y){Pe(h,y,f)}),a.l&&um({},function(f,y){Pe(h,y,f)})}function Rm(a,h,f){f=Math.min(a.i.length,f);var y=a.l?m(a.l.Na,a.l,a):null;e:{var P=a.i;let O=-1;for(;;){const q=["count="+f];O==-1?0<f?(O=P[0].g,q.push("ofs="+O)):O=0:q.push("ofs="+O);let ke=!0;for(let lt=0;lt<f;lt++){let we=P[lt].g;const vt=P[lt].map;if(we-=O,0>we)O=Math.max(0,P[lt].g-100),ke=!1;else try{mS(vt,q,"req"+we+"_")}catch{y&&y(vt)}}if(ke){y=q.join("&");break e}}}return a=a.i.splice(0,f),h.D=a,y}function xm(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;fe||H(),$||(fe(),$=!0),te.add(h,a),a.v=0}}function kc(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Ui(m(a.Fa,a),bm(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,km(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Ui(m(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Pt(10),Ba(this),km(this))};function Ac(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function km(a){a.g=new fr(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=Wn(a.qa);Pe(h,"RID","rpc"),Pe(h,"SID",a.K),Pe(h,"AID",a.T),Pe(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&Pe(h,"TO",a.ja),Pe(h,"TYPE","xmlhttp"),Yi(a,h),a.m&&a.o&&Rc(h,a.m,a.o),a.L&&(a.g.I=a.L);var f=a.g;a=a.ia,f.L=1,f.v=Oa(Wn(h)),f.m=null,f.P=!0,tm(f,a)}t.Za=function(){this.C!=null&&(this.C=null,Ba(this),kc(this),Pt(19))};function $a(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function Am(a,h){var f=null;if(a.g==h){$a(a),Ac(a),a.g=null;var y=2}else if(Cc(a.h,h))f=h.D,am(a.h,h),y=1;else return;if(a.G!=0){if(h.o)if(y==1){f=h.m?h.m.length:0,h=Date.now()-h.F;var P=a.B;y=ba(),M(y,new Jp(y,f)),Ua(a)}else xm(a);else if(P=h.s,P==3||P==0&&0<h.X||!(y==1&&vS(a,h)||y==2&&kc(a)))switch(f&&0<f.length&&(h=a.h,h.i=h.i.concat(f)),P){case 1:ls(a,5);break;case 4:ls(a,10);break;case 3:ls(a,6);break;default:ls(a,2)}}}function bm(a,h){let f=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(f*=2),f*h}function ls(a,h){if(a.j.info("Error code "+h),h==2){var f=m(a.fb,a),y=a.Xa;const P=!y;y=new as(y||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Va(y,"https"),Oa(y),P?hS(y.toString(),f):fS(y.toString(),f)}else Pt(2);a.G=0,a.l&&a.l.sa(h),Pm(a),Cm(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Pt(2)):(this.j.info("Failed to ping google.com"),Pt(1))};function Pm(a){if(a.G=0,a.ka=[],a.l){const h=lm(a.h);(h.length!=0||a.i.length!=0)&&(V(a.ka,h),V(a.ka,a.i),a.h.i.length=0,b(a.i),a.i.length=0),a.l.ra()}}function Nm(a,h,f){var y=f instanceof as?Wn(f):new as(f);if(y.g!="")h&&(y.g=h+"."+y.g),Ma(y,y.s);else{var P=l.location;y=P.protocol,h=h?h+"."+P.hostname:P.hostname,P=+P.port;var O=new as(null);y&&Va(O,y),h&&(O.g=h),P&&Ma(O,P),f&&(O.l=f),y=O}return f=a.D,h=a.ya,f&&h&&Pe(y,f,h),Pe(y,"VER",a.la),Yi(a,y),y}function Dm(a,h,f){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new ze(new La({eb:f})):new ze(a.pa),h.Ha(a.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vm(){}t=Vm.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function za(){}za.prototype.g=function(a,h){return new Xt(a,h)};function Xt(a,h){Ve.call(this),this.g=new Sm(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!E(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!E(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new Us(this)}R(Xt,Ve),Xt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Xt.prototype.close=function(){xc(this.g)},Xt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var f={};f.__data__=a,a=f}else this.u&&(f={},f.__data__=be(a),a=f);h.i.push(new nS(h.Ya++,a)),h.G==3&&Ua(h)},Xt.prototype.N=function(){this.g.l=null,delete this.j,xc(this.g),delete this.g,Xt.aa.N.call(this)};function Mm(a){yc.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const f in h){a=f;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}R(Mm,yc);function Om(){_c.call(this),this.status=1}R(Om,_c);function Us(a){this.g=a}R(Us,Vm),Us.prototype.ua=function(){M(this.g,"a")},Us.prototype.ta=function(a){M(this.g,new Mm(a))},Us.prototype.sa=function(a){M(this.g,new Om)},Us.prototype.ra=function(){M(this.g,"b")},za.prototype.createWebChannel=za.prototype.g,Xt.prototype.send=Xt.prototype.o,Xt.prototype.open=Xt.prototype.m,Xt.prototype.close=Xt.prototype.close,sE=function(){return new za},rE=function(){return ba()},nE=is,fh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Pa.NO_ERROR=0,Pa.TIMEOUT=8,Pa.HTTP_ERROR=6,Rl=Pa,Xp.COMPLETE="complete",tE=Xp,ji.EventType=Fi,Fi.OPEN="a",Fi.CLOSE="b",Fi.ERROR="c",Fi.MESSAGE="d",Ve.prototype.listen=Ve.prototype.K,fo=ji,ze.prototype.listenOnce=ze.prototype.L,ze.prototype.getLastError=ze.prototype.Ka,ze.prototype.getLastErrorCode=ze.prototype.Ba,ze.prototype.getStatus=ze.prototype.Z,ze.prototype.getResponseJson=ze.prototype.Oa,ze.prototype.getResponseText=ze.prototype.oa,ze.prototype.send=ze.prototype.ea,ze.prototype.setWithCredentials=ze.prototype.Ha,eE=ze}).apply(typeof ll<"u"?ll:typeof self<"u"?self:typeof window<"u"?window:{});const iy="@firebase/firestore",oy="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ct.UNAUTHENTICATED=new Ct(null),Ct.GOOGLE_CREDENTIALS=new Ct("google-credentials-uid"),Ct.FIRST_PARTY=new Ct("first-party-uid"),Ct.MOCK_USER=new Ct("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pi="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs=new Gf("@firebase/firestore");function Ws(){return xs.logLevel}function J(t,...e){if(xs.logLevel<=ve.DEBUG){const n=e.map(Qf);xs.debug(`Firestore (${Pi}): ${t}`,...n)}}function ir(t,...e){if(xs.logLevel<=ve.ERROR){const n=e.map(Qf);xs.error(`Firestore (${Pi}): ${t}`,...n)}}function zr(t,...e){if(xs.logLevel<=ve.WARN){const n=e.map(Qf);xs.warn(`Firestore (${Pi}): ${t}`,...n)}}function Qf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ie(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,iE(t,r,n)}function iE(t,e,n){let r=`FIRESTORE (${Pi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw ir(r),new Error(r)}function Ee(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||iE(e,s,r)}function ue(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W extends Zr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class PR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ct.UNAUTHENTICATED))}shutdown(){}}class NR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class DR{constructor(e){this.t=e,this.currentUser=Ct.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ee(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new On;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new On,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{J("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(J("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new On)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(J("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ee(typeof r.accessToken=="string",31837,{l:r}),new oE(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ee(e===null||typeof e=="string",2055,{h:e}),new Ct(e)}}class VR{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Ct.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class MR{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new VR(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Ct.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ay{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class OR{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,yR(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ee(this.o===void 0,3512);const r=i=>{i.error!=null&&J("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,J("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{J("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):J("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ay(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ee(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new ay(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LR(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aE(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=LR(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function he(t,e){return t<e?-1:t>e?1:0}function ph(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return he(r,s);{const i=aE(),o=jR(i.encode(ly(t,n)),i.encode(ly(e,n)));return o!==0?o:he(r,s)}}n+=r>65535?2:1}return he(t.length,e.length)}function ly(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function jR(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return he(t[n],e[n]);return he(t.length,e.length)}function Si(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy="__name__";class Pn{constructor(e,n,r){n===void 0?n=0:n>e.length&&ie(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ie(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Pn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Pn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Pn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return he(e.length,n.length)}static compareSegments(e,n){const r=Pn.isNumericId(e),s=Pn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Pn.extractNumericId(e).compare(Pn.extractNumericId(n)):ph(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Mr.fromString(e.substring(4,e.length-2))}}class xe extends Pn{construct(e,n,r){return new xe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new W(j.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new xe(n)}static emptyPath(){return new xe([])}}const FR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dt extends Pn{construct(e,n,r){return new dt(e,n,r)}static isValidIdentifier(e){return FR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===uy}static keyField(){return new dt([uy])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new W(j.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new W(j.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new W(j.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new W(j.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dt(n)}static emptyPath(){return new dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.path=e}static fromPath(e){return new se(xe.fromString(e))}static fromName(e){return new se(xe.fromString(e).popFirst(5))}static empty(){return new se(xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return xe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new se(new xe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lE(t,e,n){if(!n)throw new W(j.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function BR(t,e,n,r){if(e===!0&&r===!0)throw new W(j.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function cy(t){if(!se.isDocumentKey(t))throw new W(j.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function dy(t){if(se.isDocumentKey(t))throw new W(j.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function uE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Wu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ie(12329,{type:typeof t})}function Mt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new W(j.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Wu(t);throw new W(j.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function UR(t,e){if(e<=0)throw new W(j.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(t,e){const n={typeString:t};return e&&(n.value=e),n}function _a(t,e){if(!uE(t))throw new W(j.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new W(j.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hy=-62135596800,fy=1e6;class Se{static now(){return Se.fromMillis(Date.now())}static fromDate(e){return Se.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*fy);return new Se(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new W(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new W(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<hy)throw new W(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/fy}_compareTo(e){return this.seconds===e.seconds?he(this.nanoseconds,e.nanoseconds):he(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Se._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(_a(e,Se._jsonSchema))return new Se(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-hy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Se._jsonSchemaVersion="firestore/timestamp/1.0",Se._jsonSchema={type:Ze("string",Se._jsonSchemaVersion),seconds:Ze("number"),nanoseconds:Ze("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{static fromTimestamp(e){return new ae(e)}static min(){return new ae(new Se(0,0))}static max(){return new ae(new Se(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na=-1;function $R(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ae.fromTimestamp(r===1e9?new Se(n+1,0):new Se(n,r));return new qr(s,se.empty(),e)}function zR(t){return new qr(t.readTime,t.key,na)}class qr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new qr(ae.min(),se.empty(),na)}static max(){return new qr(ae.max(),se.empty(),na)}}function qR(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=se.comparator(t.documentKey,e.documentKey),n!==0?n:he(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class HR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ni(t){if(t.code!==j.FAILED_PRECONDITION||t.message!==WR)throw t;J("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ie(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):F.reject(n)}static resolve(e){return new F((n,r)=>{n(e)})}static reject(e){return new F((n,r)=>{r(e)})}static waitFor(e){return new F((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=F.resolve(!1);for(const r of e)n=n.next(s=>s?F.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new F((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const c=u;n(e[c]).next(d=>{o[c]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new F((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function GR(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Di(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Hu.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jf=-1;function va(t){return t==null}function cu(t){return t===0&&1/t==-1/0}function KR(t){return typeof t=="number"&&Number.isInteger(t)&&!cu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cE="";function QR(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=py(e)),e=YR(t.get(n),e);return py(e)}function YR(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case cE:n+="";break;default:n+=i}}return n}function py(t){return t+cE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function es(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function dE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,n){this.comparator=e,this.root=n||ct.EMPTY}insert(e,n){return new Ue(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ct.BLACK,null,null))}remove(e){return new Ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ct.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ul(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ul(this.root,e,this.comparator,!1)}getReverseIterator(){return new ul(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ul(this.root,e,this.comparator,!0)}}class ul{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ct{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ct.RED,this.left=s??ct.EMPTY,this.right=i??ct.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ct(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ct.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ct.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ct.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ct.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ie(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ie(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ie(27949);return e+(this.isRed()?0:1)}}ct.EMPTY=null,ct.RED=!0,ct.BLACK=!1;ct.EMPTY=new class{constructor(){this.size=0}get key(){throw ie(57766)}get value(){throw ie(16141)}get color(){throw ie(16727)}get left(){throw ie(29726)}get right(){throw ie(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new ct(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e){this.comparator=e,this.data=new Ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new gy(this.data.getIterator())}getIteratorFrom(e){return new gy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof nt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new nt(this.comparator);return n.data=e,n}}class gy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.fields=e,e.sort(dt.comparator)}static empty(){return new nn([])}unionWith(e){let n=new nt(dt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new nn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Si(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new hE("Invalid base64 string: "+i):i}}(e);return new mt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new mt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return he(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mt.EMPTY_BYTE_STRING=new mt("");const JR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wr(t){if(Ee(!!t,39018),typeof t=="string"){let e=0;const n=JR.exec(t);if(Ee(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:He(t.seconds),nanos:He(t.nanos)}}function He(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Hr(t){return typeof t=="string"?mt.fromBase64String(t):mt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fE="server_timestamp",pE="__type__",mE="__previous_value__",gE="__local_write_time__";function Xf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[pE])===null||n===void 0?void 0:n.stringValue)===fE}function Gu(t){const e=t.mapValue.fields[mE];return Xf(e)?Gu(e):e}function ra(t){const e=Wr(t.mapValue.fields[gE].timestampValue);return new Se(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e,n,r,s,i,o,l,u,c,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=c,this.isUsingEmulator=d}}const du="(default)";class sa{constructor(e,n){this.projectId=e,this.database=n||du}static empty(){return new sa("","")}get isDefaultDatabase(){return this.database===du}isEqual(e){return e instanceof sa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yE="__type__",ZR="__max__",cl={mapValue:{}},_E="__vector__",hu="value";function Gr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Xf(t)?4:tx(t)?9007199254740991:ex(t)?10:11:ie(28295,{value:t})}function Bn(t,e){if(t===e)return!0;const n=Gr(t);if(n!==Gr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ra(t).isEqual(ra(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Wr(s.timestampValue),l=Wr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Hr(s.bytesValue).isEqual(Hr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return He(s.geoPointValue.latitude)===He(i.geoPointValue.latitude)&&He(s.geoPointValue.longitude)===He(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return He(s.integerValue)===He(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=He(s.doubleValue),l=He(i.doubleValue);return o===l?cu(o)===cu(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Si(t.arrayValue.values||[],e.arrayValue.values||[],Bn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(my(o)!==my(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Bn(o[u],l[u])))return!1;return!0}(t,e);default:return ie(52216,{left:t})}}function ia(t,e){return(t.values||[]).find(n=>Bn(n,e))!==void 0}function Ci(t,e){if(t===e)return 0;const n=Gr(t),r=Gr(e);if(n!==r)return he(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return he(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=He(i.integerValue||i.doubleValue),u=He(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return yy(t.timestampValue,e.timestampValue);case 4:return yy(ra(t),ra(e));case 5:return ph(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Hr(i),u=Hr(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let c=0;c<l.length&&c<u.length;c++){const d=he(l[c],u[c]);if(d!==0)return d}return he(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=he(He(i.latitude),He(o.latitude));return l!==0?l:he(He(i.longitude),He(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return _y(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,u,c,d;const p=i.fields||{},m=o.fields||{},v=(l=p[hu])===null||l===void 0?void 0:l.arrayValue,R=(u=m[hu])===null||u===void 0?void 0:u.arrayValue,b=he(((c=v==null?void 0:v.values)===null||c===void 0?void 0:c.length)||0,((d=R==null?void 0:R.values)===null||d===void 0?void 0:d.length)||0);return b!==0?b:_y(v,R)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===cl.mapValue&&o===cl.mapValue)return 0;if(i===cl.mapValue)return 1;if(o===cl.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),c=o.fields||{},d=Object.keys(c);u.sort(),d.sort();for(let p=0;p<u.length&&p<d.length;++p){const m=ph(u[p],d[p]);if(m!==0)return m;const v=Ci(l[u[p]],c[d[p]]);if(v!==0)return v}return he(u.length,d.length)}(t.mapValue,e.mapValue);default:throw ie(23264,{le:n})}}function yy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return he(t,e);const n=Wr(t),r=Wr(e),s=he(n.seconds,r.seconds);return s!==0?s:he(n.nanos,r.nanos)}function _y(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ci(n[s],r[s]);if(i)return i}return he(n.length,r.length)}function Ii(t){return mh(t)}function mh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Wr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Hr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return se.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=mh(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${mh(n.fields[o])}`;return s+"}"}(t.mapValue):ie(61005,{value:t})}function xl(t){switch(Gr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Gu(t);return e?16+xl(e):16;case 5:return 2*t.stringValue.length;case 6:return Hr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+xl(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return es(r.fields,(i,o)=>{s+=i.length+xl(o)}),s}(t.mapValue);default:throw ie(13486,{value:t})}}function vy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function gh(t){return!!t&&"integerValue"in t}function Zf(t){return!!t&&"arrayValue"in t}function Ey(t){return!!t&&"nullValue"in t}function Ty(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function kl(t){return!!t&&"mapValue"in t}function ex(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[yE])===null||n===void 0?void 0:n.stringValue)===_E}function Ao(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return es(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ao(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ao(t.arrayValue.values[n]);return e}return Object.assign({},t)}function tx(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===ZR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.value=e}static empty(){return new Dt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!kl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ao(n)}setAll(e){let n=dt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Ao(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());kl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Bn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];kl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){es(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Dt(Ao(this.value))}}function vE(t){const e=[];return es(t.fields,(n,r)=>{const s=new dt([n]);if(kl(r)){const i=vE(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new nn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new ot(e,0,ae.min(),ae.min(),ae.min(),Dt.empty(),0)}static newFoundDocument(e,n,r,s){return new ot(e,1,n,ae.min(),r,s,0)}static newNoDocument(e,n){return new ot(e,2,n,ae.min(),ae.min(),Dt.empty(),0)}static newUnknownDocument(e,n){return new ot(e,3,n,ae.min(),ae.min(),Dt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ot&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ot(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(e,n){this.position=e,this.inclusive=n}}function wy(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=se.comparator(se.fromName(o.referenceValue),n.key):r=Ci(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Sy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Bn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e,n="asc"){this.field=e,this.dir=n}}function nx(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{}class Xe extends EE{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new sx(e,n,r):n==="array-contains"?new ax(e,r):n==="in"?new lx(e,r):n==="not-in"?new ux(e,r):n==="array-contains-any"?new cx(e,r):new Xe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new ix(e,r):new ox(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ci(n,this.value)):n!==null&&Gr(this.value)===Gr(n)&&this.matchesComparison(Ci(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ie(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class In extends EE{constructor(e,n){super(),this.filters=e,this.op=n,this.he=null}static create(e,n){return new In(e,n)}matches(e){return TE(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function TE(t){return t.op==="and"}function wE(t){return rx(t)&&TE(t)}function rx(t){for(const e of t.filters)if(e instanceof In)return!1;return!0}function yh(t){if(t instanceof Xe)return t.field.canonicalString()+t.op.toString()+Ii(t.value);if(wE(t))return t.filters.map(e=>yh(e)).join(",");{const e=t.filters.map(n=>yh(n)).join(",");return`${t.op}(${e})`}}function SE(t,e){return t instanceof Xe?function(r,s){return s instanceof Xe&&r.op===s.op&&r.field.isEqual(s.field)&&Bn(r.value,s.value)}(t,e):t instanceof In?function(r,s){return s instanceof In&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&SE(o,s.filters[l]),!0):!1}(t,e):void ie(19439)}function CE(t){return t instanceof Xe?function(n){return`${n.field.canonicalString()} ${n.op} ${Ii(n.value)}`}(t):t instanceof In?function(n){return n.op.toString()+" {"+n.getFilters().map(CE).join(" ,")+"}"}(t):"Filter"}class sx extends Xe{constructor(e,n,r){super(e,n,r),this.key=se.fromName(r.referenceValue)}matches(e){const n=se.comparator(e.key,this.key);return this.matchesComparison(n)}}class ix extends Xe{constructor(e,n){super(e,"in",n),this.keys=IE("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class ox extends Xe{constructor(e,n){super(e,"not-in",n),this.keys=IE("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function IE(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>se.fromName(r.referenceValue))}class ax extends Xe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Zf(n)&&ia(n.arrayValue,this.value)}}class lx extends Xe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ia(this.value.arrayValue,n)}}class ux extends Xe{constructor(e,n){super(e,"not-in",n)}matches(e){if(ia(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ia(this.value.arrayValue,n)}}class cx extends Xe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Zf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ia(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Pe=null}}function Cy(t,e=null,n=[],r=[],s=null,i=null,o=null){return new dx(t,e,n,r,s,i,o)}function ep(t){const e=ue(t);if(e.Pe===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>yh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),va(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ii(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ii(r)).join(",")),e.Pe=n}return e.Pe}function tp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!nx(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!SE(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Sy(t.startAt,e.startAt)&&Sy(t.endAt,e.endAt)}function _h(t){return se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function hx(t,e,n,r,s,i,o,l){return new Vi(t,e,n,r,s,i,o,l)}function Ku(t){return new Vi(t)}function Iy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function RE(t){return t.collectionGroup!==null}function bo(t){const e=ue(t);if(e.Te===null){e.Te=[];const n=new Set;for(const i of e.explicitOrderBy)e.Te.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new nt(dt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(l=l.add(c.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Te.push(new oa(i,r))}),n.has(dt.keyField().canonicalString())||e.Te.push(new oa(dt.keyField(),r))}return e.Te}function Ln(t){const e=ue(t);return e.Ie||(e.Ie=fx(e,bo(t))),e.Ie}function fx(t,e){if(t.limitType==="F")return Cy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new oa(s.field,i)});const n=t.endAt?new fu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new fu(t.startAt.position,t.startAt.inclusive):null;return Cy(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function vh(t,e){const n=t.filters.concat([e]);return new Vi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function pu(t,e,n){return new Vi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Qu(t,e){return tp(Ln(t),Ln(e))&&t.limitType===e.limitType}function xE(t){return`${ep(Ln(t))}|lt:${t.limitType}`}function Hs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>CE(s)).join(", ")}]`),va(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ii(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ii(s)).join(",")),`Target(${r})`}(Ln(t))}; limitType=${t.limitType})`}function Yu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):se.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of bo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const c=wy(o,l,u);return o.inclusive?c<=0:c<0}(r.startAt,bo(r),s)||r.endAt&&!function(o,l,u){const c=wy(o,l,u);return o.inclusive?c>=0:c>0}(r.endAt,bo(r),s))}(t,e)}function px(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function kE(t){return(e,n)=>{let r=!1;for(const s of bo(t)){const i=mx(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function mx(t,e,n){const r=t.field.isKeyField()?se.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),c=l.data.field(i);return u!==null&&c!==null?Ci(u,c):ie(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ie(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){es(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return dE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gx=new Ue(se.comparator);function or(){return gx}const AE=new Ue(se.comparator);function po(...t){let e=AE;for(const n of t)e=e.insert(n.key,n);return e}function bE(t){let e=AE;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function gs(){return Po()}function PE(){return Po()}function Po(){return new Ds(t=>t.toString(),(t,e)=>t.isEqual(e))}const yx=new Ue(se.comparator),_x=new nt(se.comparator);function ye(...t){let e=_x;for(const n of t)e=e.add(n);return e}const vx=new nt(he);function Ex(){return vx}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function np(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cu(e)?"-0":e}}function NE(t){return{integerValue:""+t}}function DE(t,e){return KR(e)?NE(e):np(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(){this._=void 0}}function Tx(t,e,n){return t instanceof aa?function(s,i){const o={fields:{[pE]:{stringValue:fE},[gE]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Xf(i)&&(i=Gu(i)),i&&(o.fields[mE]=i),{mapValue:o}}(n,e):t instanceof la?ME(t,e):t instanceof ua?OE(t,e):function(s,i){const o=VE(s,i),l=Ry(o)+Ry(s.Ee);return gh(o)&&gh(s.Ee)?NE(l):np(s.serializer,l)}(t,e)}function wx(t,e,n){return t instanceof la?ME(t,e):t instanceof ua?OE(t,e):n}function VE(t,e){return t instanceof ca?function(r){return gh(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class aa extends Ju{}class la extends Ju{constructor(e){super(),this.elements=e}}function ME(t,e){const n=LE(e);for(const r of t.elements)n.some(s=>Bn(s,r))||n.push(r);return{arrayValue:{values:n}}}class ua extends Ju{constructor(e){super(),this.elements=e}}function OE(t,e){let n=LE(e);for(const r of t.elements)n=n.filter(s=>!Bn(s,r));return{arrayValue:{values:n}}}class ca extends Ju{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function Ry(t){return He(t.integerValue||t.doubleValue)}function LE(t){return Zf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e,n){this.field=e,this.transform=n}}function Sx(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof la&&s instanceof la||r instanceof ua&&s instanceof ua?Si(r.elements,s.elements,Bn):r instanceof ca&&s instanceof ca?Bn(r.Ee,s.Ee):r instanceof aa&&s instanceof aa}(t.transform,e.transform)}class Cx{constructor(e,n){this.version=e,this.transformResults=n}}class ht{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ht}static exists(e){return new ht(void 0,e)}static updateTime(e){return new ht(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Al(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Xu{}function FE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Zu(t.key,ht.none()):new Ea(t.key,t.data,ht.none());{const n=t.data,r=Dt.empty();let s=new nt(dt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ts(t.key,r,new nn(s.toArray()),ht.none())}}function Ix(t,e,n){t instanceof Ea?function(s,i,o){const l=s.value.clone(),u=ky(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ts?function(s,i,o){if(!Al(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=ky(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(BE(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function No(t,e,n,r){return t instanceof Ea?function(i,o,l,u){if(!Al(i.precondition,o))return l;const c=i.value.clone(),d=Ay(i.fieldTransforms,u,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof ts?function(i,o,l,u){if(!Al(i.precondition,o))return l;const c=Ay(i.fieldTransforms,u,o),d=o.data;return d.setAll(BE(i)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,o,l){return Al(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function Rx(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=VE(r.transform,s||null);i!=null&&(n===null&&(n=Dt.empty()),n.set(r.field,i))}return n||null}function xy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Si(r,s,(i,o)=>Sx(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ea extends Xu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ts extends Xu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function BE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function ky(t,e,n){const r=new Map;Ee(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,wx(o,l,n[s]))}return r}function Ay(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Tx(i,o,e))}return r}class Zu extends Xu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class UE extends Xu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Ix(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=No(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=No(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=PE();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=FE(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(ae.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ye())}isEqual(e){return this.batchId===e.batchId&&Si(this.mutations,e.mutations,(n,r)=>xy(n,r))&&Si(this.baseMutations,e.baseMutations,(n,r)=>xy(n,r))}}class rp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ee(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let s=function(){return yx}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new rp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kx{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe,_e;function $E(t){switch(t){case j.OK:return ie(64938);case j.CANCELLED:case j.UNKNOWN:case j.DEADLINE_EXCEEDED:case j.RESOURCE_EXHAUSTED:case j.INTERNAL:case j.UNAVAILABLE:case j.UNAUTHENTICATED:return!1;case j.INVALID_ARGUMENT:case j.NOT_FOUND:case j.ALREADY_EXISTS:case j.PERMISSION_DENIED:case j.FAILED_PRECONDITION:case j.ABORTED:case j.OUT_OF_RANGE:case j.UNIMPLEMENTED:case j.DATA_LOSS:return!0;default:return ie(15467,{code:t})}}function zE(t){if(t===void 0)return ir("GRPC error has no .code"),j.UNKNOWN;switch(t){case Qe.OK:return j.OK;case Qe.CANCELLED:return j.CANCELLED;case Qe.UNKNOWN:return j.UNKNOWN;case Qe.DEADLINE_EXCEEDED:return j.DEADLINE_EXCEEDED;case Qe.RESOURCE_EXHAUSTED:return j.RESOURCE_EXHAUSTED;case Qe.INTERNAL:return j.INTERNAL;case Qe.UNAVAILABLE:return j.UNAVAILABLE;case Qe.UNAUTHENTICATED:return j.UNAUTHENTICATED;case Qe.INVALID_ARGUMENT:return j.INVALID_ARGUMENT;case Qe.NOT_FOUND:return j.NOT_FOUND;case Qe.ALREADY_EXISTS:return j.ALREADY_EXISTS;case Qe.PERMISSION_DENIED:return j.PERMISSION_DENIED;case Qe.FAILED_PRECONDITION:return j.FAILED_PRECONDITION;case Qe.ABORTED:return j.ABORTED;case Qe.OUT_OF_RANGE:return j.OUT_OF_RANGE;case Qe.UNIMPLEMENTED:return j.UNIMPLEMENTED;case Qe.DATA_LOSS:return j.DATA_LOSS;default:return ie(39323,{code:t})}}(_e=Qe||(Qe={}))[_e.OK=0]="OK",_e[_e.CANCELLED=1]="CANCELLED",_e[_e.UNKNOWN=2]="UNKNOWN",_e[_e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_e[_e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_e[_e.NOT_FOUND=5]="NOT_FOUND",_e[_e.ALREADY_EXISTS=6]="ALREADY_EXISTS",_e[_e.PERMISSION_DENIED=7]="PERMISSION_DENIED",_e[_e.UNAUTHENTICATED=16]="UNAUTHENTICATED",_e[_e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_e[_e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_e[_e.ABORTED=10]="ABORTED",_e[_e.OUT_OF_RANGE=11]="OUT_OF_RANGE",_e[_e.UNIMPLEMENTED=12]="UNIMPLEMENTED",_e[_e.INTERNAL=13]="INTERNAL",_e[_e.UNAVAILABLE=14]="UNAVAILABLE",_e[_e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx=new Mr([4294967295,4294967295],0);function by(t){const e=aE().encode(t),n=new Z0;return n.update(e),new Uint8Array(n.digest())}function Py(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Mr([n,r],0),new Mr([s,i],0)]}class sp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new mo(`Invalid padding: ${n}`);if(r<0)throw new mo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new mo(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*e.length-n,this.ge=Mr.fromNumber(this.fe)}pe(e,n,r){let s=e.add(n.multiply(Mr.fromNumber(r)));return s.compare(bx)===1&&(s=new Mr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const n=by(e),[r,s]=Py(n);for(let i=0;i<this.hashCount;i++){const o=this.pe(r,s,i);if(!this.ye(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new sp(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.fe===0)return;const n=by(e),[r,s]=Py(n);for(let i=0;i<this.hashCount;i++){const o=this.pe(r,s,i);this.we(o)}}we(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class mo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ta.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ec(ae.min(),s,new Ue(he),or(),ye())}}class Ta{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ta(r,n,ye(),ye(),ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.be=s}}class qE{constructor(e,n){this.targetId=e,this.De=n}}class WE{constructor(e,n,r=mt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Ny{constructor(){this.ve=0,this.Ce=Dy(),this.Fe=mt.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ye(),n=ye(),r=ye();return this.Ce.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ie(38017,{changeType:i})}}),new Ta(this.Fe,this.Me,e,n,r)}ke(){this.xe=!1,this.Ce=Dy()}qe(e,n){this.xe=!0,this.Ce=this.Ce.insert(e,n)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Ee(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class Px{constructor(e){this.We=e,this.Ge=new Map,this.ze=or(),this.je=dl(),this.Je=dl(),this.He=new Ue(he)}Ye(e){for(const n of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(n,e.be):this.Xe(n,e.key,e.be);for(const n of e.removedTargetIds)this.Xe(n,e.key,e.be)}et(e){this.forEachTarget(e,n=>{const r=this.tt(n);switch(e.state){case 0:this.nt(n)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(e.resumeToken));break;default:ie(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ge.forEach((r,s)=>{this.nt(s)&&n(s)})}it(e){const n=e.targetId,r=e.De.count,s=this.st(n);if(s){const i=s.target;if(_h(i))if(r===0){const o=new se(i.path);this.Xe(n,o,ot.newNoDocument(o,ae.min()))}else Ee(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const l=this._t(e),u=l?this.ut(l,e,o):1;if(u!==0){this.rt(n);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,c)}}}}}_t(e){const n=e.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=Hr(r).toUint8Array()}catch(u){if(u instanceof hE)return zr("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new sp(o,s,i)}catch(u){return zr(u instanceof mo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.fe===0?null:l}ut(e,n,r){return n.De.count===r-this.ht(e,n.targetId)?0:2}ht(e,n){const r=this.We.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.We.lt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Xe(n,i,null),s++)}),s}Pt(e){const n=new Map;this.Ge.forEach((i,o)=>{const l=this.st(o);if(l){if(i.current&&_h(l.target)){const u=new se(l.target.path);this.Tt(u).has(o)||this.It(o,u)||this.Xe(o,u,ot.newNoDocument(u,e))}i.Ne&&(n.set(o,i.Le()),i.ke())}});let r=ye();this.Je.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const c=this.st(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ze.forEach((i,o)=>o.setReadTime(e));const s=new ec(e,n,this.He,this.ze,r);return this.ze=or(),this.je=dl(),this.Je=dl(),this.He=new Ue(he),s}Ze(e,n){if(!this.nt(e))return;const r=this.It(e,n.key)?2:0;this.tt(e).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(e)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(e))}Xe(e,n,r){if(!this.nt(e))return;const s=this.tt(e);this.It(e,n)?s.qe(n,1):s.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(e)),this.Je=this.Je.insert(n,this.dt(n).add(e)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const n=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let n=this.Ge.get(e);return n||(n=new Ny,this.Ge.set(e,n)),n}dt(e){let n=this.Je.get(e);return n||(n=new nt(he),this.Je=this.Je.insert(e,n)),n}Tt(e){let n=this.je.get(e);return n||(n=new nt(he),this.je=this.je.insert(e,n)),n}nt(e){const n=this.st(e)!==null;return n||J("WatchChangeAggregator","Detected inactive target",e),n}st(e){const n=this.Ge.get(e);return n&&n.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Ny),this.We.getRemoteKeysForTarget(e).forEach(n=>{this.Xe(e,n,null)})}It(e,n){return this.We.getRemoteKeysForTarget(e).has(n)}}function dl(){return new Ue(se.comparator)}function Dy(){return new Ue(se.comparator)}const Nx={asc:"ASCENDING",desc:"DESCENDING"},Dx={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Vx={and:"AND",or:"OR"};class Mx{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Eh(t,e){return t.useProto3Json||va(e)?e:{value:e}}function mu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function HE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Ox(t,e){return mu(t,e.toTimestamp())}function sn(t){return Ee(!!t,49232),ae.fromTimestamp(function(n){const r=Wr(n);return new Se(r.seconds,r.nanos)}(t))}function ip(t,e){return Th(t,e).canonicalString()}function Th(t,e){const n=function(s){return new xe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function GE(t){const e=xe.fromString(t);return Ee(ZE(e),10190,{key:e.toString()}),e}function gu(t,e){return ip(t.databaseId,e.path)}function Do(t,e){const n=GE(e);if(n.get(1)!==t.databaseId.projectId)throw new W(j.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new W(j.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new se(QE(n))}function KE(t,e){return ip(t.databaseId,e)}function Lx(t){const e=GE(t);return e.length===4?xe.emptyPath():QE(e)}function wh(t){return new xe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function QE(t){return Ee(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Vy(t,e,n){return{name:gu(t,e),fields:n.value.mapValue.fields}}function jx(t,e){return"found"in e?function(r,s){Ee(!!s.found,43571),s.found.name,s.found.updateTime;const i=Do(r,s.found.name),o=sn(s.found.updateTime),l=s.found.createTime?sn(s.found.createTime):ae.min(),u=new Dt({mapValue:{fields:s.found.fields}});return ot.newFoundDocument(i,o,l,u)}(t,e):"missing"in e?function(r,s){Ee(!!s.missing,3894),Ee(!!s.readTime,22933);const i=Do(r,s.missing),o=sn(s.readTime);return ot.newNoDocument(i,o)}(t,e):ie(7234,{result:e})}function Fx(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ie(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,d){return c.useProto3Json?(Ee(d===void 0||typeof d=="string",58123),mt.fromBase64String(d||"")):(Ee(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),mt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(c){const d=c.code===void 0?j.UNKNOWN:zE(c.code);return new W(d,c.message||"")}(o);n=new WE(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Do(t,r.document.name),i=sn(r.document.updateTime),o=r.document.createTime?sn(r.document.createTime):ae.min(),l=new Dt({mapValue:{fields:r.document.fields}}),u=ot.newFoundDocument(s,i,o,l),c=r.targetIds||[],d=r.removedTargetIds||[];n=new bl(c,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Do(t,r.document),i=r.readTime?sn(r.readTime):ae.min(),o=ot.newNoDocument(s,i),l=r.removedTargetIds||[];n=new bl([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Do(t,r.document),i=r.removedTargetIds||[];n=new bl([],i,s,null)}else{if(!("filter"in e))return ie(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new Ax(s,i),l=r.targetId;n=new qE(l,o)}}return n}function YE(t,e){let n;if(e instanceof Ea)n={update:Vy(t,e.key,e.value)};else if(e instanceof Zu)n={delete:gu(t,e.key)};else if(e instanceof ts)n={update:Vy(t,e.key,e.data),updateMask:Kx(e.fieldMask)};else{if(!(e instanceof UE))return ie(16599,{Rt:e.type});n={verify:gu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof aa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof la)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ua)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ca)return{fieldPath:o.field.canonicalString(),increment:l.Ee};throw ie(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Ox(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ie(27497)}(t,e.precondition)),n}function Bx(t,e){return t&&t.length>0?(Ee(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?sn(s.updateTime):sn(i);return o.isEqual(ae.min())&&(o=sn(i)),new Cx(o,s.transformResults||[])}(n,e))):[]}function Ux(t,e){return{documents:[KE(t,e.path)]}}function $x(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=KE(t,s);const i=function(c){if(c.length!==0)return XE(In.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(d=>function(m){return{field:Gs(m.field),direction:Wx(m.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Eh(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{Vt:n,parent:s}}function zx(t){let e=Lx(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ee(r===1,65062);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(p){const m=JE(p);return m instanceof In&&wE(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(R){return new oa(Ks(R.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(p){let m;return m=typeof p=="object"?p.value:p,va(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(p){const m=!!p.before,v=p.values||[];return new fu(v,m)}(n.startAt));let c=null;return n.endAt&&(c=function(p){const m=!p.before,v=p.values||[];return new fu(v,m)}(n.endAt)),hx(e,s,o,i,l,"F",u,c)}function qx(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ie(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function JE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ks(n.unaryFilter.field);return Xe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ks(n.unaryFilter.field);return Xe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ks(n.unaryFilter.field);return Xe.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ks(n.unaryFilter.field);return Xe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ie(61313);default:return ie(60726)}}(t):t.fieldFilter!==void 0?function(n){return Xe.create(Ks(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ie(58110);default:return ie(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return In.create(n.compositeFilter.filters.map(r=>JE(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ie(1026)}}(n.compositeFilter.op))}(t):ie(30097,{filter:t})}function Wx(t){return Nx[t]}function Hx(t){return Dx[t]}function Gx(t){return Vx[t]}function Gs(t){return{fieldPath:t.canonicalString()}}function Ks(t){return dt.fromServerFormat(t.fieldPath)}function XE(t){return t instanceof Xe?function(n){if(n.op==="=="){if(Ty(n.value))return{unaryFilter:{field:Gs(n.field),op:"IS_NAN"}};if(Ey(n.value))return{unaryFilter:{field:Gs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Ty(n.value))return{unaryFilter:{field:Gs(n.field),op:"IS_NOT_NAN"}};if(Ey(n.value))return{unaryFilter:{field:Gs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Gs(n.field),op:Hx(n.op),value:n.value}}}(t):t instanceof In?function(n){const r=n.getFilters().map(s=>XE(s));return r.length===1?r[0]:{compositeFilter:{op:Gx(n.op),filters:r}}}(t):ie(54877,{filter:t})}function Kx(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function ZE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,n,r,s,i=ae.min(),o=ae.min(),l=mt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Sr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(e){this.gt=e}}function Yx(t){const e=zx({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?pu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{constructor(){this.Dn=new Xx}addToCollectionParentIndex(e,n){return this.Dn.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this.Dn.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve(qr.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve(qr.min())}updateCollectionGroup(e,n,r){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class Xx{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new nt(xe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new nt(xe.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},eT=41943040;class Ut{static withCacheSize(e){return new Ut(e,Ut.DEFAULT_COLLECTION_PERCENTILE,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ut.DEFAULT_COLLECTION_PERCENTILE=10,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ut.DEFAULT=new Ut(eT,Ut.DEFAULT_COLLECTION_PERCENTILE,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ut.DISABLED=new Ut(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Ri(0)}static ur(){return new Ri(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oy="LruGarbageCollector",Zx=1048576;function Ly([t,e],[n,r]){const s=he(t,n);return s===0?he(e,r):s}class ek{constructor(e){this.Tr=e,this.buffer=new nt(Ly),this.Ir=0}dr(){return++this.Ir}Er(e){const n=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Ly(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class tk{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){J(Oy,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Di(n)?J(Oy,"Ignoring IndexedDB error during garbage collection: ",n):await Ni(n)}await this.Rr(3e5)})}}class nk{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.mr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return F.resolve(Hu.ue);const r=new ek(n);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.gr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(J("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(My)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(J("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),My):this.pr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,n){let r,s,i,o,l,u,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(J("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,o=Date.now(),this.nthSequenceNumber(e,s))).next(p=>(r=p,l=Date.now(),this.removeTargets(e,r,n))).next(p=>(i=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(c=Date.now(),Ws()<=ve.DEBUG&&J("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(c-u)+`ms
Total Duration: ${c-d}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:p})))}}function rk(t,e){return new nk(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(){this.changes=new Ds(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ot.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&No(r.mutation,s,nn.empty(),Se.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ye()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ye()){const s=gs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=po();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=gs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ye()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=or();const o=Po(),l=function(){return Po()}();return n.forEach((u,c)=>{const d=r.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof ts)?i=i.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),No(d.mutation,c,d.mutation.getFieldMask(),Se.now())):o.set(c.key,nn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var p;return l.set(c,new ik(d,(p=o.get(c))!==null&&p!==void 0?p:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Po();let s=new Ue((o,l)=>o-l),i=ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const c=n.get(u);if(c===null)return;let d=r.get(u)||nn.empty();d=l.applyToLocalView(c,d),r.set(u,d);const p=(s.get(l.batchId)||ye()).add(u);s=s.insert(l.batchId,p)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),c=u.key,d=u.value,p=PE();d.forEach(m=>{if(!i.has(m)){const v=FE(n.get(m),r.get(m));v!==null&&p.set(m,v),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,p))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):RE(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):F.resolve(gs());let l=na,u=i;return o.next(c=>F.forEach(c,(d,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),i.get(d)?F.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{u=u.insert(d,m)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,u,c,ye())).next(d=>({batchId:l,changes:bE(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new se(n)).next(r=>{let s=po();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=po();return this.indexManager.getCollectionParents(e,i).next(l=>F.forEach(l,u=>{const c=function(p,m){return new Vi(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(d=>{d.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,ot.newInvalidDocument(d)))});let l=po();return o.forEach((u,c)=>{const d=i.get(u);d!==void 0&&No(d.mutation,c,nn.empty(),Se.now()),Yu(n,c)&&(l=l.insert(u,c))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,n){return F.resolve(this.Br.get(n))}saveBundleMetadata(e,n){return this.Br.set(n.id,function(s){return{id:s.id,version:s.version,createTime:sn(s.createTime)}}(n)),F.resolve()}getNamedQuery(e,n){return F.resolve(this.Lr.get(n))}saveNamedQuery(e,n){return this.Lr.set(n.name,function(s){return{name:s.name,query:Yx(s.bundledQuery),readTime:sn(s.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(){this.overlays=new Ue(se.comparator),this.kr=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const r=gs();return F.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.wt(e,n,i)}),F.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.kr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.kr.delete(r)),F.resolve()}getOverlaysForCollection(e,n,r){const s=gs(),i=n.length+1,o=new se(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return F.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ue((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=i.get(c.largestBatchId);d===null&&(d=gs(),i=i.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const l=gs(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,d)=>l.set(c,d)),!(l.size()>=s)););return F.resolve(l)}wt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.kr.get(s.largestBatchId).delete(r.key);this.kr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new kx(n,r));let i=this.kr.get(n);i===void 0&&(i=ye(),this.kr.set(n,i)),this.kr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(){this.sessionToken=mt.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(){this.qr=new nt(st.Qr),this.$r=new nt(st.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,n){const r=new st(e,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new st(e,n))}Gr(e,n){e.forEach(r=>this.removeReference(r,n))}zr(e){const n=new se(new xe([])),r=new st(n,e),s=new st(n,e+1),i=[];return this.$r.forEachInRange([r,s],o=>{this.Wr(o),i.push(o.key)}),i}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const n=new se(new xe([])),r=new st(n,e),s=new st(n,e+1);let i=ye();return this.$r.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new st(e,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class st{constructor(e,n){this.key=e,this.Hr=n}static Qr(e,n){return se.comparator(e.key,n.key)||he(e.Hr,n.Hr)}static Ur(e,n){return he(e.Hr,n.Hr)||se.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new nt(st.Qr)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new xx(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Yr=this.Yr.add(new st(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,n){return F.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return F.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?Jf:this.er-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new st(n,0),s=new st(n,Number.POSITIVE_INFINITY),i=[];return this.Yr.forEachInRange([r,s],o=>{const l=this.Zr(o.Hr);i.push(l)}),F.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new nt(he);return n.forEach(s=>{const i=new st(s,0),o=new st(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([i,o],l=>{r=r.add(l.Hr)})}),F.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;se.isDocumentKey(i)||(i=i.child(""));const o=new st(new se(i),0);let l=new nt(he);return this.Yr.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(l=l.add(u.Hr)),!0)},o),F.resolve(this.ei(l))}ei(e){const n=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Ee(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return F.forEach(n.mutations,s=>{const i=new st(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,n){const r=new st(n,0),s=this.Yr.firstAfterOrEqual(r);return F.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ti(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e){this.ni=e,this.docs=function(){return new Ue(se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():ot.newInvalidDocument(n))}getEntries(e,n){let r=or();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():ot.newInvalidDocument(s))}),F.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=or();const o=n.path,l=new se(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:c,value:{document:d}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||qR(zR(d),r)<=0||(s.has(d.key)||Yu(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return F.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ie(9500)}ri(e,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new hk(this)}getSize(e){return F.resolve(this.size)}}class hk extends sk{constructor(e){super(),this.Or=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Or.addEntry(e,s)):this.Or.removeEntry(r)}),F.waitFor(n)}getFromCache(e,n){return this.Or.getEntry(e,n)}getAllFromCache(e,n){return this.Or.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e){this.persistence=e,this.ii=new Ds(n=>ep(n),tp),this.lastRemoteSnapshotVersion=ae.min(),this.highestTargetId=0,this.si=0,this.oi=new op,this.targetCount=0,this._i=Ri.ar()}forEachTarget(e,n){return this.ii.forEach((r,s)=>n(s)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),F.resolve()}hr(e){this.ii.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this._i=new Ri(n),this.highestTargetId=n),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,n){return this.hr(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.hr(n),F.resolve()}removeTargetData(e,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ii.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.ii.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),F.waitFor(i).next(()=>s)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const r=this.ii.get(n)||null;return F.resolve(r)}addMatchingKeys(e,n,r){return this.oi.Kr(n,r),F.resolve()}removeMatchingKeys(e,n,r){this.oi.Gr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),F.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.oi.zr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const r=this.oi.Jr(n);return F.resolve(r)}containsKey(e,n){return F.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e,n){this.ai={},this.overlays={},this.ui=new Hu(0),this.ci=!1,this.ci=!0,this.li=new uk,this.referenceDelegate=e(this),this.hi=new fk(this),this.indexManager=new Jx,this.remoteDocumentCache=function(s){return new dk(s)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new Qx(n),this.Ti=new ak(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new lk,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ai[e.toKey()];return r||(r=new ck(n,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,n,r){J("MemoryPersistence","Starting transaction:",e);const s=new pk(this.ui.next());return this.referenceDelegate.Ii(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,n){return F.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,n)))}}class pk extends HR{constructor(e){super(),this.currentSequenceNumber=e}}class ap{constructor(e){this.persistence=e,this.Ai=new op,this.Ri=null}static Vi(e){return new ap(e)}get mi(){if(this.Ri)return this.Ri;throw ie(60996)}addReference(e,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),F.resolve()}removeReference(e,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.mi.add(n.toString()),F.resolve()}removeTarget(e,n){this.Ai.zr(n.targetId).forEach(s=>this.mi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.mi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ii(){this.Ri=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.mi,r=>{const s=se.fromPath(r);return this.fi(e,s).next(i=>{i||n.removeEntry(s,ae.min())})}).next(()=>(this.Ri=null,n.apply(e)))}updateLimboDocument(e,n){return this.fi(e,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(e){return 0}fi(e,n){return F.or([()=>F.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class yu{constructor(e,n){this.persistence=e,this.gi=new Ds(r=>QR(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=rk(this,n)}static Vi(e,n){return new yu(e,n)}Ii(){}di(e){return F.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}mr(e){const n=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}yr(e){let n=0;return this.gr(e,r=>{n++}).next(()=>n)}gr(e,n){return F.forEach(this.gi,(r,s)=>this.Sr(e,r,s).next(i=>i?F.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ri(e,o=>this.Sr(e,o,n).next(l=>{l||(r++,i.removeEntry(o,ae.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.gi.set(n,e.currentSequenceNumber),F.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),F.resolve()}removeReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,n){return this.gi.set(n,e.currentSequenceNumber),F.resolve()}Pi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=xl(e.data.value)),n}Sr(e,n,r){return F.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.gi.get(n);return F.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Is=r,this.ds=s}static Es(e,n){let r=ye(),s=ye();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new lp(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return pI()?8:GR(hI())>0?6:4}()}initialize(e,n){this.gs=e,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ps(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ys(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new mk;return this.ws(e,n,o).next(l=>{if(i.result=l,this.Rs)return this.Ss(e,n,o,l.size)})}).next(()=>i.result)}Ss(e,n,r,s){return r.documentReadCount<this.Vs?(Ws()<=ve.DEBUG&&J("QueryEngine","SDK will not create cache indexes for query:",Hs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),F.resolve()):(Ws()<=ve.DEBUG&&J("QueryEngine","Query:",Hs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.fs*s?(Ws()<=ve.DEBUG&&J("QueryEngine","The SDK decides to create cache indexes for query:",Hs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ln(n))):F.resolve())}ps(e,n){if(Iy(n))return F.resolve(null);let r=Ln(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=pu(n,null,"F"),r=Ln(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ye(...i);return this.gs.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.bs(n,l);return this.Ds(n,c,o,u.readTime)?this.ps(e,pu(n,null,"F")):this.vs(e,c,n,u)}))})))}ys(e,n,r,s){return Iy(n)||s.isEqual(ae.min())?F.resolve(null):this.gs.getDocuments(e,r).next(i=>{const o=this.bs(n,i);return this.Ds(n,o,r,s)?F.resolve(null):(Ws()<=ve.DEBUG&&J("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Hs(n)),this.vs(e,o,n,$R(s,na)).next(l=>l))})}bs(e,n){let r=new nt(kE(e));return n.forEach((s,i)=>{Yu(e,i)&&(r=r.add(i))}),r}Ds(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ws(e,n,r){return Ws()<=ve.DEBUG&&J("QueryEngine","Using full collection scan to execute query:",Hs(n)),this.gs.getDocumentsMatchingQuery(e,n,qr.min(),r)}vs(e,n,r,s){return this.gs.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="LocalStore",yk=3e8;class _k{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.Fs=new Ue(he),this.Ms=new Ds(i=>ep(i),tp),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ok(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Fs))}}function vk(t,e,n,r){return new _k(t,e,n,r)}async function nT(t,e){const n=ue(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ns(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=ye();for(const c of s){o.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}for(const c of i){l.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}return n.localDocuments.getDocuments(r,u).next(c=>({Bs:c,removedBatchIds:o,addedBatchIds:l}))})})}function Ek(t,e){const n=ue(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Os.newChangeBuffer({trackRemovals:!0});return function(l,u,c,d){const p=c.batch,m=p.keys();let v=F.resolve();return m.forEach(R=>{v=v.next(()=>d.getEntry(u,R)).next(b=>{const V=c.docVersions.get(R);Ee(V!==null,48541),b.version.compareTo(V)<0&&(p.applyToRemoteDocument(b,c),b.isValidDocument()&&(b.setReadTime(c.commitVersion),d.addEntry(b)))})}),v.next(()=>l.mutationQueue.removeMutationBatch(u,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ye();for(let c=0;c<l.mutationResults.length;++c)l.mutationResults[c].transformResults.length>0&&(u=u.add(l.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function rT(t){const e=ue(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.hi.getLastRemoteSnapshotVersion(n))}function Tk(t,e){const n=ue(t),r=e.snapshotVersion;let s=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});s=n.Fs;const l=[];e.targetChanges.forEach((d,p)=>{const m=s.get(p);if(!m)return;l.push(n.hi.removeMatchingKeys(i,d.removedDocuments,p).next(()=>n.hi.addMatchingKeys(i,d.addedDocuments,p)));let v=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?v=v.withResumeToken(mt.EMPTY_BYTE_STRING,ae.min()).withLastLimboFreeSnapshotVersion(ae.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,r)),s=s.insert(p,v),function(b,V,w){return b.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=yk?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(m,v,d)&&l.push(n.hi.updateTargetData(i,v))});let u=or(),c=ye();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(wk(i,o,e.documentUpdates).next(d=>{u=d.Ls,c=d.ks})),!r.isEqual(ae.min())){const d=n.hi.getLastRemoteSnapshotVersion(i).next(p=>n.hi.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return F.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,c)).next(()=>u)}).then(i=>(n.Fs=s,i))}function wk(t,e,n){let r=ye(),s=ye();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=or();return n.forEach((l,u)=>{const c=i.get(l);u.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(ae.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):J(up,"Ignoring outdated watch update for ",l,". Current version:",c.version," Watch version:",u.version)}),{Ls:o,ks:s}})}function Sk(t,e){const n=ue(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Jf),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ck(t,e){const n=ue(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.hi.getTargetData(r,e).next(i=>i?(s=i,F.resolve(s)):n.hi.allocateTargetId(r).next(o=>(s=new Sr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Fs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(e,r.targetId)),r})}async function Sh(t,e,n){const r=ue(t),s=r.Fs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Di(o))throw o;J(up,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(s.target)}function jy(t,e,n){const r=ue(t);let s=ae.min(),i=ye();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,d){const p=ue(u),m=p.Ms.get(d);return m!==void 0?F.resolve(p.Fs.get(m)):p.hi.getTargetData(c,d)}(r,o,Ln(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?s:ae.min(),n?i:ye())).next(l=>(Ik(r,px(e),l),{documents:l,qs:i})))}function Ik(t,e,n){let r=t.xs.get(e)||ae.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.xs.set(e,r)}class Fy{constructor(){this.activeTargetIds=Ex()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Rk{constructor(){this.Fo=new Fy,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,n,r){this.Mo[e]=n}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Fy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xk{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const By="ConnectivityMonitor";class Uy{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){J(By,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){J(By,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hl=null;function Ch(){return hl===null?hl=function(){return 268435456+Math.round(2147483648*Math.random())}():hl++,"0x"+hl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ad="RestConnection",kk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ak{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.Ko=this.databaseId.database===du?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const o=Ch(),l=this.Go(e,n.toUriEncodedString());J(ad,`Sending RPC '${e}' ${o}:`,l,r);const u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(u,s,i);const{host:c}=new URL(l),d=qf(c);return this.jo(e,l,u,r,d).then(p=>(J(ad,`Received RPC '${e}' ${o}: `,p),p),p=>{throw zr(ad,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",r),p})}Jo(e,n,r,s,i,o){return this.Wo(e,n,r,s,i)}zo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Pi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Go(e,n){const r=kk[e];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const St="WebChannelConnection";class Pk extends Ak{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,n,r,s,i){const o=Ch();return new Promise((l,u)=>{const c=new eE;c.setWithCredentials(!0),c.listenOnce(tE.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Rl.NO_ERROR:const p=c.getResponseJson();J(St,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case Rl.TIMEOUT:J(St,`RPC '${e}' ${o} timed out`),u(new W(j.DEADLINE_EXCEEDED,"Request time out"));break;case Rl.HTTP_ERROR:const m=c.getStatus();if(J(St,`RPC '${e}' ${o} failed with status:`,m,"response text:",c.getResponseText()),m>0){let v=c.getResponseJson();Array.isArray(v)&&(v=v[0]);const R=v==null?void 0:v.error;if(R&&R.status&&R.message){const b=function(w){const E=w.toLowerCase().replace(/_/g,"-");return Object.values(j).indexOf(E)>=0?E:j.UNKNOWN}(R.status);u(new W(b,R.message))}else u(new W(j.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new W(j.UNAVAILABLE,"Connection failed."));break;default:ie(9055,{c_:e,streamId:o,l_:c.getLastErrorCode(),h_:c.getLastError()})}}finally{J(St,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);J(St,`RPC '${e}' ${o} sending request:`,s),c.send(n,"POST",d,r,15)})}P_(e,n,r){const s=Ch(),i=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=sE(),l=rE(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.zo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const d=i.join("");J(St,`Creating RPC '${e}' stream ${s}: ${d}`,u);const p=o.createWebChannel(d,u);this.T_(p);let m=!1,v=!1;const R=new bk({Ho:V=>{v?J(St,`Not sending because RPC '${e}' stream ${s} is closed:`,V):(m||(J(St,`Opening RPC '${e}' stream ${s} transport.`),p.open(),m=!0),J(St,`RPC '${e}' stream ${s} sending:`,V),p.send(V))},Yo:()=>p.close()}),b=(V,w,E)=>{V.listen(w,x=>{try{E(x)}catch(L){setTimeout(()=>{throw L},0)}})};return b(p,fo.EventType.OPEN,()=>{v||(J(St,`RPC '${e}' stream ${s} transport opened.`),R.s_())}),b(p,fo.EventType.CLOSE,()=>{v||(v=!0,J(St,`RPC '${e}' stream ${s} transport closed`),R.__(),this.I_(p))}),b(p,fo.EventType.ERROR,V=>{v||(v=!0,zr(St,`RPC '${e}' stream ${s} transport errored. Name:`,V.name,"Message:",V.message),R.__(new W(j.UNAVAILABLE,"The operation could not be completed")))}),b(p,fo.EventType.MESSAGE,V=>{var w;if(!v){const E=V.data[0];Ee(!!E,16349);const x=E,L=(x==null?void 0:x.error)||((w=x[0])===null||w===void 0?void 0:w.error);if(L){J(St,`RPC '${e}' stream ${s} received error:`,L);const z=L.status;let B=function(C){const I=Qe[C];if(I!==void 0)return zE(I)}(z),S=L.message;B===void 0&&(B=j.INTERNAL,S="Unknown error status: "+z+" with message "+L.message),v=!0,R.__(new W(B,S)),p.close()}else J(St,`RPC '${e}' stream ${s} received:`,E),R.a_(E)}}),b(l,nE.STAT_EVENT,V=>{V.stat===fh.PROXY?J(St,`RPC '${e}' stream ${s} detected buffering proxy`):V.stat===fh.NOPROXY&&J(St,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.o_()},0),R}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(n=>n===e)}}function ld(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tc(t){return new Mx(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Fi=e,this.timerId=n,this.d_=r,this.E_=s,this.A_=i,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),s=Math.max(0,n-r);s>0&&J("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y="PersistentStream";class sT{constructor(e,n,r,s,i,o,l,u){this.Fi=e,this.w_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new cp(e,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():n&&n.code===j.RESOURCE_EXHAUSTED?(ir(n.toString()),ir("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===j.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(n)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.b_===n&&this.W_(r,s)},r=>{e(()=>{const s=new W(j.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(s)})})}W_(e,n){const r=this.K_(this.b_);this.stream=this.z_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(s=>{r(()=>this.G_(s))}),this.stream.onMessage(s=>{r(()=>++this.C_==1?this.j_(s):this.onNext(s))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return J($y,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return n=>{this.Fi.enqueueAndForget(()=>this.b_===e?n():(J($y,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Nk extends sT{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}z_(e,n){return this.connection.P_("Listen",e,n)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const n=Fx(this.serializer,e),r=function(i){if(!("targetChange"in i))return ae.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ae.min():o.readTime?sn(o.readTime):ae.min()}(e);return this.listener.J_(n,r)}H_(e){const n={};n.database=wh(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=_h(u)?{documents:Ux(i,u)}:{query:$x(i,u).Vt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=HE(i,o.resumeToken);const c=Eh(i,o.expectedCount);c!==null&&(l.expectedCount=c)}else if(o.snapshotVersion.compareTo(ae.min())>0){l.readTime=mu(i,o.snapshotVersion.toTimestamp());const c=Eh(i,o.expectedCount);c!==null&&(l.expectedCount=c)}return l}(this.serializer,e);const r=qx(this.serializer,e);r&&(n.labels=r),this.k_(n)}Y_(e){const n={};n.database=wh(this.serializer),n.removeTarget=e,this.k_(n)}}class Dk extends sT{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,n){return this.connection.P_("Write",e,n)}j_(e){return Ee(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ee(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Ee(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const n=Bx(e.writeResults,e.commitTime),r=sn(e.commitTime);return this.listener.ta(r,n)}na(){const e={};e.database=wh(this.serializer),this.k_(e)}X_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>YE(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{}class Mk extends Vk{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new W(j.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,Th(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new W(j.UNKNOWN,i.toString())})}Jo(e,n,r,s,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Jo(e,Th(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new W(j.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class Ok{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ir(n),this._a=!1):J("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks="RemoteStore";class Lk{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=i,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{Vs(this)&&(J(ks,"Restarting streams for network reachability change."),await async function(u){const c=ue(u);c.Ia.add(4),await wa(c),c.Aa.set("Unknown"),c.Ia.delete(4),await nc(c)}(this))})}),this.Aa=new Ok(r,s)}}async function nc(t){if(Vs(t))for(const e of t.da)await e(!0)}async function wa(t){for(const e of t.da)await e(!1)}function iT(t,e){const n=ue(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),pp(n)?fp(n):Mi(n).x_()&&hp(n,e))}function dp(t,e){const n=ue(t),r=Mi(n);n.Ta.delete(e),r.x_()&&oT(n,e),n.Ta.size===0&&(r.x_()?r.B_():Vs(n)&&n.Aa.set("Unknown"))}function hp(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ae.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Mi(t).H_(e)}function oT(t,e){t.Ra.$e(e),Mi(t).Y_(e)}function fp(t){t.Ra=new Px({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),Mi(t).start(),t.Aa.aa()}function pp(t){return Vs(t)&&!Mi(t).M_()&&t.Ta.size>0}function Vs(t){return ue(t).Ia.size===0}function aT(t){t.Ra=void 0}async function jk(t){t.Aa.set("Online")}async function Fk(t){t.Ta.forEach((e,n)=>{hp(t,e)})}async function Bk(t,e){aT(t),pp(t)?(t.Aa.la(e),fp(t)):t.Aa.set("Unknown")}async function Uk(t,e,n){if(t.Aa.set("Online"),e instanceof WE&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Ta.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Ta.delete(l),s.Ra.removeTarget(l))}(t,e)}catch(r){J(ks,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await _u(t,r)}else if(e instanceof bl?t.Ra.Ye(e):e instanceof qE?t.Ra.it(e):t.Ra.et(e),!n.isEqual(ae.min()))try{const r=await rT(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Ra.Pt(o);return l.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ta.get(c);d&&i.Ta.set(c,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,c)=>{const d=i.Ta.get(u);if(!d)return;i.Ta.set(u,d.withResumeToken(mt.EMPTY_BYTE_STRING,d.snapshotVersion)),oT(i,u);const p=new Sr(d.target,u,c,d.sequenceNumber);hp(i,p)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){J(ks,"Failed to raise snapshot:",r),await _u(t,r)}}async function _u(t,e,n){if(!Di(e))throw e;t.Ia.add(1),await wa(t),t.Aa.set("Offline"),n||(n=()=>rT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{J(ks,"Retrying IndexedDB access"),await n(),t.Ia.delete(1),await nc(t)})}function lT(t,e){return e().catch(n=>_u(t,n,e))}async function rc(t){const e=ue(t),n=Kr(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Jf;for(;$k(e);)try{const s=await Sk(e.localStore,r);if(s===null){e.Pa.length===0&&n.B_();break}r=s.batchId,zk(e,s)}catch(s){await _u(e,s)}uT(e)&&cT(e)}function $k(t){return Vs(t)&&t.Pa.length<10}function zk(t,e){t.Pa.push(e);const n=Kr(t);n.x_()&&n.Z_&&n.X_(e.mutations)}function uT(t){return Vs(t)&&!Kr(t).M_()&&t.Pa.length>0}function cT(t){Kr(t).start()}async function qk(t){Kr(t).na()}async function Wk(t){const e=Kr(t);for(const n of t.Pa)e.X_(n.mutations)}async function Hk(t,e,n){const r=t.Pa.shift(),s=rp.from(r,e,n);await lT(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await rc(t)}async function Gk(t,e){e&&Kr(t).Z_&&await async function(r,s){if(function(o){return $E(o)&&o!==j.ABORTED}(s.code)){const i=r.Pa.shift();Kr(r).N_(),await lT(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await rc(r)}}(t,e),uT(t)&&cT(t)}async function zy(t,e){const n=ue(t);n.asyncQueue.verifyOperationInProgress(),J(ks,"RemoteStore received new credentials");const r=Vs(n);n.Ia.add(3),await wa(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),await nc(n)}async function Kk(t,e){const n=ue(t);e?(n.Ia.delete(2),await nc(n)):e||(n.Ia.add(2),await wa(n),n.Aa.set("Unknown"))}function Mi(t){return t.Va||(t.Va=function(n,r,s){const i=ue(n);return i.ia(),new Nk(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:jk.bind(null,t),e_:Fk.bind(null,t),n_:Bk.bind(null,t),J_:Uk.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),pp(t)?fp(t):t.Aa.set("Unknown")):(await t.Va.stop(),aT(t))})),t.Va}function Kr(t){return t.ma||(t.ma=function(n,r,s){const i=ue(n);return i.ia(),new Dk(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:qk.bind(null,t),n_:Gk.bind(null,t),ea:Wk.bind(null,t),ta:Hk.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await rc(t)):(await t.ma.stop(),t.Pa.length>0&&(J(ks,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new On,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new mp(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W(j.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gp(t,e){if(ir("AsyncQueue",`${e}: ${t}`),Di(t))return new W(j.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{static emptySet(e){return new pi(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||se.comparator(n.key,r.key):(n,r)=>se.comparator(n.key,r.key),this.keyedMap=po(),this.sortedSet=new Ue(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof pi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new pi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(){this.fa=new Ue(se.comparator)}track(e){const n=e.doc.key,r=this.fa.get(n);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(n,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(n):e.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):ie(63341,{At:e,ga:r}):this.fa=this.fa.insert(n,e)}pa(){const e=[];return this.fa.inorderTraversal((n,r)=>{e.push(r)}),e}}class xi{constructor(e,n,r,s,i,o,l,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new xi(e,n,pi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class Yk{constructor(){this.queries=Wy(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const s=ue(n),i=s.queries;s.queries=Wy(),i.forEach((o,l)=>{for(const u of l.wa)u.onError(r)})})(this,new W(j.ABORTED,"Firestore shutting down"))}}function Wy(){return new Ds(t=>xE(t),Qu)}async function yp(t,e){const n=ue(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.ba()&&(r=2):(i=new Qk,r=e.ba()?0:1);try{switch(r){case 0:i.ya=await n.onListen(s,!0);break;case 1:i.ya=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=gp(o,`Initialization of query '${Hs(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.wa.push(e),e.va(n.onlineState),i.ya&&e.Ca(i.ya)&&vp(n)}async function _p(t,e){const n=ue(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.wa.indexOf(e);o>=0&&(i.wa.splice(o,1),i.wa.length===0?s=e.ba()?0:1:!i.Sa()&&e.ba()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Jk(t,e){const n=ue(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.wa)l.Ca(s)&&(r=!0);o.ya=s}}r&&vp(n)}function Xk(t,e,n){const r=ue(t),s=r.queries.get(e);if(s)for(const i of s.wa)i.onError(n);r.queries.delete(e)}function vp(t){t.Da.forEach(e=>{e.next()})}var Ih,Hy;(Hy=Ih||(Ih={})).Fa="default",Hy.Cache="cache";class Ep{constructor(e,n,r){this.query=e,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new xi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),n=!0):this.Ba(e,this.onlineState)&&(this.La(e),n=!0),this.Oa=e,n}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),n=!0),n}Ba(e,n){if(!e.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(e){e=xi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Ih.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e){this.key=e}}class hT{constructor(e){this.key=e}}class Zk{constructor(e,n){this.query=e,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ye(),this.mutatedKeys=ye(),this.Xa=kE(e),this.eu=new pi(this.Xa)}get tu(){return this.Ha}nu(e,n){const r=n?n.ru:new qy,s=n?n.eu:this.eu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,p)=>{const m=s.get(d),v=Yu(this.query,p)?p:null,R=!!m&&this.mutatedKeys.has(m.key),b=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let V=!1;m&&v?m.data.isEqual(v.data)?R!==b&&(r.track({type:3,doc:v}),V=!0):this.iu(m,v)||(r.track({type:2,doc:v}),V=!0,(u&&this.Xa(v,u)>0||c&&this.Xa(v,c)<0)&&(l=!0)):!m&&v?(r.track({type:0,doc:v}),V=!0):m&&!v&&(r.track({type:1,doc:m}),V=!0,(u||c)&&(l=!0)),V&&(v?(o=o.add(v),i=b?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{eu:o,ru:r,Ds:l,mutatedKeys:i}}iu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort((d,p)=>function(v,R){const b=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ie(20277,{At:V})}};return b(v)-b(R)}(d.type,p.type)||this.Xa(d.doc,p.doc)),this.su(r),s=s!=null&&s;const l=n&&!s?this.ou():[],u=this.Za.size===0&&this.current&&!s?1:0,c=u!==this.Ya;return this.Ya=u,o.length!==0||c?{snapshot:new xi(this.query,e.eu,i,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:l}:{_u:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new qy,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=ye(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return e.forEach(r=>{this.Za.has(r)||n.push(new hT(r))}),this.Za.forEach(r=>{e.has(r)||n.push(new dT(r))}),n}uu(e){this.Ha=e.qs,this.Za=ye();const n=this.nu(e.documents);return this.applyChanges(n,!0)}cu(){return xi.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Tp="SyncEngine";class eA{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class tA{constructor(e){this.key=e,this.lu=!1}}class nA{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new Ds(l=>xE(l),Qu),this.Tu=new Map,this.Iu=new Set,this.du=new Ue(se.comparator),this.Eu=new Map,this.Au=new op,this.Ru={},this.Vu=new Map,this.mu=Ri.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function rA(t,e,n=!0){const r=_T(t);let s;const i=r.Pu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.cu()):s=await fT(r,e,n,!0),s}async function sA(t,e){const n=_T(t);await fT(n,e,!0,!1)}async function fT(t,e,n,r){const s=await Ck(t.localStore,Ln(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await iA(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&iT(t.remoteStore,s),l}async function iA(t,e,n,r,s){t.gu=(p,m,v)=>async function(b,V,w,E){let x=V.view.nu(w);x.Ds&&(x=await jy(b.localStore,V.query,!1).then(({documents:S})=>V.view.nu(S,x)));const L=E&&E.targetChanges.get(V.targetId),z=E&&E.targetMismatches.get(V.targetId)!=null,B=V.view.applyChanges(x,b.isPrimaryClient,L,z);return Ky(b,V.targetId,B._u),B.snapshot}(t,p,m,v);const i=await jy(t.localStore,e,!0),o=new Zk(e,i.qs),l=o.nu(i.documents),u=Ta.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=o.applyChanges(l,t.isPrimaryClient,u);Ky(t,n,c._u);const d=new eA(e,n,o);return t.Pu.set(e,d),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),c.snapshot}async function oA(t,e,n){const r=ue(t),s=r.Pu.get(e),i=r.Tu.get(s.targetId);if(i.length>1)return r.Tu.set(s.targetId,i.filter(o=>!Qu(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Sh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&dp(r.remoteStore,s.targetId),Rh(r,s.targetId)}).catch(Ni)):(Rh(r,s.targetId),await Sh(r.localStore,s.targetId,!0))}async function aA(t,e){const n=ue(t),r=n.Pu.get(e),s=n.Tu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),dp(n.remoteStore,r.targetId))}async function lA(t,e,n){const r=mA(t);try{const s=await function(o,l){const u=ue(o),c=Se.now(),d=l.reduce((v,R)=>v.add(R.key),ye());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",v=>{let R=or(),b=ye();return u.Os.getEntries(v,d).next(V=>{R=V,R.forEach((w,E)=>{E.isValidDocument()||(b=b.add(w))})}).next(()=>u.localDocuments.getOverlayedDocuments(v,R)).next(V=>{p=V;const w=[];for(const E of l){const x=Rx(E,p.get(E.key).overlayedDocument);x!=null&&w.push(new ts(E.key,x,vE(x.value.mapValue),ht.exists(!0)))}return u.mutationQueue.addMutationBatch(v,c,w,l)}).next(V=>{m=V;const w=V.applyToLocalDocumentSet(p,b);return u.documentOverlayCache.saveOverlays(v,V.batchId,w)})}).then(()=>({batchId:m.batchId,changes:bE(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let c=o.Ru[o.currentUser.toKey()];c||(c=new Ue(he)),c=c.insert(l,u),o.Ru[o.currentUser.toKey()]=c}(r,s.batchId,n),await Sa(r,s.changes),await rc(r.remoteStore)}catch(s){const i=gp(s,"Failed to persist write");n.reject(i)}}async function pT(t,e){const n=ue(t);try{const r=await Tk(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Eu.get(i);o&&(Ee(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.lu=!0:s.modifiedDocuments.size>0?Ee(o.lu,14607):s.removedDocuments.size>0&&(Ee(o.lu,42227),o.lu=!1))}),await Sa(n,r,e)}catch(r){await Ni(r)}}function Gy(t,e,n){const r=ue(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Pu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=ue(o);u.onlineState=l;let c=!1;u.queries.forEach((d,p)=>{for(const m of p.wa)m.va(l)&&(c=!0)}),c&&vp(u)}(r.eventManager,e),s.length&&r.hu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function uA(t,e,n){const r=ue(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Eu.get(e),i=s&&s.key;if(i){let o=new Ue(se.comparator);o=o.insert(i,ot.newNoDocument(i,ae.min()));const l=ye().add(i),u=new ec(ae.min(),new Map,new Ue(he),o,l);await pT(r,u),r.du=r.du.remove(i),r.Eu.delete(e),wp(r)}else await Sh(r.localStore,e,!1).then(()=>Rh(r,e,n)).catch(Ni)}async function cA(t,e){const n=ue(t),r=e.batch.batchId;try{const s=await Ek(n.localStore,e);gT(n,r,null),mT(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Sa(n,s)}catch(s){await Ni(s)}}async function dA(t,e,n){const r=ue(t);try{const s=await function(o,l){const u=ue(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return u.mutationQueue.lookupMutationBatch(c,l).next(p=>(Ee(p!==null,37113),d=p.keys(),u.mutationQueue.removeMutationBatch(c,p))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>u.localDocuments.getDocuments(c,d))})}(r.localStore,e);gT(r,e,n),mT(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Sa(r,s)}catch(s){await Ni(s)}}function mT(t,e){(t.Vu.get(e)||[]).forEach(n=>{n.resolve()}),t.Vu.delete(e)}function gT(t,e,n){const r=ue(t);let s=r.Ru[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ru[r.currentUser.toKey()]=s}}function Rh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(r=>{t.Au.containsKey(r)||yT(t,r)})}function yT(t,e){t.Iu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(dp(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),wp(t))}function Ky(t,e,n){for(const r of n)r instanceof dT?(t.Au.addReference(r.key,e),hA(t,r)):r instanceof hT?(J(Tp,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||yT(t,r.key)):ie(19791,{yu:r})}function hA(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(J(Tp,"New document in limbo: "+n),t.Iu.add(r),wp(t))}function wp(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const n=new se(xe.fromString(e)),r=t.mu.next();t.Eu.set(r,new tA(n)),t.du=t.du.insert(n,r),iT(t.remoteStore,new Sr(Ln(Ku(n.path)),r,"TargetPurposeLimboResolution",Hu.ue))}}async function Sa(t,e,n){const r=ue(t),s=[],i=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((l,u)=>{o.push(r.gu(u,e,n).then(c=>{var d;if((c||n)&&r.isPrimaryClient){const p=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(c){s.push(c);const p=lp.Es(u.targetId,c);i.push(p)}}))}),await Promise.all(o),r.hu.J_(s),await async function(u,c){const d=ue(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>F.forEach(c,m=>F.forEach(m.Is,v=>d.persistence.referenceDelegate.addReference(p,m.targetId,v)).next(()=>F.forEach(m.ds,v=>d.persistence.referenceDelegate.removeReference(p,m.targetId,v)))))}catch(p){if(!Di(p))throw p;J(up,"Failed to update sequence numbers: "+p)}for(const p of c){const m=p.targetId;if(!p.fromCache){const v=d.Fs.get(m),R=v.snapshotVersion,b=v.withLastLimboFreeSnapshotVersion(R);d.Fs=d.Fs.insert(m,b)}}}(r.localStore,i))}async function fA(t,e){const n=ue(t);if(!n.currentUser.isEqual(e)){J(Tp,"User change. New user:",e.toKey());const r=await nT(n.localStore,e);n.currentUser=e,function(i,o){i.Vu.forEach(l=>{l.forEach(u=>{u.reject(new W(j.CANCELLED,o))})}),i.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Sa(n,r.Bs)}}function pA(t,e){const n=ue(t),r=n.Eu.get(e);if(r&&r.lu)return ye().add(r.key);{let s=ye();const i=n.Tu.get(e);if(!i)return s;for(const o of i){const l=n.Pu.get(o);s=s.unionWith(l.view.tu)}return s}}function _T(t){const e=ue(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=pT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=pA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=uA.bind(null,e),e.hu.J_=Jk.bind(null,e.eventManager),e.hu.pu=Xk.bind(null,e.eventManager),e}function mA(t){const e=ue(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=dA.bind(null,e),e}class vu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=tc(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,n){return null}Fu(e,n){return null}vu(e){return vk(this.persistence,new gk,e.initialUser,this.serializer)}Du(e){return new tT(ap.Vi,this.serializer)}bu(e){return new Rk}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vu.provider={build:()=>new vu};class gA extends vu{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,n){Ee(this.persistence.referenceDelegate instanceof yu,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new tk(r,e.asyncQueue,n)}Du(e){const n=this.cacheSizeBytes!==void 0?Ut.withCacheSize(this.cacheSizeBytes):Ut.DEFAULT;return new tT(r=>yu.Vi(r,n),this.serializer)}}class xh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Gy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=fA.bind(null,this.syncEngine),await Kk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Yk}()}createDatastore(e){const n=tc(e.databaseInfo.databaseId),r=function(i){return new Pk(i)}(e.databaseInfo);return function(i,o,l,u){return new Mk(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new Lk(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Gy(this.syncEngine,n,0),function(){return Uy.C()?new Uy:new xk}())}createSyncEngine(e,n){return function(s,i,o,l,u,c,d){const p=new nA(s,i,o,l,u,c);return d&&(p.fu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ue(s);J(ks,"RemoteStore shutting down."),i.Ia.add(5),await wa(i),i.Ea.shutdown(),i.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}xh.provider={build:()=>new xh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ir("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new W(j.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,i){const o=ue(s),l={documents:i.map(p=>gu(o.serializer,p))},u=await o.Jo("BatchGetDocuments",o.serializer.databaseId,xe.emptyPath(),l,i.length),c=new Map;u.forEach(p=>{const m=jx(o.serializer,p);c.set(m.key.toString(),m)});const d=[];return i.forEach(p=>{const m=c.get(p.toString());Ee(!!m,55234,{key:p}),d.push(m)}),d}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Zu(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=se.fromPath(r);this.mutations.push(new UE(s,this.precondition(s)))}),await async function(r,s){const i=ue(r),o={writes:s.map(l=>YE(i.serializer,l))};await i.Wo("Commit",i.serializer.databaseId,xe.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw ie(50498,{Wu:e.constructor.name});n=ae.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new W(j.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(ae.min())?ht.exists(!1):ht.updateTime(n):ht.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(ae.min()))throw new W(j.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ht.updateTime(n)}return ht.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this.Gu=r.maxAttempts,this.F_=new cp(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(async()=>{const e=new yA(this.datastore),n=this.Ju(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Hu(s)}))}).catch(r=>{this.Hu(r)})})}Ju(e){try{const n=this.updateFunction(e);return!va(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!$E(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr="FirestoreClient";class vA{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ct.UNAUTHENTICATED,this.clientId=Yf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{J(Qr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(J(Qr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new On;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=gp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ud(t,e){t.asyncQueue.verifyOperationInProgress(),J(Qr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await nT(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>{zr("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{J("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(s=>{zr("Terminating Firestore due to IndexedDb database deletion failed",s)})}),t._offlineComponents=e}async function Qy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await EA(t);J(Qr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>zy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>zy(e.remoteStore,s)),t._onlineComponents=e}async function EA(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){J(Qr,"Using user provided OfflineComponentProvider");try{await ud(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===j.FAILED_PRECONDITION||s.code===j.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;zr("Error using user provided cache. Falling back to memory cache: "+n),await ud(t,new vu)}}else J(Qr,"Using default OfflineComponentProvider"),await ud(t,new gA(void 0));return t._offlineComponents}async function Cp(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(J(Qr,"Using user provided OnlineComponentProvider"),await Qy(t,t._uninitializedComponentsProvider._online)):(J(Qr,"Using default OnlineComponentProvider"),await Qy(t,new xh))),t._onlineComponents}function TA(t){return Cp(t).then(e=>e.syncEngine)}function wA(t){return Cp(t).then(e=>e.datastore)}async function Eu(t){const e=await Cp(t),n=e.eventManager;return n.onListen=rA.bind(null,e.syncEngine),n.onUnlisten=oA.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=sA.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=aA.bind(null,e.syncEngine),n}function SA(t,e,n={}){const r=new On;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,c){const d=new Sp({next:m=>{d.Ou(),o.enqueueAndForget(()=>_p(i,p));const v=m.docs.has(l);!v&&m.fromCache?c.reject(new W(j.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&m.fromCache&&u&&u.source==="server"?c.reject(new W(j.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new Ep(Ku(l.path),d,{includeMetadataChanges:!0,ka:!0});return yp(i,p)}(await Eu(t),t.asyncQueue,e,n,r)),r.promise}function CA(t,e,n={}){const r=new On;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,c){const d=new Sp({next:m=>{d.Ou(),o.enqueueAndForget(()=>_p(i,p)),m.fromCache&&u.source==="server"?c.reject(new W(j.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new Ep(l,d,{includeMetadataChanges:!0,ka:!0});return yp(i,p)}(await Eu(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET="firestore.googleapis.com",Jy=!0;class Xy{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new W(j.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ET,this.ssl=Jy}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:Jy;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=eT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Zx)throw new W(j.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}BR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vT((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new W(j.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new W(j.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new W(j.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sc{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xy({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new W(j.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new W(j.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xy(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new PR;switch(r.type){case"firstParty":return new MR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new W(j.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Yy.get(n);r&&(J("ComponentProvider","Removing Datastore"),Yy.delete(n),r.terminate())}(this),Promise.resolve()}}function IA(t,e,n,r={}){var s;t=Mt(t,sc);const i=qf(e),o=t._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),u=`${e}:${n}`;i&&(aI(`https://${u}`),dI("Firestore",!0)),o.host!==ET&&o.host!==u&&zr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:u,ssl:i,emulatorOptions:r});if(!ea(c,l)&&(t._setSettings(c),r.mockUserToken)){let d,p;if(typeof r.mockUserToken=="string")d=r.mockUserToken,p=Ct.MOCK_USER;else{d=lI(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new W(j.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Ct(m)}t._authCredentials=new NR(new oE(d,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ur(this.firestore,e,this._query)}}class je{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Or(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new je(this.firestore,e,this._key)}toJSON(){return{type:je._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(_a(n,je._jsonSchema))return new je(e,r||null,new se(xe.fromString(n.referencePath)))}}je._jsonSchemaVersion="firestore/documentReference/1.0",je._jsonSchema={type:Ze("string",je._jsonSchemaVersion),referencePath:Ze("string")};class Or extends ur{constructor(e,n,r){super(e,n,Ku(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new je(this.firestore,null,new se(e))}withConverter(e){return new Or(this.firestore,e,this._path)}}function Gt(t,e,...n){if(t=Qt(t),lE("collection","path",e),t instanceof sc){const r=xe.fromString(e,...n);return dy(r),new Or(t,null,r)}{if(!(t instanceof je||t instanceof Or))throw new W(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(xe.fromString(e,...n));return dy(r),new Or(t.firestore,null,r)}}function Oe(t,e,...n){if(t=Qt(t),arguments.length===1&&(e=Yf.newId()),lE("doc","path",e),t instanceof sc){const r=xe.fromString(e,...n);return cy(r),new je(t,null,new se(r))}{if(!(t instanceof je||t instanceof Or))throw new W(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(xe.fromString(e,...n));return cy(r),new je(t.firestore,t instanceof Or?t.converter:null,new se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zy="AsyncQueue";class e_{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new cp(this,"async_queue_retry"),this.oc=()=>{const r=ld();r&&J(Zy,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const n=ld();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const n=ld();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new On;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Di(e))throw e;J(Zy,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const n=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,ir("INTERNAL UNHANDLED ERROR: ",t_(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(e,n,r){this.ac(),this.sc.indexOf(e)>-1&&(n=0);const s=mp.createAndSchedule(this,e,n,r,i=>this.lc(i));return this.ec.push(s),s}ac(){this.tc&&ie(47125,{hc:t_(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const n of this.ec)if(n.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const n=this.ec.indexOf(e);this.ec.splice(n,1)}}function t_(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n_(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Un extends sc{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new e_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new e_(e),this._firestoreClient=void 0,await e}}}function RA(t,e){const n=typeof t=="object"?t:Y0(),r=typeof t=="string"?t:du,s=ya(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=iI("firestore");i&&IA(s,...i)}return s}function Ca(t){if(t._terminated)throw new W(j.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||xA(t),t._firestoreClient}function xA(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,c,d){return new XR(l,u,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,vT(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new vA(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this._byteString=e}static fromBase64String(e){try{return new en(mt.fromBase64String(e))}catch(n){throw new W(j.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new en(mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:en._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(_a(e,en._jsonSchema))return en.fromBase64String(e.bytes)}}en._jsonSchemaVersion="firestore/bytes/1.0",en._jsonSchema={type:Ze("string",en._jsonSchemaVersion),bytes:Ze("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new W(j.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new W(j.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new W(j.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return he(this._lat,e._lat)||he(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:jn._jsonSchemaVersion}}static fromJSON(e){if(_a(e,jn._jsonSchema))return new jn(e.latitude,e.longitude)}}jn._jsonSchemaVersion="firestore/geoPoint/1.0",jn._jsonSchema={type:Ze("string",jn._jsonSchemaVersion),latitude:Ze("number"),longitude:Ze("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Fn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(_a(e,Fn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Fn(e.vectorValues);throw new W(j.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Fn._jsonSchemaVersion="firestore/vectorValue/1.0",Fn._jsonSchema={type:Ze("string",Fn._jsonSchemaVersion),vectorValues:Ze("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA=/^__.*__$/;class AA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ts(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ea(e,this.data,n,this.fieldTransforms)}}class TT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ts(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function wT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ie(40011,{Ec:t})}}class Ip{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Ac(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Ip(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Rc({path:r,mc:!1});return s.fc(e),s}gc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Rc({path:r,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Tu(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(wT(this.Ec)&&kA.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class bA{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||tc(e)}Dc(e,n,r,s=!1){return new Ip({Ec:e,methodName:n,bc:r,path:dt.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xa(t){const e=t._freezeSettings(),n=tc(t._databaseId);return new bA(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Rp(t,e,n,r,s,i={}){const o=t.Dc(i.merge||i.mergeFields?2:0,e,n,s);Ap("Data must be an object, but it was:",o,r);const l=IT(r,o);let u,c;if(i.merge)u=new nn(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const p of i.mergeFields){const m=kh(e,p,n);if(!o.contains(m))throw new W(j.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);xT(d,m)||d.push(m)}u=new nn(d),c=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,c=o.fieldTransforms;return new AA(new Dt(l),u,c)}class ic extends Ra{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ic}}class xp extends Ra{_toFieldTransform(e){return new jE(e.path,new aa)}isEqual(e){return e instanceof xp}}class kp extends Ra{constructor(e,n){super(e),this.Cc=n}_toFieldTransform(e){const n=new ca(e.serializer,DE(e.serializer,this.Cc));return new jE(e.path,n)}isEqual(e){return e instanceof kp&&this.Cc===e.Cc}}function ST(t,e,n,r){const s=t.Dc(1,e,n);Ap("Data must be an object, but it was:",s,r);const i=[],o=Dt.empty();es(r,(u,c)=>{const d=bp(e,u,n);c=Qt(c);const p=s.gc(d);if(c instanceof ic)i.push(d);else{const m=ka(c,p);m!=null&&(i.push(d),o.set(d,m))}});const l=new nn(i);return new TT(o,l,s.fieldTransforms)}function CT(t,e,n,r,s,i){const o=t.Dc(1,e,n),l=[kh(e,r,n)],u=[s];if(i.length%2!=0)throw new W(j.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(kh(e,i[m])),u.push(i[m+1]);const c=[],d=Dt.empty();for(let m=l.length-1;m>=0;--m)if(!xT(c,l[m])){const v=l[m];let R=u[m];R=Qt(R);const b=o.gc(v);if(R instanceof ic)c.push(v);else{const V=ka(R,b);V!=null&&(c.push(v),d.set(v,V))}}const p=new nn(c);return new TT(d,p,o.fieldTransforms)}function PA(t,e,n,r=!1){return ka(n,t.Dc(r?4:3,e))}function ka(t,e){if(RT(t=Qt(t)))return Ap("Unsupported field value:",e,t),IT(t,e);if(t instanceof Ra)return function(r,s){if(!wT(s.Ec))throw s.wc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=ka(l,s.yc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Qt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return DE(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Se.fromDate(r);return{timestampValue:mu(s.serializer,i)}}if(r instanceof Se){const i=new Se(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:mu(s.serializer,i)}}if(r instanceof jn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof en)return{bytesValue:HE(s.serializer,r._byteString)};if(r instanceof je){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ip(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Fn)return function(o,l){return{mapValue:{fields:{[yE]:{stringValue:_E},[hu]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.wc("VectorValues must only contain numeric values.");return np(l.serializer,c)})}}}}}}(r,s);throw s.wc(`Unsupported field value: ${Wu(r)}`)}(t,e)}function IT(t,e){const n={};return dE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):es(t,(r,s)=>{const i=ka(s,e.Vc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function RT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Se||t instanceof jn||t instanceof en||t instanceof je||t instanceof Ra||t instanceof Fn)}function Ap(t,e,n){if(!RT(n)||!uE(n)){const r=Wu(n);throw r==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+r)}}function kh(t,e,n){if((e=Qt(e))instanceof Ia)return e._internalPath;if(typeof e=="string")return bp(t,e);throw Tu("Field path arguments must be of type string or ",t,!1,void 0,n)}const NA=new RegExp("[~\\*/\\[\\]]");function bp(t,e,n){if(e.search(NA)>=0)throw Tu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ia(...e.split("."))._internalPath}catch{throw Tu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Tu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new W(j.INVALID_ARGUMENT,l+t+u)}function xT(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new je(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new DA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(oc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class DA extends wu{data(){return super.data()}}function oc(t,e){return typeof e=="string"?bp(t,e):e instanceof Ia?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new W(j.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Pp{}class Np extends Pp{}function Aa(t,e,...n){let r=[];e instanceof Pp&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof Dp).length,l=i.filter(u=>u instanceof ac).length;if(o>1||o>0&&l>0)throw new W(j.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class ac extends Np{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new ac(e,n,r)}_apply(e){const n=this._parse(e);return bT(e._query,n),new ur(e.firestore,e.converter,vh(e._query,n))}_parse(e){const n=xa(e.firestore);return function(i,o,l,u,c,d,p){let m;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new W(j.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){s_(p,d);const R=[];for(const b of p)R.push(r_(u,i,b));m={arrayValue:{values:R}}}else m=r_(u,i,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||s_(p,d),m=PA(l,o,p,d==="in"||d==="not-in");return Xe.create(c,d,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function lc(t,e,n){const r=e,s=oc("where",t);return ac._create(s,r,n)}class Dp extends Pp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Dp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:In.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)bT(o,u),o=vh(o,u)}(e._query,n),new ur(e.firestore,e.converter,vh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Vp extends Np{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Vp(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new W(j.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new W(j.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new oa(i,o)}(e._query,this._field,this._direction);return new ur(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Vi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function AT(t,e="asc"){const n=e,r=oc("orderBy",t);return Vp._create(r,n)}class Mp extends Np{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Mp(e,n,r)}_apply(e){return new ur(e.firestore,e.converter,pu(e._query,this._limit,this._limitType))}}function Op(t){return UR("limit",t),Mp._create("limit",t,"F")}function r_(t,e,n){if(typeof(n=Qt(n))=="string"){if(n==="")throw new W(j.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!RE(e)&&n.indexOf("/")!==-1)throw new W(j.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(xe.fromString(n));if(!se.isDocumentKey(r))throw new W(j.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return vy(t,new se(r))}if(n instanceof je)return vy(t,n._key);throw new W(j.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wu(n)}.`)}function s_(t,e){if(!Array.isArray(t)||t.length===0)throw new W(j.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bT(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new W(j.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new W(j.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class PT{convertValue(e,n="none"){switch(Gr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return He(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Hr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ie(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return es(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[hu].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>He(o.doubleValue));return new Fn(i)}convertGeoPoint(e){return new jn(He(e.latitude),He(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Gu(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ra(e));default:return null}}convertTimestamp(e){const n=Wr(e);return new Se(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=xe.fromString(e);Ee(ZE(r),9688,{name:e});const s=new sa(r.get(1),r.get(3)),i=new se(r.popFirst(5));return s.isEqual(n)||ir(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lp(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class VA extends PT{constructor(e){super(),this.firestore=e}convertBytes(e){return new en(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new je(this.firestore,null,n)}}class ai{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Lr extends wu{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Pl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(oc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new W(j.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Lr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Lr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Lr._jsonSchema={type:Ze("string",Lr._jsonSchemaVersion),bundleSource:Ze("string","DocumentSnapshot"),bundleName:Ze("string"),bundle:Ze("string")};class Pl extends Lr{data(e={}){return super.data(e)}}class Es{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new ai(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Pl(this._firestore,this._userDataWriter,r.key,r,new ai(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new W(j.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new Pl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new ai(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Pl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new ai(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,d=-1;return l.type!==0&&(c=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:MA(l.type),doc:u,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new W(j.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Es._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Yf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function MA(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ie(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(t){t=Mt(t,je);const e=Mt(t.firestore,Un);return SA(Ca(e),t._key).then(n=>VT(e,t,n))}Es._jsonSchemaVersion="firestore/querySnapshot/1.0",Es._jsonSchema={type:Ze("string",Es._jsonSchemaVersion),bundleSource:Ze("string","QuerySnapshot"),bundleName:Ze("string"),bundle:Ze("string")};class uc extends PT{constructor(e){super(),this.firestore=e}convertBytes(e){return new en(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new je(this.firestore,null,n)}}function cc(t){t=Mt(t,ur);const e=Mt(t.firestore,Un),n=Ca(e),r=new uc(e);return kT(t._query),CA(n,t._query).then(s=>new Es(e,r,t,s))}function DT(t,e,n){t=Mt(t,je);const r=Mt(t.firestore,Un),s=Lp(t.converter,e,n);return hc(r,[Rp(xa(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,ht.none())])}function dc(t,e,n,...r){t=Mt(t,je);const s=Mt(t.firestore,Un),i=xa(s);let o;return o=typeof(e=Qt(e))=="string"||e instanceof Ia?CT(i,"updateDoc",t._key,e,n,r):ST(i,"updateDoc",t._key,e),hc(s,[o.toMutation(t._key,ht.exists(!0))])}function OA(t){return hc(Mt(t.firestore,Un),[new Zu(t._key,ht.none())])}function LA(t,e){const n=Mt(t.firestore,Un),r=Oe(t),s=Lp(t.converter,e);return hc(n,[Rp(xa(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,ht.exists(!1))]).then(()=>r)}function Su(t,...e){var n,r,s;t=Qt(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||n_(e[o])||(i=e[o++]);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(n_(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(s=p.complete)===null||s===void 0?void 0:s.bind(p)}let u,c,d;if(t instanceof je)c=Mt(t.firestore,Un),d=Ku(t._key.path),u={next:p=>{e[o]&&e[o](VT(c,t,p))},error:e[o+1],complete:e[o+2]};else{const p=Mt(t,ur);c=Mt(p.firestore,Un),d=p._query;const m=new uc(c);u={next:v=>{e[o]&&e[o](new Es(c,m,p,v))},error:e[o+1],complete:e[o+2]},kT(t._query)}return function(m,v,R,b){const V=new Sp(b),w=new Ep(v,V,R);return m.asyncQueue.enqueueAndForget(async()=>yp(await Eu(m),w)),()=>{V.Ou(),m.asyncQueue.enqueueAndForget(async()=>_p(await Eu(m),w))}}(Ca(c),d,l,u)}function hc(t,e){return function(r,s){const i=new On;return r.asyncQueue.enqueueAndForget(async()=>lA(await TA(r),s,i)),i.promise}(Ca(t),e)}function VT(t,e,n){const r=n.docs.get(e._key),s=new uc(t);return new Lr(t,s,e._key,r,new ai(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA={maxAttempts:5};function go(t,e){if((t=Qt(t)).firestore!==e)throw new W(j.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=xa(e)}get(e){const n=go(e,this._firestore),r=new VA(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return ie(24041);const i=s[0];if(i.isFoundDocument())return new wu(this._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new wu(this._firestore,r,n._key,null,n.converter);throw ie(18433,{doc:i})})}set(e,n,r){const s=go(e,this._firestore),i=Lp(s.converter,n,r),o=Rp(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,o),this}update(e,n,r,...s){const i=go(e,this._firestore);let o;return o=typeof(n=Qt(n))=="string"||n instanceof Ia?CT(this._dataReader,"Transaction.update",i._key,n,r,s):ST(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=go(e,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA extends FA{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=go(e,this._firestore),r=new uc(this._firestore);return super.get(e).then(s=>new Lr(this._firestore,r,n._key,s._document,new ai(!1,!1),n.converter))}}function $n(t,e,n){t=Mt(t,Un);const r=Object.assign(Object.assign({},jA),n);return function(i){if(i.maxAttempts<1)throw new W(j.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,l){const u=new On;return i.asyncQueue.enqueueAndForget(async()=>{const c=await wA(i);new _A(i.asyncQueue,c,l,o,u).zu()}),u.promise}(Ca(t),s=>e(new BA(t,s)),r)}function Ke(){return new xp("serverTimestamp")}function UA(t){return new kp("increment",t)}(function(e,n=!0){(function(s){Pi=s})(ER),$r(new rr("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new Un(new DR(r.getProvider("auth-internal")),new OR(o,r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new W(j.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new sa(c.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Mn(iy,oy,e),Mn(iy,oy,"esm2017")})();var $A="firebase",zA="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mn($A,zA,"app");const MT="@firebase/installations",jp="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OT=1e4,LT=`w:${jp}`,jT="FIS_v2",qA="https://firebaseinstallations.googleapis.com/v1",WA=60*60*1e3,HA="installations",GA="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KA={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},As=new qu(HA,GA,KA);function FT(t){return t instanceof Zr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BT({projectId:t}){return`${qA}/projects/${t}/installations`}function UT(t){return{token:t.token,requestStatus:2,expiresIn:YA(t.expiresIn),creationTime:Date.now()}}async function $T(t,e){const r=(await e.json()).error;return As.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function zT({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function QA(t,{refreshToken:e}){const n=zT(t);return n.append("Authorization",JA(e)),n}async function qT(t){const e=await t();return e.status>=500&&e.status<600?t():e}function YA(t){return Number(t.replace("s","000"))}function JA(t){return`${jT} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XA({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=BT(t),s=zT(t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={fid:n,authVersion:jT,appId:t.appId,sdkVersion:LT},l={method:"POST",headers:s,body:JSON.stringify(o)},u=await qT(()=>fetch(r,l));if(u.ok){const c=await u.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:UT(c.authToken)}}else throw await $T("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb=/^[cdef][\w-]{21}$/,Ah="";function tb(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=nb(t);return eb.test(n)?n:Ah}catch{return Ah}}function nb(t){return ZA(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT=new Map;function GT(t,e){const n=fc(t);KT(n,e),rb(n,e)}function KT(t,e){const n=HT.get(t);if(n)for(const r of n)r(e)}function rb(t,e){const n=sb();n&&n.postMessage({key:t,fid:e}),ib()}let ys=null;function sb(){return!ys&&"BroadcastChannel"in self&&(ys=new BroadcastChannel("[Firebase] FID Change"),ys.onmessage=t=>{KT(t.data.key,t.data.fid)}),ys}function ib(){HT.size===0&&ys&&(ys.close(),ys=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ob="firebase-installations-database",ab=1,bs="firebase-installations-store";let cd=null;function Fp(){return cd||(cd=K0(ob,ab,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(bs)}}})),cd}async function Cu(t,e){const n=fc(t),s=(await Fp()).transaction(bs,"readwrite"),i=s.objectStore(bs),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&GT(t,e.fid),e}async function QT(t){const e=fc(t),r=(await Fp()).transaction(bs,"readwrite");await r.objectStore(bs).delete(e),await r.done}async function pc(t,e){const n=fc(t),s=(await Fp()).transaction(bs,"readwrite"),i=s.objectStore(bs),o=await i.get(n),l=e(o);return l===void 0?await i.delete(n):await i.put(l,n),await s.done,l&&(!o||o.fid!==l.fid)&&GT(t,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bp(t){let e;const n=await pc(t.appConfig,r=>{const s=lb(r),i=ub(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===Ah?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function lb(t){const e=t||{fid:tb(),registrationStatus:0};return YT(e)}function ub(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(As.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=cb(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:db(t)}:{installationEntry:e}}async function cb(t,e){try{const n=await XA(t,e);return Cu(t.appConfig,n)}catch(n){throw FT(n)&&n.customData.serverCode===409?await QT(t.appConfig):await Cu(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function db(t){let e=await i_(t.appConfig);for(;e.registrationStatus===1;)await WT(100),e=await i_(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await Bp(t);return r||n}return e}function i_(t){return pc(t,e=>{if(!e)throw As.create("installation-not-found");return YT(e)})}function YT(t){return hb(t)?{fid:t.fid,registrationStatus:0}:t}function hb(t){return t.registrationStatus===1&&t.registrationTime+OT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fb({appConfig:t,heartbeatServiceProvider:e},n){const r=pb(t,n),s=QA(t,n),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={installation:{sdkVersion:LT,appId:t.appId}},l={method:"POST",headers:s,body:JSON.stringify(o)},u=await qT(()=>fetch(r,l));if(u.ok){const c=await u.json();return UT(c)}else throw await $T("Generate Auth Token",u)}function pb(t,{fid:e}){return`${BT(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Up(t,e=!1){let n;const r=await pc(t.appConfig,i=>{if(!JT(i))throw As.create("not-registered");const o=i.authToken;if(!e&&yb(o))return i;if(o.requestStatus===1)return n=mb(t,e),i;{if(!navigator.onLine)throw As.create("app-offline");const l=vb(i);return n=gb(t,l),l}});return n?await n:r.authToken}async function mb(t,e){let n=await o_(t.appConfig);for(;n.authToken.requestStatus===1;)await WT(100),n=await o_(t.appConfig);const r=n.authToken;return r.requestStatus===0?Up(t,e):r}function o_(t){return pc(t,e=>{if(!JT(e))throw As.create("not-registered");const n=e.authToken;return Eb(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function gb(t,e){try{const n=await fb(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Cu(t.appConfig,r),n}catch(n){if(FT(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await QT(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Cu(t.appConfig,r)}throw n}}function JT(t){return t!==void 0&&t.registrationStatus===2}function yb(t){return t.requestStatus===2&&!_b(t)}function _b(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+WA}function vb(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function Eb(t){return t.requestStatus===1&&t.requestTime+OT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tb(t){const e=t,{installationEntry:n,registrationPromise:r}=await Bp(e);return r?r.catch(console.error):Up(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wb(t,e=!1){const n=t;return await Sb(n),(await Up(n,e)).token}async function Sb(t){const{registrationPromise:e}=await Bp(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cb(t){if(!t||!t.options)throw dd("App Configuration");if(!t.name)throw dd("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw dd(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function dd(t){return As.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XT="installations",Ib="installations-internal",Rb=t=>{const e=t.getProvider("app").getImmediate(),n=Cb(e),r=ya(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},xb=t=>{const e=t.getProvider("app").getImmediate(),n=ya(e,XT).getImmediate();return{getId:()=>Tb(n),getToken:s=>wb(n,s)}};function kb(){$r(new rr(XT,Rb,"PUBLIC")),$r(new rr(Ib,xb,"PRIVATE"))}kb();Mn(MT,jp);Mn(MT,jp,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iu="analytics",Ab="firebase_id",bb="origin",Pb=60*1e3,Nb="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",$p="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kt=new Gf("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Db={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},on=new qu("analytics","Analytics",Db);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vb(t){if(!t.startsWith($p)){const e=on.create("invalid-gtag-resource",{gtagURL:t});return Kt.warn(e.message),""}return t}function ZT(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function Mb(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function Ob(t,e){const n=Mb("firebase-js-sdk-policy",{createScriptURL:Vb}),r=document.createElement("script"),s=`${$p}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function Lb(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function jb(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const u=(await ZT(n)).find(c=>c.measurementId===s);u&&await e[u.appId]}}catch(l){Kt.error(l)}t("config",s,i)}async function Fb(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const l=await ZT(n);for(const u of o){const c=l.find(p=>p.measurementId===u),d=c&&e[c.appId];if(d)i.push(d);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){Kt.error(i)}}function Bb(t,e,n,r){async function s(i,...o){try{if(i==="event"){const[l,u]=o;await Fb(t,e,n,l,u)}else if(i==="config"){const[l,u]=o;await jb(t,e,n,r,l,u)}else if(i==="consent"){const[l,u]=o;t("consent",l,u)}else if(i==="get"){const[l,u,c]=o;t("get",l,u,c)}else if(i==="set"){const[l]=o;t("set",l)}else t(i,...o)}catch(l){Kt.error(l)}}return s}function Ub(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=Bb(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function $b(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes($p)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb=30,qb=1e3;class Wb{constructor(e={},n=qb){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const ew=new Wb;function Hb(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Gb(t){var e;const{appId:n,apiKey:r}=t,s={method:"GET",headers:Hb(r)},i=Nb.replace("{app-id}",n),o=await fetch(i,s);if(o.status!==200&&o.status!==304){let l="";try{const u=await o.json();!((e=u.error)===null||e===void 0)&&e.message&&(l=u.error.message)}catch{}throw on.create("config-fetch-failed",{httpStatus:o.status,responseMessage:l})}return o.json()}async function Kb(t,e=ew,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw on.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw on.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new Jb;return setTimeout(async()=>{l.abort()},Pb),tw({appId:r,apiKey:s,measurementId:i},o,l,e)}async function tw(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=ew){var i;const{appId:o,measurementId:l}=t;try{await Qb(r,e)}catch(u){if(l)return Kt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:o,measurementId:l};throw u}try{const u=await Gb(t);return s.deleteThrottleMetadata(o),u}catch(u){const c=u;if(!Yb(c)){if(s.deleteThrottleMetadata(o),l)return Kt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:l};throw u}const d=Number((i=c==null?void 0:c.customData)===null||i===void 0?void 0:i.httpStatus)===503?Qg(n,s.intervalMillis,zb):Qg(n,s.intervalMillis),p={throttleEndTimeMillis:Date.now()+d,backoffCount:n+1};return s.setThrottleMetadata(o,p),Kt.debug(`Calling attemptFetch again in ${d} millis`),tw(t,p,r,s)}}function Qb(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(on.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Yb(t){if(!(t instanceof Zr)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class Jb{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Xb(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o=Object.assign(Object.assign({},r),{send_to:i});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zb(){if(Wf())try{await Hf()}catch(t){return Kt.warn(on.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Kt.warn(on.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function eP(t,e,n,r,s,i,o){var l;const u=Kb(t);u.then(v=>{n[v.measurementId]=v.appId,t.options.measurementId&&v.measurementId!==t.options.measurementId&&Kt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${v.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(v=>Kt.error(v)),e.push(u);const c=Zb().then(v=>{if(v)return r.getId()}),[d,p]=await Promise.all([u,c]);$b(i)||Ob(i,d.measurementId),s("js",new Date);const m=(l=o==null?void 0:o.config)!==null&&l!==void 0?l:{};return m[bb]="firebase",m.update=!0,p!=null&&(m[Ab]=p),s("config",d.measurementId,m),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e){this.app=e}_delete(){return delete Vo[this.app.options.appId],Promise.resolve()}}let Vo={},a_=[];const l_={};let hd="dataLayer",nP="gtag",u_,nw,c_=!1;function rP(){const t=[];if(q0()&&t.push("This is a browser extension environment."),W0()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=on.create("invalid-analytics-context",{errorInfo:e});Kt.warn(n.message)}}function sP(t,e,n){rP();const r=t.options.appId;if(!r)throw on.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Kt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw on.create("no-api-key");if(Vo[r]!=null)throw on.create("already-exists",{id:r});if(!c_){Lb(hd);const{wrappedGtag:i,gtagCore:o}=Ub(Vo,a_,l_,hd,nP);nw=i,u_=o,c_=!0}return Vo[r]=eP(t,a_,l_,e,u_,hd,n),new tP(t)}function iP(t=Y0()){t=Qt(t);const e=ya(t,Iu);return e.isInitialized()?e.getImmediate():oP(t)}function oP(t,e={}){const n=ya(t,Iu);if(n.isInitialized()){const s=n.getImmediate();if(ea(e,n.getOptions()))return s;throw on.create("already-initialized")}return n.initialize({options:e})}async function aP(){if(q0()||!W0()||!Wf())return!1;try{return await Hf()}catch{return!1}}function lP(t,e,n,r){t=Qt(t),Xb(nw,Vo[t.app.options.appId],e,n,r).catch(s=>Kt.error(s))}const d_="@firebase/analytics",h_="0.10.17";function uP(){$r(new rr(Iu,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return sP(r,s,n)},"PUBLIC")),$r(new rr("analytics-internal",t,"PRIVATE")),Mn(d_,h_),Mn(d_,h_,"esm2017");function t(e){try{const n=e.getProvider(Iu).getImmediate();return{logEvent:(r,s,i)=>lP(n,r,s,i)}}catch(n){throw on.create("interop-component-reg-failed",{reason:n})}}}uP();const cP={apiKey:"AIzaSyAkRzBcjNgviDhfFfK6OBVIi3OyXV9yUsM",authDomain:"auction-9bf14.firebaseapp.com",projectId:"auction-9bf14",storageBucket:"auction-9bf14.firebasestorage.app",messagingSenderId:"820607204428",appId:"1:820607204428:web:e653708acfde4db44f48e9",measurementId:"G-941XK71YPF"},rw=Q0(cP),Ce=RA(rw);aP().then(t=>{t&&iP(rw)}).catch(()=>{});const f_="saifur-auction:clientId",dP=()=>typeof(crypto==null?void 0:crypto.randomUUID)=="function"?crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`,hP=()=>D.useMemo(()=>{if(typeof window>"u")return"";const t=window.localStorage.getItem(f_);if(t)return t;const e=dP();return window.localStorage.setItem(f_,e),e},[]),fP=t=>{const[e,n]=D.useState(null),[r,s]=D.useState([]),[i,o]=D.useState(!1);return D.useEffect(()=>{if(!t){n(null),s([]);return}o(!0);const l=Oe(Ce,"auctions",t);let u=null;const c=Su(l,d=>{if(!d.exists()){n(null),s([]),o(!1),u&&(u(),u=null);return}if(n({id:d.id,...d.data()}),o(!1),!u){const p=Gt(l,"participants"),m=Aa(p,AT("joinedAt","asc"));u=Su(m,v=>{const R=[];v.forEach(b=>{R.push({id:b.id,...b.data()})}),s(R)})}},()=>{o(!1)});return()=>{c(),u&&u()}},[t]),{auction:e,participants:r,loading:i}},pP=t=>{const[e,n]=D.useState(0),[r,s]=D.useState(!1);return D.useEffect(()=>{const i=t==null?void 0:t.toMillis();if(!i){n(0),s(!1);return}const o=()=>{const u=i-Date.now();n(u),s(u<=0)};o();const l=setInterval(o,300);return()=>clearInterval(l)},[t]),{msRemaining:e,isExpired:r}};class mP{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const n of this._parts)e.push(n);return gP(e).buffer}}function gP(t){let e=0;for(const s of t)e+=s.byteLength;const n=new Uint8Array(e);let r=0;for(const s of t){const i=new Uint8Array(s.buffer,s.byteOffset,s.byteLength);n.set(i,r),r+=s.byteLength}return n}function sw(t){return new yP(t).unpack()}function iw(t){const e=new _P,n=e.pack(t);return n instanceof Promise?n.then(()=>e.getBuffer()):e.getBuffer()}class yP{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let n;if((n=e^160)<=15)return this.unpack_raw(n);if((n=e^176)<=15)return this.unpack_string(n);if((n=e^144)<=15)return this.unpack_array(n);if((n=e^128)<=15)return this.unpack_map(n);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return n=this.unpack_uint16(),this.unpack_string(n);case 217:return n=this.unpack_uint32(),this.unpack_string(n);case 218:return n=this.unpack_uint16(),this.unpack_raw(n);case 219:return n=this.unpack_uint32(),this.unpack_raw(n);case 220:return n=this.unpack_uint16(),this.unpack_array(n);case 221:return n=this.unpack_uint32(),this.unpack_array(n);case 222:return n=this.unpack_uint16(),this.unpack_map(n);case 223:return n=this.unpack_uint32(),this.unpack_map(n)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),n=(e[0]&255)*256+(e[1]&255);return this.index+=2,n}unpack_uint32(){const e=this.read(4),n=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,n}unpack_uint64(){const e=this.read(8),n=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,n}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const n=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,n}unpack_string(e){const n=this.read(e);let r=0,s="",i,o;for(;r<e;)i=n[r],i<160?(o=i,r++):(i^192)<32?(o=(i&31)<<6|n[r+1]&63,r+=2):(i^224)<16?(o=(i&15)<<12|(n[r+1]&63)<<6|n[r+2]&63,r+=3):(o=(i&7)<<18|(n[r+1]&63)<<12|(n[r+2]&63)<<6|n[r+3]&63,r+=4),s+=String.fromCodePoint(o);return this.index+=e,s}unpack_array(e){const n=new Array(e);for(let r=0;r<e;r++)n[r]=this.unpack();return n}unpack_map(e){const n={};for(let r=0;r<e;r++){const s=this.unpack();n[s]=this.unpack()}return n}unpack_float(){const e=this.unpack_uint32(),n=e>>31,r=(e>>23&255)-127,s=e&8388607|8388608;return(n===0?1:-1)*s*2**(r-23)}unpack_double(){const e=this.unpack_uint32(),n=this.unpack_uint32(),r=e>>31,s=(e>>20&2047)-1023,o=(e&1048575|1048576)*2**(s-20)+n*2**(s-52);return(r===0?1:-1)*o}read(e){const n=this.index;if(n+e<=this.length)return this.dataView.subarray(n,n+e);throw new Error("BinaryPackFailure: read index out of range")}}class _P{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const n=e.constructor;if(e instanceof Array){const r=this.pack_array(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const r=e;this.pack_bin(new Uint8Array(r.buffer,r.byteOffset,r.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(r=>{this.pack_bin(new Uint8Array(r)),this._bufferBuilder.flush()});if(n==Object||n.toString().startsWith("class")){const r=this.pack_object(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${n.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const n=e.length;if(n<=15)this.pack_uint8(160+n);else if(n<=65535)this._bufferBuilder.append(218),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(n);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const n=this._textEncoder.encode(e),r=n.length;if(r<=15)this.pack_uint8(176+r);else if(r<=65535)this._bufferBuilder.append(216),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(r);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(n)}pack_array(e){const n=e.length;if(n<=15)this.pack_uint8(144+n);else if(n<=65535)this._bufferBuilder.append(220),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(n);else throw new Error("Invalid length");const r=s=>{if(s<n){const i=this.pack(e[s]);return i instanceof Promise?i.then(()=>r(s+1)):r(s+1)}};return r(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let n=0;e<0&&(n=1,e=-e);const r=Math.floor(Math.log(e)/Math.LN2),s=e/2**r-1,i=Math.floor(s*2**52),o=2**32,l=n<<31|r+1023<<20|i/o&1048575,u=i%o;this._bufferBuilder.append(203),this.pack_int32(l),this.pack_int32(u)}pack_object(e){const n=Object.keys(e),r=n.length;if(r<=15)this.pack_uint8(128+r);else if(r<=65535)this._bufferBuilder.append(222),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(r);else throw new Error("Invalid length");const s=i=>{if(i<n.length){const o=n[i];if(e.hasOwnProperty(o)){this.pack(o);const l=this.pack(e[o]);if(l instanceof Promise)return l.then(()=>s(i+1))}return s(i+1)}};return s(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const n=e&4294967295;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}pack_uint64(e){const n=e/4294967296,r=e%2**32;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const n=Math.floor(e/4294967296),r=e%2**32;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}constructor(){this._bufferBuilder=new mP,this._textEncoder=new TextEncoder}}let ow=!0,aw=!0;function yo(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseFloat(r[n],10)}function Ms(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,s=r.addEventListener;r.addEventListener=function(o,l){if(o!==e)return s.apply(this,arguments);const u=c=>{const d=n(c);d&&(l.handleEvent?l.handleEvent(d):l(d))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(l,u),s.apply(this,[o,u])};const i=r.removeEventListener;r.removeEventListener=function(o,l){if(o!==e||!this._eventMap||!this._eventMap[e])return i.apply(this,arguments);if(!this._eventMap[e].has(l))return i.apply(this,arguments);const u=this._eventMap[e].get(l);return this._eventMap[e].delete(l),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,i.apply(this,[o,u])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function vP(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(ow=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function EP(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(aw=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function lw(){if(typeof window=="object"){if(ow)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function zp(t,e){aw&&console.warn(t+" is deprecated, please use "+e+" instead.")}function TP(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.userAgentData&&n.userAgentData.brands){const r=n.userAgentData.brands.find(s=>s.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=parseInt(yo(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(yo(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(yo(n.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype,e._safariVersion=yo(n.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function p_(t){return Object.prototype.toString.call(t)==="[object Object]"}function uw(t){return p_(t)?Object.keys(t).reduce(function(e,n){const r=p_(t[n]),s=r?uw(t[n]):t[n],i=r&&!Object.keys(s).length;return s===void 0||i?e:Object.assign(e,{[n]:s})},{}):t}function bh(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?bh(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(s=>{bh(t,t.get(s),n)})}))}function m_(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",s=new Map;if(e===null)return s;const i=[];return t.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&i.push(o)}),i.forEach(o=>{t.forEach(l=>{l.type===r&&l.trackId===o.id&&bh(t,l,s)})}),s}const g_=lw;function cw(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(l){if(typeof l!="object"||l.mandatory||l.optional)return l;const u={};return Object.keys(l).forEach(c=>{if(c==="require"||c==="advanced"||c==="mediaSource")return;const d=typeof l[c]=="object"?l[c]:{ideal:l[c]};d.exact!==void 0&&typeof d.exact=="number"&&(d.min=d.max=d.exact);const p=function(m,v){return m?m+v.charAt(0).toUpperCase()+v.slice(1):v==="deviceId"?"sourceId":v};if(d.ideal!==void 0){u.optional=u.optional||[];let m={};typeof d.ideal=="number"?(m[p("min",c)]=d.ideal,u.optional.push(m),m={},m[p("max",c)]=d.ideal,u.optional.push(m)):(m[p("",c)]=d.ideal,u.optional.push(m))}d.exact!==void 0&&typeof d.exact!="number"?(u.mandatory=u.mandatory||{},u.mandatory[p("",c)]=d.exact):["min","max"].forEach(m=>{d[m]!==void 0&&(u.mandatory=u.mandatory||{},u.mandatory[p(m,c)]=d[m])})}),l.advanced&&(u.optional=(u.optional||[]).concat(l.advanced)),u},s=function(l,u){if(e.version>=61)return u(l);if(l=JSON.parse(JSON.stringify(l)),l&&typeof l.audio=="object"){const c=function(d,p,m){p in d&&!(m in d)&&(d[m]=d[p],delete d[p])};l=JSON.parse(JSON.stringify(l)),c(l.audio,"autoGainControl","googAutoGainControl"),c(l.audio,"noiseSuppression","googNoiseSuppression"),l.audio=r(l.audio)}if(l&&typeof l.video=="object"){let c=l.video.facingMode;c=c&&(typeof c=="object"?c:{ideal:c});const d=e.version<66;if(c&&(c.exact==="user"||c.exact==="environment"||c.ideal==="user"||c.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!d)){delete l.video.facingMode;let p;if(c.exact==="environment"||c.ideal==="environment"?p=["back","rear"]:(c.exact==="user"||c.ideal==="user")&&(p=["front"]),p)return n.mediaDevices.enumerateDevices().then(m=>{m=m.filter(R=>R.kind==="videoinput");let v=m.find(R=>p.some(b=>R.label.toLowerCase().includes(b)));return!v&&m.length&&p.includes("back")&&(v=m[m.length-1]),v&&(l.video.deviceId=c.exact?{exact:v.deviceId}:{ideal:v.deviceId}),l.video=r(l.video),g_("chrome: "+JSON.stringify(l)),u(l)})}l.video=r(l.video)}return g_("chrome: "+JSON.stringify(l)),u(l)},i=function(l){return e.version>=64?l:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[l.name]||l.name,message:l.message,constraint:l.constraint||l.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(l,u,c){s(l,d=>{n.webkitGetUserMedia(d,u,p=>{c&&c(i(p))})})};if(n.getUserMedia=o.bind(n),n.mediaDevices.getUserMedia){const l=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(u){return s(u,c=>l(c).then(d=>{if(c.audio&&!d.getAudioTracks().length||c.video&&!d.getVideoTracks().length)throw d.getTracks().forEach(p=>{p.stop()}),new DOMException("","NotFoundError");return d},d=>Promise.reject(i(d))))}}}function dw(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function hw(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",s=>{let i;t.RTCPeerConnection.prototype.getReceivers?i=this.getReceivers().find(l=>l.track&&l.track.id===s.track.id):i={track:s.track};const o=new Event("track");o.track=s.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[r.stream],this.dispatchEvent(o)}),r.stream.getTracks().forEach(s=>{let i;t.RTCPeerConnection.prototype.getReceivers?i=this.getReceivers().find(l=>l.track&&l.track.id===s.id):i={track:s};const o=new Event("track");o.track=s,o.receiver=i,o.transceiver={receiver:i},o.streams=[r.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Ms(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function fw(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(s,i){return{track:i,get dtmf(){return this._dtmf===void 0&&(i.kind==="audio"?this._dtmf=s.createDTMFSender(i):this._dtmf=null),this._dtmf},_pc:s}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const s=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(l,u){let c=s.apply(this,arguments);return c||(c=e(this,l),this._senders.push(c)),c};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(l){i.apply(this,arguments);const u=this._senders.indexOf(l);u!==-1&&this._senders.splice(u,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(i){this._senders=this._senders||[],n.apply(this,[i]),i.getTracks().forEach(o=>{this._senders.push(e(this,o))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(i){this._senders=this._senders||[],r.apply(this,[i]),i.getTracks().forEach(o=>{const l=this._senders.find(u=>u.track===o);l&&this._senders.splice(this._senders.indexOf(l),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(s=>s._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function pw(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=n.apply(this,[]);return i.forEach(o=>o._pc=this),i});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=r.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>m_(o,i.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const s=n.apply(this,[]);return s.forEach(i=>i._pc=this),s}),Ms(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const s=this;return this._pc.getStats().then(i=>m_(i,s.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let s,i,o;return this.getSenders().forEach(l=>{l.track===r&&(s?o=!0:s=l)}),this.getReceivers().forEach(l=>(l.track===r&&(i?o=!0:i=l),l.track===r)),o||s&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):s?s.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function mw(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,l){if(!l)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const u=e.apply(this,arguments);return this._shimmedLocalStreams[l.id]?this._shimmedLocalStreams[l.id].indexOf(u)===-1&&this._shimmedLocalStreams[l.id].push(u):this._shimmedLocalStreams[l.id]=[l,u],u};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(c=>{if(this.getSenders().find(p=>p.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const l=this.getSenders();n.apply(this,arguments);const u=this.getSenders().filter(c=>l.indexOf(c)===-1);this._shimmedLocalStreams[o.id]=[o].concat(u)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],r.apply(this,arguments)};const s=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(l=>{const u=this._shimmedLocalStreams[l].indexOf(o);u!==-1&&this._shimmedLocalStreams[l].splice(u,1),this._shimmedLocalStreams[l].length===1&&delete this._shimmedLocalStreams[l]}),s.apply(this,arguments)}}function gw(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return mw(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const d=n.apply(this);return this._reverseStreams=this._reverseStreams||{},d.map(p=>this._reverseStreams[p.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(d){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},d.getTracks().forEach(p=>{if(this.getSenders().find(v=>v.track===p))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[d.id]){const p=new t.MediaStream(d.getTracks());this._streams[d.id]=p,this._reverseStreams[p.id]=d,d=p}r.apply(this,[d])};const s=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(d){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[d.id]||d]),delete this._reverseStreams[this._streams[d.id]?this._streams[d.id].id:d.id],delete this._streams[d.id]},t.RTCPeerConnection.prototype.addTrack=function(d,p){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const m=[].slice.call(arguments,1);if(m.length!==1||!m[0].getTracks().find(b=>b===d))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(b=>b.track===d))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const R=this._streams[p.id];if(R)R.addTrack(d),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const b=new t.MediaStream([d]);this._streams[p.id]=b,this._reverseStreams[b.id]=p,this.addStream(b)}return this.getSenders().find(b=>b.track===d)};function i(c,d){let p=d.sdp;return Object.keys(c._reverseStreams||[]).forEach(m=>{const v=c._reverseStreams[m],R=c._streams[v.id];p=p.replace(new RegExp(R.id,"g"),v.id)}),new RTCSessionDescription({type:d.type,sdp:p})}function o(c,d){let p=d.sdp;return Object.keys(c._reverseStreams||[]).forEach(m=>{const v=c._reverseStreams[m],R=c._streams[v.id];p=p.replace(new RegExp(v.id,"g"),R.id)}),new RTCSessionDescription({type:d.type,sdp:p})}["createOffer","createAnswer"].forEach(function(c){const d=t.RTCPeerConnection.prototype[c],p={[c](){const m=arguments;return arguments.length&&typeof arguments[0]=="function"?d.apply(this,[R=>{const b=i(this,R);m[0].apply(null,[b])},R=>{m[1]&&m[1].apply(null,R)},arguments[2]]):d.apply(this,arguments).then(R=>i(this,R))}};t.RTCPeerConnection.prototype[c]=p[c]});const l=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?l.apply(this,arguments):(arguments[0]=o(this,arguments[0]),l.apply(this,arguments))};const u=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const c=u.get.apply(this);return c.type===""?c:i(this,c)}}),t.RTCPeerConnection.prototype.removeTrack=function(d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!d._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(d._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let m;Object.keys(this._streams).forEach(v=>{this._streams[v].getTracks().find(b=>d.track===b)&&(m=this._streams[v])}),m&&(m.getTracks().length===1?this.removeStream(this._reverseStreams[m.id]):m.removeTrack(d.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Ph(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],s={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=s[n]})}function yw(t,e){Ms(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}const y_=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:yw,shimAddTrackRemoveTrack:gw,shimAddTrackRemoveTrackWithNative:mw,shimGetSendersWithDtmf:fw,shimGetUserMedia:cw,shimMediaStream:dw,shimOnTrack:hw,shimPeerConnection:Ph,shimSenderReceiverGetStats:pw},Symbol.toStringTag,{value:"Module"}));function _w(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(s,i,o){zp("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(s).then(i,o)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const s=function(o,l,u){l in o&&!(u in o)&&(o[u]=o[l],delete o[l])},i=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),s(o.audio,"autoGainControl","mozAutoGainControl"),s(o.audio,"noiseSuppression","mozNoiseSuppression")),i(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const l=o.apply(this,arguments);return s(l,"mozAutoGainControl","autoGainControl"),s(l,"mozNoiseSuppression","noiseSuppression"),l}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(l){return this.kind==="audio"&&typeof l=="object"&&(l=JSON.parse(JSON.stringify(l)),s(l,"autoGainControl","mozAutoGainControl"),s(l,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[l])}}}}function wP(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const s=new DOMException("getDisplayMedia without video constraints is undefined");return s.name="NotFoundError",s.code=8,Promise.reject(s)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function vw(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Nh(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(s){const i=t.RTCPeerConnection.prototype[s],o={[s](){return arguments[0]=new(s==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[s]=o[s]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[i,o,l]=arguments;return r.apply(this,[i||null]).then(u=>{if(e.version<53&&!o)try{u.forEach(c=>{c.type=n[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;u.forEach((d,p)=>{u.set(p,Object.assign({},d,{type:n[d.type]||d.type}))})}return u}).then(o,l)}}function Ew(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=e.apply(this,[]);return s.forEach(i=>i._pc=this),s});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=n.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Tw(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(s=>s._pc=this),r}),Ms(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function ww(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){zp("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function Sw(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function Cw(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const s=r.length>0;s&&r.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const i=e.apply(this,arguments);if(s){const{sender:o}=i,l=o.getParameters();(!("encodings"in l)||l.encodings.length===1&&Object.keys(l.encodings[0]).length===0)&&(l.encodings=r,o.sendEncodings=r,this.setParametersPromises.push(o.setParameters(l).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return i})}function Iw(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function Rw(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function xw(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const __=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:Cw,shimCreateAnswer:xw,shimCreateOffer:Rw,shimGetDisplayMedia:wP,shimGetParameters:Iw,shimGetUserMedia:_w,shimOnTrack:vw,shimPeerConnection:Nh,shimRTCDataChannel:Sw,shimReceiverGetStats:Tw,shimRemoveStream:ww,shimSenderGetStats:Ew},Symbol.toStringTag,{value:"Module"}));function kw(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(s=>e.call(this,s,r)),r.getVideoTracks().forEach(s=>e.call(this,s,r))},t.RTCPeerConnection.prototype.addTrack=function(r,...s){return s&&s.forEach(i=>{this._localStreams?this._localStreams.includes(i)||this._localStreams.push(i):this._localStreams=[i]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const s=n.getTracks();this.getSenders().forEach(i=>{s.includes(i.track)&&this.removeTrack(i)})})}}function Aw(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(s=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(s))return;this._remoteStreams.push(s);const i=new Event("addstream");i.stream=s,this.dispatchEvent(i)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(i=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(i)>=0)return;r._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,r.dispatchEvent(o)})}),e.apply(r,arguments)}}}function bw(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,s=e.setLocalDescription,i=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(c,d){const p=arguments.length>=2?arguments[2]:arguments[0],m=n.apply(this,[p]);return d?(m.then(c,d),Promise.resolve()):m},e.createAnswer=function(c,d){const p=arguments.length>=2?arguments[2]:arguments[0],m=r.apply(this,[p]);return d?(m.then(c,d),Promise.resolve()):m};let l=function(u,c,d){const p=s.apply(this,[u]);return d?(p.then(c,d),Promise.resolve()):p};e.setLocalDescription=l,l=function(u,c,d){const p=i.apply(this,[u]);return d?(p.then(c,d),Promise.resolve()):p},e.setRemoteDescription=l,l=function(u,c,d){const p=o.apply(this,[u]);return d?(p.then(c,d),Promise.resolve()):p},e.addIceCandidate=l}function Pw(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=s=>r(Nw(s))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,s,i){e.mediaDevices.getUserMedia(r).then(s,i)}).bind(e))}function Nw(t){return t&&t.video!==void 0?Object.assign({},t,{video:uw(t.video)}):t}function Dw(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,s){if(r&&r.iceServers){const i=[];for(let o=0;o<r.iceServers.length;o++){let l=r.iceServers[o];l.urls===void 0&&l.url?(zp("RTCIceServer.url","RTCIceServer.urls"),l=JSON.parse(JSON.stringify(l)),l.urls=l.url,delete l.url,i.push(l)):i.push(r.iceServers[o])}r.iceServers=i}return new e(r,s)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function Vw(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Mw(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const s=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveAudio===!0&&!s&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const i=this.getTransceivers().find(o=>o.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveVideo===!0&&!i&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function Ow(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}const v_=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:Ow,shimCallbacksAPI:bw,shimConstraints:Nw,shimCreateOfferLegacy:Mw,shimGetUserMedia:Pw,shimLocalStreamsAPI:kw,shimRTCIceServerUrls:Dw,shimRemoteStreamsAPI:Aw,shimTrackEventTransceiver:Vw},Symbol.toStringTag,{value:"Module"}));var Lw={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((s,i)=>(i>0?"m="+s:s).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(s=>s.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const s={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let i=8;i<r.length;i+=2)switch(r[i]){case"raddr":s.relatedAddress=r[i+1];break;case"rport":s.relatedPort=parseInt(r[i+1],10);break;case"tcptype":s.tcpType=r[i+1];break;case"ufrag":s.ufrag=r[i+1],s.usernameFragment=r[i+1];break;default:s[r[i]]===void 0&&(s[r[i]]=r[i+1]);break}return s},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const s=n.component;s==="rtp"?r.push(1):s==="rtcp"?r.push(2):r.push(s),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const i=n.type;return r.push("typ"),r.push(i),i!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const s={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),s.name=r[0],s.clockRate=parseInt(r[1],10),s.channels=r.length===3?parseInt(r[2],10):1,s.numChannels=s.channels,s},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const s=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(s!==1?"/"+s:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let s;const i=n.substring(n.indexOf(" ")+1).split(";");for(let o=0;o<i.length;o++)s=i[o].trim().split("="),r[s[0].trim()]=s[1];return r},e.writeFmtp=function(n){let r="",s=n.payloadType;if(n.preferredPayloadType!==void 0&&(s=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const i=[];Object.keys(n.parameters).forEach(o=>{n.parameters[o]!==void 0?i.push(o+"="+n.parameters[o]):i.push(o)}),r+="a=fmtp:"+s+" "+i.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",s=n.payloadType;return n.preferredPayloadType!==void 0&&(s=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(i=>{r+="a=rtcp-fb:"+s+" "+i.type+(i.parameter&&i.parameter.length?" "+i.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),s={ssrc:parseInt(n.substring(7,r),10)},i=n.indexOf(":",r);return i>-1?(s.attribute=n.substring(r+1,i),s.value=n.substring(i+1)):s.attribute=n.substring(r+1),s},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(s=>parseInt(s,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let s="a=setup:"+r+`\r
`;return n.fingerprints.forEach(i=>{s+="a=fingerprint:"+i.algorithm+" "+i.value+`\r
`}),s},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const s=e.matchPrefix(n+r,"a=ice-ufrag:")[0],i=e.matchPrefix(n+r,"a=ice-pwd:")[0];return s&&i?{usernameFragment:s.substring(12),password:i.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=e.splitLines(n)[0].split(" ");r.profile=i[2];for(let l=3;l<i.length;l++){const u=i[l],c=e.matchPrefix(n,"a=rtpmap:"+u+" ")[0];if(c){const d=e.parseRtpMap(c),p=e.matchPrefix(n,"a=fmtp:"+u+" ");switch(d.parameters=p.length?e.parseFmtp(p[0]):{},d.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+u+" ").map(e.parseRtcpFb),r.codecs.push(d),d.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(d.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(l=>{r.headerExtensions.push(e.parseExtmap(l))});const o=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(l=>{o.forEach(u=>{l.rtcpFeedback.find(d=>d.type===u.type&&d.parameter===u.parameter)||l.rtcpFeedback.push(u)})}),r},e.writeRtpDescription=function(n,r){let s="";s+="m="+n+" ",s+=r.codecs.length>0?"9":"0",s+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",s+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,s+=`c=IN IP4 0.0.0.0\r
`,s+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{s+=e.writeRtpMap(o),s+=e.writeFmtp(o),s+=e.writeRtcpFb(o)});let i=0;return r.codecs.forEach(o=>{o.maxptime>i&&(i=o.maxptime)}),i>0&&(s+="a=maxptime:"+i+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{s+=e.writeExtmap(o)}),s},e.parseRtpEncodingParameters=function(n){const r=[],s=e.parseRtpParameters(n),i=s.fecMechanisms.indexOf("RED")!==-1,o=s.fecMechanisms.indexOf("ULPFEC")!==-1,l=e.matchPrefix(n,"a=ssrc:").map(m=>e.parseSsrcMedia(m)).filter(m=>m.attribute==="cname"),u=l.length>0&&l[0].ssrc;let c;const d=e.matchPrefix(n,"a=ssrc-group:FID").map(m=>m.substring(17).split(" ").map(R=>parseInt(R,10)));d.length>0&&d[0].length>1&&d[0][0]===u&&(c=d[0][1]),s.codecs.forEach(m=>{if(m.name.toUpperCase()==="RTX"&&m.parameters.apt){let v={ssrc:u,codecPayloadType:parseInt(m.parameters.apt,10)};u&&c&&(v.rtx={ssrc:c}),r.push(v),i&&(v=JSON.parse(JSON.stringify(v)),v.fec={ssrc:u,mechanism:o?"red+ulpfec":"red"},r.push(v))}}),r.length===0&&u&&r.push({ssrc:u});let p=e.matchPrefix(n,"b=");return p.length&&(p[0].indexOf("b=TIAS:")===0?p=parseInt(p[0].substring(7),10):p[0].indexOf("b=AS:")===0?p=parseInt(p[0].substring(5),10)*1e3*.95-50*40*8:p=void 0,r.forEach(m=>{m.maxBitrate=p})),r},e.parseRtcpParameters=function(n){const r={},s=e.matchPrefix(n,"a=ssrc:").map(l=>e.parseSsrcMedia(l)).filter(l=>l.attribute==="cname")[0];s&&(r.cname=s.value,r.ssrc=s.ssrc);const i=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=i.length>0,r.compound=i.length===0;const o=e.matchPrefix(n,"a=rtcp-mux");return r.mux=o.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const s=e.matchPrefix(n,"a=msid:");if(s.length===1)return r=s[0].substring(7).split(" "),{stream:r[0],track:r[1]};const i=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(i.length>0)return r=i[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),s=e.matchPrefix(n,"a=max-message-size:");let i;s.length>0&&(i=parseInt(s[0].substring(19),10)),isNaN(i)&&(i=65536);const o=e.matchPrefix(n,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:i};const l=e.matchPrefix(n,"a=sctpmap:");if(l.length>0){const u=l[0].substring(10).split(" ");return{port:parseInt(u[0],10),protocol:u[1],maxMessageSize:i}}},e.writeSctpDescription=function(n,r){let s=[];return n.protocol!=="DTLS/SCTP"?s=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:s=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&s.push("a=max-message-size:"+r.maxMessageSize+`\r
`),s.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,s){let i;const o=r!==void 0?r:2;return n?i=n:i=e.generateSessionId(),`v=0\r
o=`+(s||"thisisadapterortc")+" "+i+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const s=e.splitLines(n);for(let i=0;i<s.length;i++)switch(s[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return s[i].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const s=e.splitLines(n)[0].substring(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},e.parseOLine=function(n){const s=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let s=0;s<r.length;s++)if(r[s].length<2||r[s].charAt(1)!=="=")return!1;return!0},t.exports=e})(Lw);var jw=Lw.exports;const mi=k_(jw),SP=TS({__proto__:null,default:mi},[jw]);function Nl(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const s=new e(r),i=mi.parseCandidate(r.candidate);for(const o in i)o in s||Object.defineProperty(s,o,{value:i[o]});return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,Ms(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function Dh(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Ms(t,"icecandidate",e=>{if(e.candidate){const n=mi.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Dl(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(l){if(!l||!l.sdp)return!1;const u=mi.splitSections(l.sdp);return u.shift(),u.some(c=>{const d=mi.parseMLine(c);return d&&d.kind==="application"&&d.protocol.indexOf("SCTP")!==-1})},r=function(l){const u=l.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(u===null||u.length<2)return-1;const c=parseInt(u[1],10);return c!==c?-1:c},s=function(l){let u=65536;return e.browser==="firefox"&&(e.version<57?l===-1?u=16384:u=2147483637:e.version<60?u=e.version===57?65535:65536:u=2147483637),u},i=function(l,u){let c=65536;e.browser==="firefox"&&e.version===57&&(c=65535);const d=mi.matchPrefix(l.sdp,"a=max-message-size:");return d.length>0?c=parseInt(d[0].substring(19),10):e.browser==="firefox"&&u!==-1&&(c=2147483637),c},o=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:u}=this.getConfiguration();u==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const u=r(arguments[0]),c=s(u),d=i(arguments[0],u);let p;c===0&&d===0?p=Number.POSITIVE_INFINITY:c===0||d===0?p=Math.max(c,d):p=Math.min(c,d);const m={};Object.defineProperty(m,"maxMessageSize",{get(){return p}}),this._sctp=m}return o.apply(this,arguments)}}function Vl(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,s){const i=r.send;r.send=function(){const l=arguments[0],u=l.length||l.size||l.byteLength;if(r.readyState==="open"&&s.sctp&&u>s.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+s.sctp.maxMessageSize+" bytes)");return i.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const s=n.apply(this,arguments);return e(s,this),s},Ms(t,"datachannel",r=>(e(r.channel,r.target),r))}function Vh(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=s=>{const i=s.target;if(i._lastConnectionState!==i.connectionState){i._lastConnectionState=i.connectionState;const o=new Event("connectionstatechange",s);i.dispatchEvent(o)}return s},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Mh(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(s){if(s&&s.sdp&&s.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const i=s.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&s instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:s.type,sdp:i}):s.sdp=i}return n.apply(this,arguments)}}function Ml(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Ol(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let s=arguments[0]||{};if(typeof s!="object"||s.type&&s.sdp)return n.apply(this,arguments);if(s={type:s.type,sdp:s.sdp},!s.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":s.type="offer";break;default:s.type="answer";break}return s.sdp||s.type!=="offer"&&s.type!=="answer"?n.apply(this,[s]):(s.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>n.apply(this,[o]))})}const CP=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:Mh,shimAddIceCandidateNullOrEmpty:Ml,shimConnectionState:Vh,shimMaxMessageSize:Dl,shimParameterlessSetLocalDescription:Ol,shimRTCIceCandidate:Nl,shimRTCIceCandidateRelayProtocol:Dh,shimSendThrowTypeError:Vl},Symbol.toStringTag,{value:"Module"}));function IP({window:t}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=lw,r=TP(t),s={browserDetails:r,commonShim:CP,extractVersion:yo,disableLog:vP,disableWarnings:EP,sdp:SP};switch(r.browser){case"chrome":if(!y_||!Ph||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),s;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),s;n("adapter.js shimming chrome."),s.browserShim=y_,Ml(t,r),Ol(t),cw(t,r),dw(t),Ph(t,r),hw(t),gw(t,r),fw(t),pw(t),yw(t,r),Nl(t),Dh(t),Vh(t),Dl(t,r),Vl(t),Mh(t,r);break;case"firefox":if(!__||!Nh||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),s;n("adapter.js shimming firefox."),s.browserShim=__,Ml(t,r),Ol(t),_w(t,r),Nh(t,r),vw(t),ww(t),Ew(t),Tw(t),Sw(t),Cw(t),Iw(t),Rw(t),xw(t),Nl(t),Vh(t),Dl(t,r),Vl(t);break;case"safari":if(!v_||!e.shimSafari)return n("Safari shim is not included in this adapter release."),s;n("adapter.js shimming safari."),s.browserShim=v_,Ml(t,r),Ol(t),Dw(t),Mw(t),bw(t),kw(t),Aw(t),Vw(t),Pw(t),Ow(t),Nl(t),Dh(t),Dl(t,r),Vl(t),Mh(t,r);break;default:n("Unsupported browser!");break}return s}const E_=IP({window:typeof window>"u"?void 0:window});function Os(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}class Fw{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const n=[],r=e.byteLength,s=Math.ceil(r/this.chunkedMTU);let i=0,o=0;for(;o<r;){const l=Math.min(r,o+this.chunkedMTU),u=e.slice(o,l),c={__peerData:this._dataCount,n:i,data:u,total:s};n.push(c),o=l,i++}return this._dataCount++,n}}}function RP(t){let e=0;for(const s of t)e+=s.byteLength;const n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.byteLength;return n}const fd=E_.default||E_,oo=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const t=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(t)?t==="chrome"?e>=this.minChromeVersion:t==="firefox"?e>=this.minFirefoxVersion:t==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return fd.browserDetails.browser}getVersion(){return fd.browserDetails.version||0}isUnifiedPlanSupported(){const t=this.getBrowser(),e=fd.browserDetails.version||0;if(t==="chrome"&&e<this.minChromeVersion)return!1;if(t==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let n,r=!1;try{n=new RTCPeerConnection,n.addTransceiver("audio"),r=!0}catch{}finally{n&&n.close()}return r}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},xP=t=>!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(t),Bw=()=>Math.random().toString(36).slice(2),T_={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class kP extends Fw{noop(){}blobToArrayBuffer(e,n){const r=new FileReader;return r.onload=function(s){s.target&&n(s.target.result)},r.readAsArrayBuffer(e),r}binaryStringToArrayBuffer(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r)&255;return n.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=T_,this.browser=oo.getBrowser(),this.browserVersion=oo.getVersion(),this.pack=iw,this.unpack=sw,this.supports=function(){const n={browser:oo.isBrowserSupported(),webRTC:oo.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!n.webRTC)return n;let r;try{r=new RTCPeerConnection(T_),n.audioVideo=!0;let s;try{s=r.createDataChannel("_PEERJSTEST",{ordered:!0}),n.data=!0,n.reliable=!!s.ordered;try{s.binaryType="blob",n.binaryBlob=!oo.isIOS}catch{}}catch{}finally{s&&s.close()}}catch{}finally{r&&r.close()}return n}(),this.validateId=xP,this.randomToken=Bw}}const Bt=new kP,AP="PeerJS: ";class bP{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...n){const r=[AP,...n];for(const s in r)r[s]instanceof Error&&(r[s]="("+r[s].name+") "+r[s].message);e>=3?console.log(...r):e>=2?console.warn("WARNING",...r):e>=1&&console.error("ERROR",...r)}constructor(){this._logLevel=0}}var ee=new bP,qp={},PP=Object.prototype.hasOwnProperty,Ot="~";function da(){}Object.create&&(da.prototype=Object.create(null),new da().__proto__||(Ot=!1));function NP(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function Uw(t,e,n,r,s){if(typeof n!="function")throw new TypeError("The listener must be a function");var i=new NP(n,r||t,s),o=Ot?Ot+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],i]:t._events[o].push(i):(t._events[o]=i,t._eventsCount++),t}function Ll(t,e){--t._eventsCount===0?t._events=new da:delete t._events[e]}function kt(){this._events=new da,this._eventsCount=0}kt.prototype.eventNames=function(){var e=[],n,r;if(this._eventsCount===0)return e;for(r in n=this._events)PP.call(n,r)&&e.push(Ot?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(n)):e};kt.prototype.listeners=function(e){var n=Ot?Ot+e:e,r=this._events[n];if(!r)return[];if(r.fn)return[r.fn];for(var s=0,i=r.length,o=new Array(i);s<i;s++)o[s]=r[s].fn;return o};kt.prototype.listenerCount=function(e){var n=Ot?Ot+e:e,r=this._events[n];return r?r.fn?1:r.length:0};kt.prototype.emit=function(e,n,r,s,i,o){var l=Ot?Ot+e:e;if(!this._events[l])return!1;var u=this._events[l],c=arguments.length,d,p;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,n),!0;case 3:return u.fn.call(u.context,n,r),!0;case 4:return u.fn.call(u.context,n,r,s),!0;case 5:return u.fn.call(u.context,n,r,s,i),!0;case 6:return u.fn.call(u.context,n,r,s,i,o),!0}for(p=1,d=new Array(c-1);p<c;p++)d[p-1]=arguments[p];u.fn.apply(u.context,d)}else{var m=u.length,v;for(p=0;p<m;p++)switch(u[p].once&&this.removeListener(e,u[p].fn,void 0,!0),c){case 1:u[p].fn.call(u[p].context);break;case 2:u[p].fn.call(u[p].context,n);break;case 3:u[p].fn.call(u[p].context,n,r);break;case 4:u[p].fn.call(u[p].context,n,r,s);break;default:if(!d)for(v=1,d=new Array(c-1);v<c;v++)d[v-1]=arguments[v];u[p].fn.apply(u[p].context,d)}}return!0};kt.prototype.on=function(e,n,r){return Uw(this,e,n,r,!1)};kt.prototype.once=function(e,n,r){return Uw(this,e,n,r,!0)};kt.prototype.removeListener=function(e,n,r,s){var i=Ot?Ot+e:e;if(!this._events[i])return this;if(!n)return Ll(this,i),this;var o=this._events[i];if(o.fn)o.fn===n&&(!s||o.once)&&(!r||o.context===r)&&Ll(this,i);else{for(var l=0,u=[],c=o.length;l<c;l++)(o[l].fn!==n||s&&!o[l].once||r&&o[l].context!==r)&&u.push(o[l]);u.length?this._events[i]=u.length===1?u[0]:u:Ll(this,i)}return this};kt.prototype.removeAllListeners=function(e){var n;return e?(n=Ot?Ot+e:e,this._events[n]&&Ll(this,n)):(this._events=new da,this._eventsCount=0),this};kt.prototype.off=kt.prototype.removeListener;kt.prototype.addListener=kt.prototype.on;kt.prefixed=Ot;kt.EventEmitter=kt;qp=kt;var Ls={};Os(Ls,"ConnectionType",()=>jr);Os(Ls,"PeerErrorType",()=>Ye);Os(Ls,"BaseConnectionErrorType",()=>Oh);Os(Ls,"DataConnectionErrorType",()=>Wp);Os(Ls,"SerializationType",()=>mc);Os(Ls,"SocketEventType",()=>Cr);Os(Ls,"ServerMessageType",()=>It);var jr=function(t){return t.Data="data",t.Media="media",t}({}),Ye=function(t){return t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc",t}({}),Oh=function(t){return t.NegotiationFailed="negotiation-failed",t.ConnectionClosed="connection-closed",t}({}),Wp=function(t){return t.NotOpenYet="not-open-yet",t.MessageToBig="message-too-big",t}({}),mc=function(t){return t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json",t.None="raw",t}({}),Cr=function(t){return t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close",t}({}),It=function(t){return t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE",t}({});const $w="1.5.5";class DP extends qp.EventEmitter{constructor(e,n,r,s,i,o=5e3){super(),this.pingInterval=o,this._disconnected=!0,this._messagesQueue=[];const l=e?"wss://":"ws://";this._baseUrl=l+n+":"+r+s+"peerjs?key="+i}start(e,n){this._id=e;const r=`${this._baseUrl}&id=${e}&token=${n}`;this._socket||!this._disconnected||(this._socket=new WebSocket(r+"&version="+$w),this._disconnected=!1,this._socket.onmessage=s=>{let i;try{i=JSON.parse(s.data),ee.log("Server message received:",i)}catch{ee.log("Invalid server message",s.data);return}this.emit(Cr.Message,i)},this._socket.onclose=s=>{this._disconnected||(ee.log("Socket closed.",s),this._cleanup(),this._disconnected=!0,this.emit(Cr.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),ee.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){ee.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:It.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const n of e)this.send(n)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(Cr.Error,"Invalid message");return}if(!this._wsOpen())return;const n=JSON.stringify(e);this._socket.send(n)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class zw{constructor(e){this.connection=e}startConnection(e){const n=this._startPeerConnection();if(this.connection.peerConnection=n,this.connection.type===jr.Media&&e._stream&&this._addTracksToConnection(e._stream,n),e.originator){const r=this.connection,s={ordered:!!e.reliable},i=n.createDataChannel(r.label,s);r._initializeDataChannel(i),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){ee.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const n=this.connection.peer,r=this.connection.connectionId,s=this.connection.type,i=this.connection.provider;ee.log("Listening for ICE candidates."),e.onicecandidate=o=>{!o.candidate||!o.candidate.candidate||(ee.log(`Received ICE candidates for ${n}:`,o.candidate),i.socket.send({type:It.Candidate,payload:{candidate:o.candidate,type:s,connectionId:r},dst:n}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":ee.log("iceConnectionState is failed, closing connections to "+n),this.connection.emitError(Oh.NegotiationFailed,"Negotiation of connection to "+n+" failed."),this.connection.close();break;case"closed":ee.log("iceConnectionState is closed, closing connections to "+n),this.connection.emitError(Oh.ConnectionClosed,"Connection to "+n+" closed."),this.connection.close();break;case"disconnected":ee.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},ee.log("Listening for data channel"),e.ondatachannel=o=>{ee.log("Received data channel");const l=o.channel;i.getConnection(n,r)._initializeDataChannel(l)},ee.log("Listening for remote stream"),e.ontrack=o=>{ee.log("Received remote stream");const l=o.streams[0],u=i.getConnection(n,r);if(u.type===jr.Media){const c=u;this._addStreamToMediaConnection(l,c)}}}cleanup(){ee.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const n=e.signalingState!=="closed";let r=!1;const s=this.connection.dataChannel;s&&(r=!!s.readyState&&s.readyState!=="closed"),(n||r)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,n=this.connection.provider;try{const r=await e.createOffer(this.connection.options.constraints);ee.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),ee.log("Set localDescription:",r,`for:${this.connection.peer}`);let s={sdp:r,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===jr.Data){const i=this.connection;s={...s,label:i.label,reliable:i.reliable,serialization:i.serialization}}n.socket.send({type:It.Offer,payload:s,dst:this.connection.peer})}catch(s){s!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(n.emitError(Ye.WebRTC,s),ee.log("Failed to setLocalDescription, ",s))}}catch(r){n.emitError(Ye.WebRTC,r),ee.log("Failed to createOffer, ",r)}}async _makeAnswer(){const e=this.connection.peerConnection,n=this.connection.provider;try{const r=await e.createAnswer();ee.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),ee.log("Set localDescription:",r,`for:${this.connection.peer}`),n.socket.send({type:It.Answer,payload:{sdp:r,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(s){n.emitError(Ye.WebRTC,s),ee.log("Failed to setLocalDescription, ",s)}}catch(r){n.emitError(Ye.WebRTC,r),ee.log("Failed to create answer, ",r)}}async handleSDP(e,n){n=new RTCSessionDescription(n);const r=this.connection.peerConnection,s=this.connection.provider;ee.log("Setting remote description",n);const i=this;try{await r.setRemoteDescription(n),ee.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await i._makeAnswer()}catch(o){s.emitError(Ye.WebRTC,o),ee.log("Failed to setRemoteDescription, ",o)}}async handleCandidate(e){ee.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),ee.log(`Added ICE candidate for:${this.connection.peer}`)}catch(n){this.connection.provider.emitError(Ye.WebRTC,n),ee.log("Failed to handleCandidate, ",n)}}_addTracksToConnection(e,n){if(ee.log(`add tracks from stream ${e.id} to peer connection`),!n.addTrack)return ee.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(r=>{n.addTrack(r,e)})}_addStreamToMediaConnection(e,n){ee.log(`add stream ${e.id} to media connection ${n.connectionId}`),n.addStream(e)}}class qw extends qp.EventEmitter{emitError(e,n){ee.error("Error:",n),this.emit("error",new VP(`${e}`,n))}}class VP extends Error{constructor(e,n){typeof n=="string"?super(n):(super(),Object.assign(this,n)),this.type=e}}class Ww extends qw{get open(){return this._open}constructor(e,n,r){super(),this.peer=e,this.provider=n,this.options=r,this._open=!1,this.metadata=r.metadata}}var qh;const Mo=class Mo extends Ww{get type(){return jr.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,n,r){super(e,n,r),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||Mo.ID_PREFIX+Bt.randomToken(),this._negotiator=new zw(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{ee.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{ee.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){ee.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const n=e.type,r=e.payload;switch(e.type){case It.Answer:this._negotiator.handleSDP(n,r.sdp),this._open=!0;break;case It.Candidate:this._negotiator.handleCandidate(r.candidate);break;default:ee.warn(`Unrecognized message type:${n} from peer:${this.peer}`);break}}answer(e,n={}){if(this._localStream){ee.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,n&&n.sdpTransform&&(this.options.sdpTransform=n.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const r=this.provider._getMessages(this.connectionId);for(const s of r)this.handleMessage(s);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}};qh=new WeakMap,Ji(Mo,qh,Mo.ID_PREFIX="mc_");let Ru=Mo;class MP{constructor(e){this._options=e}_buildRequest(e){const n=this._options.secure?"https":"http",{host:r,port:s,path:i,key:o}=this._options,l=new URL(`${n}://${r}:${s}${i}${o}/${e}`);return l.searchParams.set("ts",`${Date.now()}${Math.random()}`),l.searchParams.set("version",$w),fetch(l.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){ee.error("Error retrieving ID",e);let n="";throw this._options.path==="/"&&this._options.host!==Bt.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+n)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let n="";throw this._options.host===Bt.CLOUD_HOST?n="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":n="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw ee.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}var Wh,Hh;const hs=class hs extends Ww{get type(){return jr.Data}constructor(e,n,r){super(e,n,r),this.connectionId=this.options.connectionId||hs.ID_PREFIX+Bw(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new zw(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{ee.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=n=>{ee.log(`DC#${this.connectionId} dc onmessage:`,n.data)},this.dataChannel.onclose=()=>{ee.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,n=!1){if(!this.open){this.emitError(Wp.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,n)}async handleMessage(e){const n=e.payload;switch(e.type){case It.Answer:await this._negotiator.handleSDP(e.type,n.sdp);break;case It.Candidate:await this._negotiator.handleCandidate(n.candidate);break;default:ee.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}};Wh=new WeakMap,Hh=new WeakMap,Ji(hs,Wh,hs.ID_PREFIX="dc_"),Ji(hs,Hh,hs.MAX_BUFFERED_AMOUNT=8388608);let xu=hs;class Hp extends xu{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",n=>this._handleDataMessage(n))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>xu.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(n){return ee.error(`DC#:${this.connectionId} Error when sending:`,n),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class pd extends Hp{close(e){super.close(e),this._chunkedData={}}constructor(e,n,r){super(e,n,r),this.chunker=new Fw,this.serialization=mc.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const n=sw(e),r=n.__peerData;if(r){if(r.type==="close"){this.close();return}this._handleChunk(n);return}this.emit("data",n)}_handleChunk(e){const n=e.__peerData,r=this._chunkedData[n]||{data:[],count:0,total:e.total};if(r.data[e.n]=new Uint8Array(e.data),r.count++,this._chunkedData[n]=r,r.total===r.count){delete this._chunkedData[n];const s=RP(r.data);this._handleDataMessage({data:s})}}_send(e,n){const r=iw(e);if(r instanceof Promise)return this._send_blob(r);if(!n&&r.byteLength>this.chunker.chunkedMTU){this._sendChunks(r);return}this._bufferedSend(r)}async _send_blob(e){const n=await e;if(n.byteLength>this.chunker.chunkedMTU){this._sendChunks(n);return}this._bufferedSend(n)}_sendChunks(e){const n=this.chunker.chunk(e);ee.log(`DC#${this.connectionId} Try to send ${n.length} chunks...`);for(const r of n)this.send(r,!0)}}class OP extends Hp{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,n){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=mc.None}}class LP extends Hp{_handleDataMessage({data:e}){const n=this.parse(this.decoder.decode(e)),r=n.__peerData;if(r&&r.type==="close"){this.close();return}this.emit("data",n)}_send(e,n){const r=this.encoder.encode(this.stringify(e));if(r.byteLength>=Bt.chunkedMTU){this.emitError(Wp.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(r)}constructor(...e){super(...e),this.serialization=mc.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}var Gh;const Oo=class Oo extends qw{get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[n,r]of this._connections)e[n]=r;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,n){super(),this._serializers={raw:OP,json:LP,binary:pd,"binary-utf8":pd,default:pd},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let r;if(e&&e.constructor==Object?n=e:e&&(r=e.toString()),n={debug:0,host:Bt.CLOUD_HOST,port:Bt.CLOUD_PORT,path:"/",key:Oo.DEFAULT_KEY,token:Bt.randomToken(),config:Bt.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...n},this._options=n,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Bt.CLOUD_HOST?this._options.secure=Bt.isSecure():this._options.host==Bt.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&ee.setLogFunction(this._options.logFunction),ee.logLevel=this._options.debug||0,this._api=new MP(n),this._socket=this._createServerConnection(),!Bt.supports.audioVideo&&!Bt.supports.data){this._delayedAbort(Ye.BrowserIncompatible,"The current browser does not support WebRTC");return}if(r&&!Bt.validateId(r)){this._delayedAbort(Ye.InvalidID,`ID "${r}" is invalid`);return}r?this._initialize(r):this._api.retrieveId().then(s=>this._initialize(s)).catch(s=>this._abort(Ye.ServerError,s))}_createServerConnection(){const e=new DP(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(Cr.Message,n=>{this._handleMessage(n)}),e.on(Cr.Error,n=>{this._abort(Ye.SocketError,n)}),e.on(Cr.Disconnected,()=>{this.disconnected||(this.emitError(Ye.Network,"Lost connection to server."),this.disconnect())}),e.on(Cr.Close,()=>{this.disconnected||this._abort(Ye.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const n=e.type,r=e.payload,s=e.src;switch(n){case It.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case It.Error:this._abort(Ye.ServerError,r.msg);break;case It.IdTaken:this._abort(Ye.UnavailableID,`ID "${this.id}" is taken`);break;case It.InvalidKey:this._abort(Ye.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case It.Leave:ee.log(`Received leave message from ${s}`),this._cleanupPeer(s),this._connections.delete(s);break;case It.Expire:this.emitError(Ye.PeerUnavailable,`Could not connect to peer ${s}`);break;case It.Offer:{const i=r.connectionId;let o=this.getConnection(s,i);if(o&&(o.close(),ee.warn(`Offer received for existing Connection ID:${i}`)),r.type===jr.Media){const u=new Ru(s,this,{connectionId:i,_payload:r,metadata:r.metadata});o=u,this._addConnection(s,o),this.emit("call",u)}else if(r.type===jr.Data){const u=new this._serializers[r.serialization](s,this,{connectionId:i,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable});o=u,this._addConnection(s,o),this.emit("connection",u)}else{ee.warn(`Received malformed connection type:${r.type}`);return}const l=this._getMessages(i);for(const u of l)o.handleMessage(u);break}default:{if(!r){ee.warn(`You received a malformed message from ${s} of type ${n}`);return}const i=r.connectionId,o=this.getConnection(s,i);o&&o.peerConnection?o.handleMessage(e):i?this._storeMessage(i,e):ee.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,n){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(n)}_getMessages(e){const n=this._lostMessages.get(e);return n?(this._lostMessages.delete(e),n):[]}connect(e,n={}){if(n={serialization:"default",...n},this.disconnected){ee.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(Ye.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const r=new this._serializers[n.serialization](e,this,n);return this._addConnection(e,r),r}call(e,n,r={}){if(this.disconnected){ee.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(Ye.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!n){ee.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const s=new Ru(e,this,{...r,_stream:n});return this._addConnection(e,s),s}_addConnection(e,n){ee.log(`add connection ${n.type}:${n.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(n)}_removeConnection(e){const n=this._connections.get(e.peer);if(n){const r=n.indexOf(e);r!==-1&&n.splice(r,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,n){const r=this._connections.get(e);if(!r)return null;for(const s of r)if(s.connectionId===n)return s;return null}_delayedAbort(e,n){setTimeout(()=>{this._abort(e,n)},0)}_abort(e,n){ee.error("Aborting!"),this.emitError(e,n),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(ee.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const n=this._connections.get(e);if(n)for(const r of n)r.close()}disconnect(){if(this.disconnected)return;const e=this.id;ee.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)ee.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)ee.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=n=>{}){this._api.listAllPeers().then(n=>e(n)).catch(n=>this._abort(Ye.ServerError,n))}};Gh=new WeakMap,Ji(Oo,Gh,Oo.DEFAULT_KEY="peerjs");let Lh=Oo;var jP=Lh;const FP=(t,e,n)=>`voice-${t}-${e}-${n}`,BP=({auctionId:t,clientId:e,scope:n,listenOnly:r=!1,autoJoin:s=!1})=>{const[i,o]=D.useState(!1),[l,u]=D.useState(!1),[c,d]=D.useState(null),[p,m]=D.useState([]),v=D.useRef(null),R=D.useRef(null),b=D.useRef(null),V=D.useRef(null),w=D.useRef(new Map),E=D.useRef(r),x=D.useCallback(()=>{m([]),w.current.forEach(k=>{try{k.close()}catch{}}),w.current.clear()},[]),L=D.useCallback(()=>{var k;(k=V.current)==null||k.call(V),V.current=null,v.current&&(v.current.destroy(),v.current=null),R.current&&(R.current.getTracks().forEach(T=>T.stop()),R.current=null),x()},[x]),z=D.useCallback(async()=>{const k=b.current;if(b.current=null,!!k)try{await OA(k)}catch{}},[]),B=D.useCallback((k,T)=>{m(oe=>oe.some(ne=>ne.peerId===k)?oe.map(ne=>ne.peerId===k?{...ne,stream:T}:ne):[...oe,{peerId:k,stream:T}])},[]),S=D.useCallback(k=>{m(T=>{const oe=T.filter(G=>G.peerId!==k);return oe.length===T.length?T:oe}),w.current.delete(k)},[]),_=D.useCallback(k=>{const T=k.peerConnection;if(!T)return;const oe=()=>{T.getSenders().filter(G=>{var ne;return((ne=G.track)==null?void 0:ne.kind)==="audio"}).forEach(G=>{const ne=G.getParameters();(!ne.encodings||!ne.encodings.length)&&(ne.encodings=[{}]),ne.encodings[0].maxBitrate=128e3,G.setParameters(ne).catch(()=>{})})};oe(),T.addEventListener("negotiationneeded",oe)},[]),C=D.useCallback((k,T)=>{_(k),w.current.set(T,k),k.on("stream",oe=>B(T,oe)),k.on("close",()=>S(T)),k.on("error",()=>S(T))},[B,S,_]),I=D.useCallback(async()=>{!v.current&&!R.current&&!b.current||(o(!1),L(),await z())},[z,L]),A=D.useCallback(async()=>{var k;if(!(l||i)){if(!t||!e){d("Join an auction before using voice chat.");return}if(!(typeof window>"u")){if(!r&&!((k=navigator==null?void 0:navigator.mediaDevices)!=null&&k.getUserMedia)){d("Browser does not support microphone access.");return}u(!0),d(null);try{const T={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,channelCount:2,sampleRate:48e3};if(r)R.current=null;else{const H=await navigator.mediaDevices.getUserMedia({audio:T});H.getAudioTracks().forEach(ce=>{ce.applyConstraints(T).catch(()=>{})}),R.current=H}const oe=FP(t,n,e),G=new jP(oe,{config:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}]}});v.current=G,await new Promise((H,ce)=>{G.once("open",()=>H()),G.once("error",le=>ce(le))}),G.on("error",()=>{d("Voice connection lost."),I()}),G.on("call",H=>{if(w.current.has(H.peer)){H.close();return}H.answer(R.current??void 0),C(H,H.peer)});const ne=Gt(Ce,"auctions",t,"voicePresence"),fe=`${n}-${e}`,$=Oe(ne,fe);b.current=$,await DT($,{peerId:oe,clientId:e,scope:n,listenOnly:r,joinedAt:Ke()});const te=H=>{if(r||!v.current||!R.current||H===oe||w.current.has(H))return;const ce=v.current.call(H,R.current);ce&&C(ce,H)};V.current=Su(Aa(ne,lc("scope","==",n)),H=>{const ce=H.docs.map(de=>de.data()).filter(de=>de.clientId!==e),le=new Set(ce.map(de=>de.peerId));Array.from(w.current.keys()).forEach(de=>{if(!le.has(de)){const $e=w.current.get(de);$e&&$e.close(),S(de)}}),ce.forEach(de=>te(de.peerId))}),o(!0)}catch(T){const oe=T instanceof Error?T.message:"Unable to join the voice channel.";d(oe),L(),await z()}finally{u(!1)}}}},[t,C,e,i,l,I,z,S,n,L,r]);return D.useEffect(()=>()=>{I()},[I]),D.useEffect(()=>{!t&&i&&I()},[t,i,I]),D.useEffect(()=>{s&&(i||l||A())},[s,i,l,A]),D.useEffect(()=>{if(E.current!==r&&(E.current=r,!(!t||!e))){if(!v.current){s&&A();return}(async()=>(await I(),s&&await A()))()}},[r,s,t,e,A,I]),D.useEffect(()=>{if(typeof window>"u")return;const k=()=>{I()};return window.addEventListener("beforeunload",k),window.addEventListener("pagehide",k),()=>{window.removeEventListener("beforeunload",k),window.removeEventListener("pagehide",k)}},[I]),{connected:i,connecting:l,error:c,remoteStreams:p,join:A,leave:I,toggle:()=>{i?I():A()}}};let ao=null;const jh=()=>{if(typeof window>"u")return null;const t=window.AudioContext||window.webkitAudioContext;return t?(ao||(ao=new t),ao.state==="suspended"&&ao.resume(),ao):null},Hw=async t=>{try{const e=await fetch("/.netlify/functions/announce",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t})});if(!e.ok){const o=await e.text();console.error("Audio announcement failed:",o);return}const n=e.headers.get("Content-Type")??"";let r;if(n.includes("audio")){const o=await e.arrayBuffer();r=new Blob([o],{type:n})}else{const o=await e.text(),l=atob(o),u=new Uint8Array(l.length);for(let c=0;c<l.length;c++)u[c]=l.charCodeAt(c);r=new Blob([u],{type:"audio/mpeg"})}const s=URL.createObjectURL(r),i=new Audio(s);await i.play(),i.onended=()=>{URL.revokeObjectURL(s)}}catch(e){console.error("Error in audio announcement:",e)}},We=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(t),UP=t=>{const e=Math.max(t,0),n=Math.floor(e/1e3),r=Math.floor(n/60).toString().padStart(2,"0"),s=Math.floor(n%60).toString().padStart(2,"0");return`${r}:${s}`},w_=["A","B","C","D","E"],Oi=t=>!t||!t.length?[]:[...t].sort((n,r)=>w_.indexOf(n.label)-w_.indexOf(r.label)).flatMap(n=>n.players.map((r,s)=>({key:`${n.id}-${s}`,name:r,categoryLabel:n.label,basePrice:n.basePrice}))),Fh=[{code:"433-cam",label:"4-3-3 (CAM, CM, CM)",slots:[{id:"GK",label:"GK",x:50,y:94},{id:"LB",label:"LB",x:18,y:82},{id:"LCB",label:"LCB",x:38,y:78},{id:"RCB",label:"RCB",x:62,y:78},{id:"RB",label:"RB",x:82,y:82},{id:"LCM",label:"LCM",x:36,y:54},{id:"CAM",label:"CAM",x:50,y:40},{id:"RCM",label:"RCM",x:64,y:54},{id:"LW",label:"LW",x:18,y:24},{id:"ST",label:"ST",x:50,y:12},{id:"RW",label:"RW",x:82,y:24}]},{code:"433-cdm",label:"4-3-3 (CM, CM, CDM)",slots:[{id:"GK",label:"GK",x:50,y:94},{id:"LB",label:"LB",x:18,y:82},{id:"LCB",label:"LCB",x:38,y:78},{id:"RCB",label:"RCB",x:62,y:78},{id:"RB",label:"RB",x:82,y:82},{id:"LCM",label:"LCM",x:36,y:50},{id:"CDM",label:"CDM",x:50,y:62},{id:"RCM",label:"RCM",x:64,y:50},{id:"LW",label:"LW",x:18,y:24},{id:"ST",label:"ST",x:50,y:12},{id:"RW",label:"RW",x:82,y:24}]},{code:"442",label:"4-4-2",slots:[{id:"GK",label:"GK",x:50,y:94},{id:"LB",label:"LB",x:18,y:82},{id:"LCB",label:"LCB",x:38,y:78},{id:"RCB",label:"RCB",x:62,y:78},{id:"RB",label:"RB",x:82,y:82},{id:"LM",label:"LM",x:18,y:34},{id:"LCM",label:"LCM",x:40,y:54},{id:"RCM",label:"RCM",x:60,y:54},{id:"RM",label:"RM",x:82,y:34},{id:"STL",label:"ST",x:44,y:14},{id:"STR",label:"CF",x:56,y:14}]},{code:"4231",label:"4-2-3-1",slots:[{id:"GK",label:"GK",x:50,y:94},{id:"LB",label:"LB",x:18,y:82},{id:"LCB",label:"LCB",x:38,y:78},{id:"RCB",label:"RCB",x:62,y:78},{id:"RB",label:"RB",x:82,y:82},{id:"LCDM",label:"CDM",x:40,y:58},{id:"RCDM",label:"CDM",x:60,y:58},{id:"LW",label:"LW",x:18,y:24},{id:"CAM",label:"CAM",x:50,y:36},{id:"RW",label:"RW",x:82,y:24},{id:"ST",label:"ST",x:50,y:12}]},{code:"343",label:"3-4-3",slots:[{id:"GK",label:"GK",x:50,y:94},{id:"LCB",label:"LCB",x:34,y:78},{id:"CB",label:"CB",x:50,y:76},{id:"RCB",label:"RCB",x:66,y:78},{id:"LWB",label:"LWB",x:18,y:46},{id:"LCM",label:"CM",x:40,y:54},{id:"RCM",label:"CM",x:60,y:54},{id:"RWB",label:"RWB",x:82,y:46},{id:"LW",label:"LW",x:18,y:24},{id:"CF",label:"CF",x:50,y:12},{id:"RW",label:"RW",x:82,y:24}]}],Bh=t=>Fh.find(e=>e.code===t)??null,S_=["Nova","Lyric","Mochi","Zippy","Cosmo","Peach","Buzzy","Pipin","Jelly","Salsa","Lilac","Mango","Turbo","Nifty","Pixel","Bingo","Chill","Sprig","Sunny","Taffy","Gigle","Quirk","Bongo","Noodle","Happy"],Uh=()=>S_[Math.floor(Math.random()*S_.length)].slice(0,6),ar=3e4,C_=15e3,Gp=(t,e)=>t.manualPlayer?{slot:t.manualPlayer,isManual:!0}:{slot:e[t.currentPlayerIndex]??null,isManual:!1},$P=(t,e)=>t.budgetRemaining>=e,zP=async t=>{const e=t.auctionName.trim();if(!e)throw new Error("Auction name is required.");const n=e.toLowerCase();if(!(await cc(Aa(Gt(Ce,"auctions"),lc("nameLower","==",n),Op(1)))).empty)throw new Error("Auction name already exists, try a different one.");const s=t.categories.map(u=>({...u,players:u.players.map(c=>c.trim()).filter(c=>!!c)})).filter(u=>u.players.length);if(!s.length)throw new Error("Add at least one player to create an auction.");const i=s.reduce((u,c)=>u+c.players.length,0),o=await LA(Gt(Ce,"auctions"),{name:e,nameLower:n,visibility:t.visibility,password:t.password,createdAt:Ke(),updatedAt:Ke(),adminId:t.clientId,adminName:t.adminName.trim()||"Admin",maxParticipants:t.maxParticipants,participantCount:t.adminWillPlay===!1?0:1,playersPerTeam:t.playersPerTeam,budgetPerPlayer:t.budgetPerPlayer,categories:s,status:"lobby",currentPlayerIndex:-1,countdownEndsAt:null,countdownDuration:ar,activeBid:null,skipVotes:[],isPaused:!1,pausedRemainingMs:null,manualPlayer:null,manualSourceId:null,finalizationOpen:!1,totalPlayers:i,viewCount:0,completedPlayers:[],results:[],anonymousMode:!!t.anonymousMode,adminParticipating:t.adminWillPlay!==!1}),l=Oe(Gt(o,"participants"),t.clientId);return await DT(l,{name:t.adminName.trim().slice(0,10)||"Admin",role:"admin",joinedAt:Ke(),budgetRemaining:t.adminWillPlay===!1?0:t.budgetPerPlayer,playersNeeded:t.adminWillPlay===!1?0:t.playersPerTeam,roster:[],hasSubmittedTeam:!1,rankingSubmitted:!1,rankings:{},alias:t.anonymousMode?Uh():null,participating:t.adminWillPlay!==!1}),o.id},qP=async t=>{const e=t.trim().toLowerCase();if(!e)return null;const n=await cc(Aa(Gt(Ce,"auctions"),lc("nameLower","==",e),Op(1)));if(n.empty)return null;const r=n.docs[0];return{id:r.id,data:r.data()}},WP=async t=>{const{auctionId:e,password:n,clientId:r,displayName:s}=t,i=Oe(Ce,"auctions",e),o=Oe(Gt(i,"participants"),r);await $n(Ce,async l=>{const u=await l.get(i);if(!u.exists())throw new Error("Auction not found.");const c=u.data();if(c.password!==n)throw new Error("Incorrect password.");const d=await l.get(o),p=s.trim().slice(0,10);if(!d.exists()){if(c.participantCount>=c.maxParticipants)throw new Error("Auction is full.");l.update(i,{participantCount:c.participantCount+1,updatedAt:Ke()}),l.set(o,{name:p,role:"player",joinedAt:Ke(),budgetRemaining:c.budgetPerPlayer,playersNeeded:c.playersPerTeam,roster:[],hasSubmittedTeam:!1,rankingSubmitted:!1,rankings:{},alias:c.anonymousMode?Uh():null,participating:!0});return}const m=d.data();l.set(o,{...m,name:p||m.name,rankings:m.rankings??{},alias:m.alias??(c.anonymousMode?Uh():null),participating:m.participating??!0},{merge:!0})})},HP=async t=>{const e=Oe(Ce,"auctions",t);await $n(Ce,async n=>{const r=await n.get(e);if(!r.exists())throw new Error("Auction not found.");const s=r.data();if(s.status!=="lobby")throw new Error("Auction already started.");if(!Oi(s.categories).length)throw new Error("No players to start the auction.");const o=Se.fromMillis(Date.now()+ar);n.update(e,{status:"live",currentPlayerIndex:0,countdownEndsAt:o,countdownDuration:ar,activeBid:null,skipVotes:[],isPaused:!1,pausedRemainingMs:null,manualPlayer:null,manualSourceId:null,finalizationOpen:!1,updatedAt:Ke()})})},GP=async t=>{const{auctionId:e,clientId:n,bidderName:r,amount:s}=t,i=Oe(Ce,"auctions",e),o=Oe(Gt(i,"participants"),n);await $n(Ce,async l=>{const u=await l.get(i);if(!u.exists())throw new Error("Auction not found.");const c=u.data();if(c.status!=="live")throw new Error("Auction is not live.");if(c.isPaused)throw new Error("Auction is paused.");const d=Oi(c.categories),{slot:p}=Gp(c,d);if(!p)throw new Error("No active player.");const m=await l.get(o);if(!m.exists())throw new Error("Participant missing.");const v=m.data(),R=Math.max(p.basePrice,c.activeBid?c.activeBid.amount+1:p.basePrice);if(s<R)throw new Error(`Bid must be at least ${R}.`);if(s>v.budgetRemaining)throw new Error("Bid exceeds your remaining budget.");const b=Se.fromMillis(Date.now()+C_);l.update(i,{activeBid:{amount:s,bidderId:n,bidderName:r,startedAt:Ke()},countdownEndsAt:b,countdownDuration:C_,skipVotes:[],updatedAt:Ke()})}),await Gw(e)},KP=async t=>{const{auctionId:e,clientId:n}=t,r=Oe(Ce,"auctions",e),s=await $n(Ce,async i=>{const o=await i.get(r);if(!o.exists())throw new Error("Auction not found.");const l=o.data();if(l.status!=="live"||l.isPaused)return{resolve:!1,forceUnsold:!1};const u=new Set(l.skipVotes??[]);u.add(n);const c=Array.from(u);i.update(r,{skipVotes:c,updatedAt:Ke()});const d=l.activeBid;if(d){const p=c.filter(v=>v!==d.bidderId).length,m=Math.max(l.participantCount-1,1);return{resolve:p>=m,forceUnsold:!1}}return{resolve:c.length>=l.participantCount,forceUnsold:!0}});s.resolve?await gc({auctionId:e,forceUnsold:s.forceUnsold}):await Gw(e)},QP=async t=>{const e=Oe(Ce,"auctions",t);await $n(Ce,async n=>{const r=await n.get(e);if(!r.exists())throw new Error("Auction not found.");const s=r.data();if(s.status!=="live"||s.isPaused)return;const i=s.countdownEndsAt?Math.max(s.countdownEndsAt.toMillis()-Date.now(),0):s.countdownDuration??ar;n.update(e,{isPaused:!0,pausedRemainingMs:i,countdownEndsAt:null,updatedAt:Ke()})})},YP=async t=>{const e=Oe(Ce,"auctions",t);await $n(Ce,async n=>{const r=await n.get(e);if(!r.exists())throw new Error("Auction not found.");const s=r.data();if(s.status!=="live"||!s.isPaused)return;const i=s.pausedRemainingMs??s.countdownDuration??ar;n.update(e,{isPaused:!1,pausedRemainingMs:null,countdownEndsAt:Se.fromMillis(Date.now()+i),countdownDuration:i,updatedAt:Ke()})})},JP=(t,e)=>{const n=t.currentPlayerIndex+1;return n<e.length?{updates:{currentPlayerIndex:n,countdownEndsAt:Se.fromMillis(Date.now()+ar),countdownDuration:ar,activeBid:null,skipVotes:[],isPaused:!1,pausedRemainingMs:null,finalizationOpen:t.finalizationOpen??!1,updatedAt:Ke()}}:{updates:{status:"ended",currentPlayerIndex:n,countdownEndsAt:null,countdownDuration:null,activeBid:null,skipVotes:[],isPaused:!1,pausedRemainingMs:null,finalizationOpen:!1,updatedAt:Ke()}}},gc=async t=>{const{auctionId:e,forceUnsold:n=!1}=t,r=Oe(Ce,"auctions",e);await $n(Ce,async s=>{const i=await s.get(r);if(!i.exists())throw new Error("Auction not found.");const o=i.data();if(o.status!=="live")return;const l=Oi(o.categories),{slot:u,isManual:c}=Gp(o,l);if(!u){s.update(r,{status:"ended",countdownEndsAt:null,countdownDuration:null,activeBid:null,skipVotes:[],finalizationOpen:!1,updatedAt:Ke()});return}const d=o.activeBid,p=!!d&&!n;let m={id:u.key,playerName:u.name,categoryLabel:u.categoryLabel,basePrice:u.basePrice,result:"unsold",resolvedAt:Se.fromMillis(Date.now())};if(p&&d){const V=Oe(Gt(r,"participants"),d.bidderId),w=await s.get(V);if(!w.exists())throw new Error("Winning bidder left the lobby.");const E=w.data(),x=[...E.roster??[],{playerName:u.name,categoryLabel:u.categoryLabel,price:d.amount}];s.update(V,{roster:x,budgetRemaining:E.budgetRemaining-d.amount,playersNeeded:Math.max(E.playersNeeded-1,0)}),m={...m,result:"sold",winnerId:d.bidderId,winnerName:E.name,winnerAlias:E.alias??E.name,finalBid:d.amount}}let v=[...o.completedPlayers??[]];c&&o.manualSourceId?v=v.map(V=>V.id===o.manualSourceId?{...m,id:V.id}:V):v=[...v,m];const R=o.currentPlayerIndex>=l.length-1,b=c?{updates:{manualPlayer:null,manualSourceId:null,countdownEndsAt:null,countdownDuration:null,activeBid:null,skipVotes:[],isPaused:!1,pausedRemainingMs:null,status:R?"ended":o.status,finalizationOpen:R?!1:o.finalizationOpen??!1,updatedAt:Ke()}}:JP(o,l);s.update(r,{completedPlayers:v,...b.updates})})},XP=async t=>{const{auctionId:e,clientId:n,finalRoster:r,sport:s,formationCode:i,formationLabel:o}=t,l=Oe(Gt(Oe(Ce,"auctions",e),"participants"),n);await dc(l,{hasSubmittedTeam:!0,finalRoster:r,finalRosterSport:s,finalRosterFormation:s==="soccer"?{code:i??"custom",label:o??i??"Custom formation"}:null})},ZP=async t=>{const e=Oe(Ce,"auctions",t);await $n(Ce,async n=>{const r=await n.get(e);if(!r.exists())throw new Error("Auction not found.");const s=r.data();if(s.status!=="ended")throw new Error("Finish the auction before opening final teams.");s.finalizationOpen||n.update(e,{finalizationOpen:!0,updatedAt:Ke()})})},Gw=async t=>{const e=Oe(Ce,"auctions",t),n=await NT(e);if(!n.exists())return;const r=n.data();if(r.status!=="live"||r.isPaused||!r.activeBid)return;const s=Oi(r.categories),{slot:i}=Gp(r,s);if(!i)return;const o=Math.max(i.basePrice,r.activeBid.amount+1);(await cc(Gt(e,"participants"))).docs.map(c=>({id:c.id,...c.data()})).filter(c=>{var d;return c.id!==((d=r.activeBid)==null?void 0:d.bidderId)}).some(c=>$P(c,o))||await gc({auctionId:t})},e2=async t=>{const{auctionId:e,completedPlayerId:n}=t,r=Oe(Ce,"auctions",e);await $n(Ce,async s=>{const i=await s.get(r);if(!i.exists())throw new Error("Auction not found.");const l=(i.data().completedPlayers??[]).find(u=>u.id===n);if(!l||l.result!=="unsold")throw new Error("Player not available for re-auction.");s.update(r,{status:"live",manualPlayer:{key:`manual-${l.id}-${Date.now()}`,name:l.playerName,categoryLabel:l.categoryLabel,basePrice:l.basePrice,sourceId:l.id},manualSourceId:l.id,countdownEndsAt:Se.fromMillis(Date.now()+ar),countdownDuration:ar,activeBid:null,skipVotes:[],isPaused:!1,pausedRemainingMs:null,updatedAt:Ke()})})},t2=async t=>{const{auctionId:e,clientId:n,rankingOrder:r}=t,s=Oe(Ce,"auctions",e),i=Oe(Gt(s,"participants"),n);await $n(Ce,async o=>{const l=await o.get(s);if(!l.exists())throw new Error("Auction not found.");const c=l.data().participantCount,d=Math.max(c-1,1),p={};r.forEach((m,v)=>{p[m]=Math.max(d-v,1)}),o.update(i,{rankings:p,rankingSubmitted:!0})})},n2=async t=>{const e=Oe(Ce,"auctions",t),n=await NT(e);if(!n.exists())throw new Error("Auction not found.");if(n.data().status!=="ranking")return;const i=(await cc(Gt(e,"participants"))).docs.map(u=>({id:u.id,...u.data()})),o={};i.forEach(u=>{u.rankings&&Object.entries(u.rankings).forEach(([c,d])=>{o[c]=(o[c]??0)+d})});const l=i.map(u=>{var c,d;return{participantId:u.id,name:u.name,points:o[u.id]??0,rosterCount:((c=u.finalRoster)==null?void 0:c.length)??((d=u.roster)==null?void 0:d.length)??0,budgetRemaining:u.budgetRemaining}}).sort((u,c)=>c.points-u.points).map((u,c)=>({...u,rank:c+1}));await dc(e,{status:"results",results:l,updatedAt:Ke()})},r2=async t=>{await dc(Oe(Ce,"auctions",t),{status:"ranking",finalizationOpen:!1,updatedAt:Ke()})},s2=async t=>{const e=Oe(Ce,"auctions",t);await dc(e,{viewCount:UA(1),updatedAt:Ke()})},I_=["A","B","C","D","E"],i2=["Opener 1","Opener 2","One down","Two down","Three down","Four down","Five down","Six down","Seven down","Eight down","Nine down","Ten down","Eleven"],o2=Array.from({length:12}).map((t,e)=>({id:`soccer-bench-${e}`,label:`Bench ${e+1}`,x:10+e%5*18,y:94-Math.floor(e/5)*3})),Kw=(t,e)=>{const n=(t==null?void 0:t.slots)??[];if(e<=n.length)return n.slice(0,e);const r=e-n.length;return[...n,...o2.slice(0,r)]},Gn={basketball:{displayLabel:"Basketball lineup",background:"basketball",formations:[{code:"basketball-classic",label:"Classic 2-3",slots:[{id:"bb-pg",label:"Point Guard",x:50,y:82},{id:"bb-sg",label:"Shooting Guard",x:70,y:65},{id:"bb-sf",label:"Small Forward",x:30,y:65},{id:"bb-pf",label:"Power Forward",x:65,y:45},{id:"bb-c",label:"Center",x:35,y:45}]},{code:"basketball-stretch",label:"Stretch 4",slots:[{id:"bb2-pg",label:"Point Guard",x:50,y:82},{id:"bb2-sg",label:"Wing",x:75,y:58},{id:"bb2-sf",label:"Wing",x:25,y:58},{id:"bb2-pf",label:"Stretch Forward",x:70,y:40},{id:"bb2-c",label:"Mobile Center",x:30,y:40}]}]},football:{displayLabel:"Football depth chart",background:"football",formations:[{code:"football-trips",label:"Trips Right",slots:[{id:"fb-qb",label:"QB",x:50,y:82},{id:"fb-rb",label:"RB",x:40,y:68},{id:"fb-wr1",label:"X WR",x:15,y:60},{id:"fb-wr2",label:"Slot WR",x:70,y:55},{id:"fb-wr3",label:"Z WR",x:85,y:60},{id:"fb-te",label:"TE",x:60,y:58},{id:"fb-ol1",label:"LT",x:30,y:48},{id:"fb-ol2",label:"LG",x:45,y:48},{id:"fb-ol3",label:"C",x:60,y:48},{id:"fb-ol4",label:"RG",x:75,y:48},{id:"fb-ol5",label:"RT",x:90,y:48}]},{code:"football-i",label:"I-Formation",slots:[{id:"fb2-qb",label:"QB",x:50,y:78},{id:"fb2-rb",label:"HB",x:50,y:65},{id:"fb2-fb",label:"FB",x:50,y:70},{id:"fb2-wr1",label:"WR",x:20,y:58},{id:"fb2-wr2",label:"WR",x:80,y:58},{id:"fb2-te",label:"TE",x:70,y:55},{id:"fb2-ol1",label:"LT",x:30,y:47},{id:"fb2-ol2",label:"LG",x:45,y:47},{id:"fb2-ol3",label:"C",x:60,y:47},{id:"fb2-ol4",label:"RG",x:75,y:47},{id:"fb2-ol5",label:"RT",x:90,y:47}]}]},rugby:{displayLabel:"Rugby fifteen",background:"rugby",formations:[{code:"rugby-balanced",label:"Balanced Fifteen",slots:[{id:"rg-15",label:"Full Back",x:50,y:88},{id:"rg-14",label:"Right Wing",x:80,y:73},{id:"rg-13",label:"Outside Centre",x:60,y:68},{id:"rg-12",label:"Inside Centre",x:40,y:68},{id:"rg-11",label:"Left Wing",x:20,y:73},{id:"rg-10",label:"Fly-half",x:50,y:58},{id:"rg-9",label:"Scrum-half",x:50,y:48},{id:"rg-8",label:"Number 8",x:50,y:40},{id:"rg-7",label:"Open Flanker",x:70,y:35},{id:"rg-6",label:"Blind Flanker",x:30,y:35},{id:"rg-5",label:"Lock",x:62,y:25},{id:"rg-4",label:"Lock",x:38,y:25},{id:"rg-3",label:"Tight Prop",x:70,y:15},{id:"rg-2",label:"Hooker",x:50,y:15},{id:"rg-1",label:"Loose Prop",x:30,y:15}]},{code:"rugby-wide",label:"Wide Attack",slots:[{id:"rg2-15",label:"Full Back",x:50,y:88},{id:"rg2-14",label:"Wing",x:85,y:70},{id:"rg2-11",label:"Wing",x:15,y:70},{id:"rg2-13",label:"Outside Centre",x:65,y:60},{id:"rg2-12",label:"Inside Centre",x:35,y:60},{id:"rg2-10",label:"Fly-half",x:50,y:52},{id:"rg2-9",label:"Scrum-half",x:50,y:44},{id:"rg2-8",label:"Number 8",x:50,y:36},{id:"rg2-7",label:"Op Flanker",x:70,y:30},{id:"rg2-6",label:"Bl Flanker",x:30,y:30},{id:"rg2-5",label:"Lock",x:65,y:22},{id:"rg2-4",label:"Lock",x:35,y:22},{id:"rg2-3",label:"Prop",x:72,y:12},{id:"rg2-2",label:"Hooker",x:50,y:12},{id:"rg2-1",label:"Prop",x:28,y:12}]}]}},Qw=(t,e)=>{const n=Gn[t];return n?n.formations.find(r=>r.code===e)??n.formations[0]:null},_o=(t,e,n)=>{const r=Qw(t,n),s=(r==null?void 0:r.slots)??[];if(e<=s.length)return s.slice(0,e);const i=e-s.length,o=Array.from({length:i}).map((l,u)=>({id:`${t}-bench-${u}`,label:`Bench ${u+1}`,x:10+u%5*18,y:94-Math.floor(u/5)*4}));return[...s,...o]},qs=(t,e={})=>{const n={};return t.forEach(r=>{n[r.id]=e[r.id]??null}),n},Fr=(t,e,n="default")=>!(e!=null&&e.anonymousMode)||n==="lobby"||n==="leaderboard"?t.name:t.alias??t.name,a2=()=>{const[t,e]=D.useState([]);return D.useEffect(()=>{const n=Aa(Gt(Ce,"auctions"),lc("visibility","==","public"),AT("createdAt","desc"),Op(12)),r=Su(n,s=>{const i=[];s.forEach(o=>i.push({id:o.id,...o.data()})),e(i)});return()=>r()},[]),t},l2=()=>{const t=hP(),[e,n]=D.useState("landing"),[r,s]=D.useState(()=>typeof window>"u"?null:window.localStorage.getItem("saifur-auction:last")),{auction:i,participants:o,loading:l}=fP(r),u=D.useMemo(()=>o.find(pe=>pe.id===t)??null,[o,t]),[c,d]=D.useState(null),p=a2(),[m,v]=D.useState(null),[R,b]=D.useState(0),V=!!(r&&!i),w=(pe,Re)=>{d({type:pe,text:Re})};D.useEffect(()=>{typeof window>"u"||(r?window.localStorage.setItem("saifur-auction:last",r):window.localStorage.removeItem("saifur-auction:last"))},[r]),D.useEffect(()=>{if(!i)return;const pe={lobby:"lobby",live:"auction",ended:"auction",ranking:"ranking",results:"results"},Re=i.status==="ended"&&i.finalizationOpen?"post":pe[i.status];n(bt=>bt==="create"||bt==="join"?bt:Re)},[i==null?void 0:i.status,i==null?void 0:i.finalizationOpen]),D.useEffect(()=>{if(!c)return;const pe=setTimeout(()=>d(null),5e3);return()=>clearTimeout(pe)},[c]),E2(i,o,u,w),D.useEffect(()=>{(!i||i.status!=="lobby")&&(v(null),b(0))},[i==null?void 0:i.status]);const E=D.useMemo(()=>!!(i&&i.visibility==="public"&&!u),[i==null?void 0:i.id,i==null?void 0:i.visibility,u==null?void 0:u.id]),x=E?(i==null?void 0:i.viewCount)??0:0,L=E&&x>0;D.useEffect(()=>{if(!E||!i||typeof window>"u")return;const pe=`saifur-auction:view:${i.id}`;window.localStorage.getItem(pe)||(window.localStorage.setItem(pe,"1"),s2(i.id).catch(()=>{window.localStorage.removeItem(pe)}))},[E,i==null?void 0:i.id]);const[z,B]=D.useState(!1),[S,_]=D.useState(()=>typeof window>"u"?!1:window.localStorage.getItem("saifur-auction:voice")!=="off"),C=D.useCallback(()=>{!i||i.status!=="lobby"||!u||u.role!=="admin"||R>0||m||(v(i.id),b(10),Hw("Auction starting in ten seconds"))},[i==null?void 0:i.id,i==null?void 0:i.status,m,R,u]);D.useEffect(()=>{if(!m||R<=0)return;const pe=setTimeout(()=>{b(Re=>Re>0?Re-1:0)},1e3);return()=>clearTimeout(pe)},[m,R]),D.useEffect(()=>{if(!m||R!==0)return;const pe=m;v(null),HP(pe).catch(Re=>w("error",Re.message))},[m,R,w]),D.useEffect(()=>{u||B(!1)},[u==null?void 0:u.id]),D.useEffect(()=>{e!=="auction"&&_(!1)},[e]),D.useEffect(()=>{typeof window>"u"||window.localStorage.setItem("saifur-auction:voice",S?"on":"off")},[S]);const A=!!(i&&["lobby","auction","post","ranking","results"].includes(e)),k=!!u,T=!!(k&&z),oe=E||!T,{connected:G,connecting:ne,error:fe,remoteStreams:$,leave:te}=BP({auctionId:(A||oe)&&i?i.id:null,clientId:t||null,scope:(i==null?void 0:i.status)==="lobby"?"lobby":"live",listenOnly:oe,autoJoin:!0}),H=D.useRef(G);D.useEffect(()=>{if(!(A||oe)){H.current=G;return}if(G!==H.current){if(oe)w("success",G?"Listening to live voice.":"Stopped listening.");else{const Re=(i==null?void 0:i.status)==="lobby";w("success",G?Re?"Joined lobby voice chat.":"Joined voice chat.":"Left voice chat.")}H.current=G}},[G,A,oe,w,i==null?void 0:i.status]);const ce=D.useRef(null);D.useEffect(()=>{if(!A&&!oe){ce.current=fe;return}fe&&fe!==ce.current&&(w("error",fe),ce.current=fe)},[fe,w,A]),D.useEffect(()=>{!u&&!oe&&G&&te()},[u,oe,G,te]);const le=!!(k&&A),de=(i==null?void 0:i.status)==="lobby"?"the lobby":"the floor",$e=le&&(A||oe)?{connected:T&&G,connecting:ne,canToggle:!0,toggle:()=>B(pe=>!pe),stageLabel:de,mode:T?"talk":"listen"}:null,At=pe=>{s(pe),n("lobby")},gt=pe=>{s(pe),n("lobby")},rt=pe=>{s(pe),n("lobby")},gn=()=>{s(null),n("landing")},Yt=()=>{if(!i&&["lobby","auction","post","ranking","results"].includes(e))return g.jsx(R_,{hasActiveAuction:V,onCreate:()=>n("create"),onJoin:()=>n("join"),onResume:V?()=>n("lobby"):null});switch(e){case"landing":return g.jsx(R_,{hasActiveAuction:V,onCreate:()=>n("create"),onJoin:()=>n("join"),onResume:V?()=>n("lobby"):null});case"create":return g.jsx(u2,{clientId:t,onBack:()=>n("landing"),onCreated:At,notify:w});case"join":return g.jsx(c2,{clientId:t,publicAuctions:p,onBack:()=>n("landing"),onJoined:gt,onWatch:rt,notify:w});case"lobby":return i&&g.jsx(d2,{auction:i,participants:o,selfParticipant:u,notify:w,voiceControl:$e,viewerCount:L?x:null,preStartCountdown:R,onStartCountdown:C});case"auction":return i&&g.jsx(g2,{auction:i,participants:o,selfParticipant:u,notify:w,voiceControl:$e,audioEnabled:S,onToggleAudio:()=>_(pe=>!pe)});case"post":return i&&g.jsx(y2,{auction:i,participants:o,selfParticipant:u,notify:w,voiceControl:$e});case"ranking":return i&&g.jsx(_2,{auction:i,participants:o,selfParticipant:u,notify:w,voiceControl:$e});case"results":return i&&g.jsx(v2,{auction:i,participants:o,voiceControl:$e});default:return null}};return g.jsxs("div",{className:"app-root",children:[c&&g.jsx("div",{className:`toast ${c.type}`,children:g.jsx("span",{children:c.text})}),g.jsxs("header",{className:"hero-header",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"hero-title",children:"Midnight Draft Arena"}),g.jsx("p",{className:"hero-subtitle",children:"The night begins when the auction starts."})]}),g.jsx("div",{className:"header-actions",children:i&&g.jsxs("div",{className:"session-chip",children:[g.jsxs("div",{children:[g.jsx("p",{className:"chip-label",children:"Active auction"}),g.jsxs("p",{className:"chip-value",children:[g.jsx("span",{className:"chip-auction-name",children:i.name}),g.jsx("span",{className:"status-pill",children:i.status.toUpperCase()})]}),E&&g.jsx("p",{className:"chip-label",children:"Viewing only"})]}),g.jsx("button",{className:"btn text",onClick:gn,children:"Leave"})]})})]}),g.jsx("main",{className:"stage-panel",children:l?g.jsx("p",{children:"Loading..."}):Yt()}),g.jsx(f2,{streams:$}),g.jsx("footer",{className:"app-footer",children:" Saifur Rahman Mehedi"})]})},R_=({hasActiveAuction:t,onCreate:e,onJoin:n,onResume:r})=>g.jsxs("section",{className:"landing-card",children:[g.jsx("h2",{children:"Let's play auction."}),g.jsx("p",{children:"Start a lobby, share the password, and run a live late-night auction with your friends."}),g.jsxs("div",{className:"landing-actions",children:[g.jsx("button",{className:"btn accent",onClick:e,children:"Create auction"}),g.jsx("button",{className:"btn outline",onClick:n,children:"Join auction"})]}),t&&r&&g.jsx("button",{className:"btn text",onClick:r,children:"Resume last lobby"})]}),u2=({clientId:t,onBack:e,onCreated:n,notify:r})=>{const[s,i]=D.useState(""),[o,l]=D.useState(""),[u,c]=D.useState(""),[d,p]=D.useState("6"),[m,v]=D.useState("11"),[R,b]=D.useState("100"),[V,w]=D.useState("private"),[E,x]=D.useState(!0),[L,z]=D.useState(!1),[B,S]=D.useState([{id:crypto.randomUUID(),label:"A",basePrice:10,basePriceInput:"10",playersText:""}]),[_,C]=D.useState(!1),I=D.useCallback(G=>G.split(/[\n,]/).map(ne=>ne.trim()).filter(Boolean),[]),A=()=>{const G=I_.filter(ne=>!B.some(fe=>fe.label===ne));G.length&&S(ne=>[...ne,{id:crypto.randomUUID(),label:G[0],basePrice:ne.length?ne[ne.length-1].basePrice:10,basePriceInput:String(ne.length?ne[ne.length-1].basePrice:10),playersText:""}])},k=(G,ne)=>{S(fe=>fe.map($=>$.id===G?{...$,...ne}:$))},T=(G,ne)=>{const fe=ne.replace(/[^0-9]/g,"");k(G,{basePriceInput:fe,basePrice:Number(fe||0)})},oe=async G=>{if(G.preventDefault(),!u.trim()){r("error","Set a password so friends can join safely.");return}const ne=Number(d||"0");if(!Number.isFinite(ne)||ne<2||ne>20){r("error","Set between 2 and 20 friends for this auction.");return}const fe=Number(m||"0");if(!Number.isFinite(fe)||fe<1||fe>20){r("error","Players per team must be between 1 and 20.");return}const $=Number(R||"0");if(!Number.isFinite($)||$<1){r("error","Budget per player should be at least $1M.");return}const te=$*1e6;C(!0);try{const H=B.map(le=>({id:le.id,label:le.label,basePrice:Number(le.basePrice),players:I(le.playersText)})).filter(le=>le.players.length),ce=await zP({auctionName:o.slice(0,20),adminName:s||"Admin",clientId:t,maxParticipants:ne,playersPerTeam:fe,budgetPerPlayer:te,visibility:V,password:u.trim(),categories:H,anonymousMode:L,adminWillPlay:E});r("success","Auction created. Share the code + password to start inviting."),n(ce)}catch(H){r("error",H.message)}finally{C(!1)}};return g.jsxs("section",{className:"panel-card",children:[g.jsx("button",{className:"btn text",onClick:e,children:"Back"}),g.jsx("h2",{children:"Create Auction"}),g.jsxs("form",{className:"form-grid",onSubmit:oe,children:[g.jsxs("label",{children:["Auction name (max 20 chars)",g.jsx("input",{type:"text",value:o,maxLength:20,onChange:G=>l(G.target.value),required:!0})]}),g.jsxs("label",{children:["Password",g.jsx("input",{type:"text",value:u,onChange:G=>c(G.target.value),placeholder:"Set a password for this auction",required:!0})]}),g.jsxs("label",{children:["Admin name",g.jsx("input",{type:"text",value:s,maxLength:10,onChange:G=>i(G.target.value),required:!0})]}),g.jsxs("label",{className:"toggle-row",children:[g.jsx("span",{children:"I'll play in this auction"}),g.jsx("input",{type:"checkbox",checked:E,onChange:G=>x(G.target.checked)}),g.jsx("p",{className:"muted-label",children:"Keep this on to bid alongside friends. Turn it off if you're just hosting & judging."})]}),g.jsxs("label",{className:"toggle-row",children:[g.jsx("span",{children:"Anonymous auction"}),g.jsx("input",{type:"checkbox",checked:L,onChange:G=>z(G.target.checked)}),g.jsx("p",{className:"muted-label",children:"Everyone gets a short alias during bidding and ranking. Real names show only in lobby and final leaderboard."})]}),g.jsxs("label",{children:["How many friends will play?",g.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"6",value:d,onChange:G=>p(G.target.value.replace(/^0+/,"")),required:!0})]}),g.jsxs("label",{children:["Players per team",g.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"11",value:m,onChange:G=>v(G.target.value.replace(/^0+/,"")),required:!0})]}),g.jsxs("label",{children:["Budget per player (USD millions)",g.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"100",value:R,onChange:G=>b(G.target.value.replace(/^0+/,"")),required:!0})]}),g.jsxs("div",{className:"chip-select",role:"group","aria-label":"Visibility",children:[g.jsx("span",{children:"Visibility"}),g.jsxs("div",{className:"chip-row",children:[g.jsx("button",{type:"button",className:V==="public"?"chip active":"chip",onClick:()=>w("public"),children:"Public"}),g.jsx("button",{type:"button",className:V==="private"?"chip active":"chip",onClick:()=>w("private"),children:"Private"})]}),g.jsx("p",{className:"muted-label",children:V==="public"?"Lobby listed for anyone browsing.":"Hidden lobby. Share the password manually."})]}),g.jsxs("div",{className:"category-section",children:[g.jsx("h3",{children:"Categories & Players"}),g.jsx("p",{className:"muted-label",children:"Paste names separated by commas or new lines."}),g.jsx("div",{className:"category-grid",children:B.map(G=>g.jsxs("div",{className:"category-card",children:[g.jsxs("div",{className:"category-header",children:[g.jsxs("div",{className:"category-title",children:[g.jsx("span",{className:"category-pill",children:G.label}),g.jsxs("span",{className:"player-count",children:[I(G.playersText).length," players"]})]}),g.jsx("div",{className:"category-meta",children:g.jsxs("label",{children:["Base price (USD)",g.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:G.basePriceInput,onChange:ne=>T(G.id,ne.target.value)})]})})]}),g.jsx("textarea",{className:"category-textarea",rows:4,value:G.playersText,onChange:ne=>k(G.id,{playersText:ne.target.value}),placeholder:`Messi, Ronaldo, Neymar
Mbappe, Haaland`,spellCheck:!1})]},G.id))}),B.length<I_.length&&g.jsx("button",{type:"button",className:"btn outline",onClick:A,children:"Add new category (B-E)"})]}),g.jsx("button",{className:"btn accent",disabled:_,children:_?"Creating...":"Create Auction"})]})]})},c2=({clientId:t,publicAuctions:e,onBack:n,onJoined:r,onWatch:s,notify:i})=>{const[o,l]=D.useState(""),[u,c]=D.useState(""),[d,p]=D.useState(""),[m,v]=D.useState(!1),R=async b=>{b.preventDefault(),v(!0);try{const V=await qP(u);if(!V){i("error","Auction name not found."),v(!1);return}await WP({auctionId:V.id,password:d.trim(),clientId:t,displayName:o}),i("success","Welcome to the lobby!"),r(V.id)}catch(V){i("error",V.message)}finally{v(!1)}};return g.jsxs("section",{className:"panel-card join-panel",children:[g.jsx("button",{className:"btn text",onClick:n,children:"Back"}),g.jsxs("div",{className:"join-grid",children:[g.jsxs("form",{onSubmit:R,className:"form-grid",children:[g.jsx("h3",{children:"Join Auction (Players)"}),g.jsxs("label",{children:["Your name (10 char max)",g.jsx("input",{type:"text",value:o,maxLength:10,onChange:b=>l(b.target.value),required:!0})]}),g.jsxs("label",{children:["Auction name",g.jsx("input",{type:"text",value:u,onChange:b=>c(b.target.value),required:!0})]}),g.jsxs("label",{children:["Password",g.jsx("input",{type:"password",value:d,onChange:b=>p(b.target.value),required:!0})]}),g.jsx("button",{className:"btn accent",disabled:m,children:m?"Joining...":"Join auction"})]}),g.jsxs("div",{className:"public-list",children:[g.jsx("h3",{children:"Watch public auctions live"}),g.jsx("p",{className:"muted-label",children:"Tap Watch to spectate ongoing public auctions."}),!e.length&&g.jsx("p",{children:"No public auctions yet."}),g.jsx("ul",{children:e.map(b=>g.jsxs("li",{children:[g.jsxs("div",{children:[g.jsx("strong",{children:b.name}),g.jsxs("p",{children:[b.participantCount,"/",b.maxParticipants," players -"," ",b.categories.length," categories"]})]}),g.jsxs("div",{className:"public-actions",children:[g.jsx("button",{className:"btn outline",onClick:()=>{c(b.name),p(""),i("success",`Selected ${b.name}. Enter the password to join.`)},children:"Join"}),g.jsx("button",{className:"btn ghost",type:"button",onClick:()=>s(b.id),children:"Watch"})]})]},b.id))})]})]})]})},d2=({auction:t,participants:e,selfParticipant:n,notify:r,voiceControl:s,viewerCount:i,preStartCountdown:o,onStartCountdown:l})=>{const u=(n==null?void 0:n.role)==="admin",c=D.useMemo(()=>Oi(t.categories),[t.categories]);return g.jsxs("section",{className:"panel-card lobby",children:[g.jsx(Ts,{control:s}),g.jsxs("div",{className:"lobby-header",children:[g.jsxs("div",{className:"lobby-title-row",children:[g.jsx("p",{className:"eyebrow",children:"Lobby"}),g.jsxs("div",{className:"title-with-badge",children:[g.jsx("h2",{children:t.name}),g.jsxs("span",{className:"join-pill",children:[g.jsx("span",{children:"Joined"}),g.jsxs("strong",{children:[t.participantCount,"/",t.maxParticipants]})]}),i&&g.jsx(m2,{count:i})]})]}),g.jsxs("div",{className:"share-block",children:[g.jsxs("div",{className:"password-row",children:[g.jsxs("div",{children:[g.jsx("p",{className:"muted-label",children:"Share this password"}),g.jsxs("div",{className:"password-chip",children:[g.jsx("strong",{children:t.password}),g.jsx("button",{className:"btn text",onClick:()=>{navigator.clipboard.writeText(t.password),r("success","Password copied")},children:"Copy"})]})]}),u&&g.jsx("button",{className:"btn accent",onClick:l,disabled:o>0,children:o>0?`Starting in ${o}s`:"Start auction"})]}),!u&&g.jsx("p",{className:"muted-label",children:"Waiting for admin to start"}),o>0&&g.jsxs("div",{className:"prestart-banner floating",children:[g.jsx("span",{children:"Auction begins in"}),g.jsxs("strong",{children:[o,"s"]})]})]})]}),g.jsxs("div",{className:"lobby-body",children:[g.jsxs("div",{children:[g.jsx("h3",{children:"Players in lobby"}),g.jsx("ul",{className:"participant-list lobby-list",children:e.map(d=>g.jsx("li",{children:g.jsxs("div",{className:"name-stack",children:[g.jsx("strong",{children:d.name}),d.role==="admin"&&g.jsx("span",{className:"mini-pill",children:"Admin"})]})},d.id))})]}),g.jsxs("div",{className:"info-grid",children:[g.jsx(fl,{label:"Total budget",value:We(t.budgetPerPlayer)}),g.jsx(fl,{label:"Players per team",value:`${t.playersPerTeam}`}),g.jsx(fl,{label:"Categories loaded",value:`${t.categories.length}`}),g.jsx(fl,{label:"Players queued",value:`${t.totalPlayers}`})]})]}),c.length>0&&g.jsxs("div",{className:"player-order-card lobby-players",children:[g.jsx("h3",{children:"Player list"}),g.jsx("p",{className:"muted-label",children:"Review the list before the auction starts."}),g.jsxs("div",{className:"player-table player-table-head",children:[g.jsx("span",{children:"Name"}),g.jsx("span",{children:"Base price"})]}),g.jsx("ol",{className:"player-order-list table-style",children:c.map((d,p)=>g.jsxs("li",{className:"player-table",children:[g.jsxs("strong",{children:[p+1,". ",d.name]}),g.jsx("span",{children:We(d.basePrice)})]},d.key))})]})]})},Ts=({control:t,variant:e="panel"})=>t?e==="inline"?g.jsx("div",{className:"inline-voice-toggle",children:g.jsx(x_,{...t})}):g.jsx("div",{className:"panel-voice-toggle",children:g.jsx(x_,{...t})}):null,x_=({connected:t,connecting:e,canToggle:n,toggle:r,stageLabel:s,mode:i})=>{const o=i==="talk"&&!t,l=i==="talk"?t?"Mute voice chat":"Join voice chat":t?"Stop listening":"Listen in",u=i==="talk"?t?`Speaking to ${s}`:`Tap to speak in ${s}`:t?`Listening to ${s}`:`Tap to listen to ${s}`;return g.jsx("button",{type:"button",className:`voice-icon-btn ${i} ${t?"active":""} ${o?"muted":""}`,onClick:r,disabled:!n||e,"aria-busy":e,"aria-label":l,title:u,children:g.jsx(h2,{crossed:o})})},h2=({crossed:t})=>g.jsxs("span",{className:`mic-shell ${t?"muted":""}`,children:[g.jsxs("svg",{className:"mic-icon",viewBox:"0 0 24 24","aria-hidden":"true",children:[g.jsx("path",{d:"M15 10V6a3 3 0 0 0-6 0v4a3 3 0 0 0 6 0Z",fill:"currentColor"}),g.jsx("path",{d:"M7 10a5 5 0 0 0 10 0M12 15v4M8 19h8",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})]}),t&&g.jsx("span",{className:"mic-slash"})]}),f2=({streams:t})=>t.length?g.jsx("div",{className:"voice-audio-layer","aria-hidden":!0,children:t.map(e=>g.jsx(p2,{stream:e.stream},e.peerId))}):null,p2=({stream:t})=>{const e=D.useRef(null);return D.useEffect(()=>{const n=jh();if(!n)return;const r=()=>{n.state==="suspended"&&n.resume()};return window.addEventListener("click",r),window.addEventListener("touchstart",r,{passive:!0}),()=>{window.removeEventListener("click",r),window.removeEventListener("touchstart",r)}},[]),D.useEffect(()=>{const n=e.current;if(n)return n.srcObject=t,n.volume=0,n.play().catch(()=>{n.muted=!0,n.play().finally(()=>{n.muted=!1})}),()=>{n.pause(),n.srcObject=null}},[t]),D.useEffect(()=>{const n=jh();if(!n)return;const r=n.createMediaStreamSource(t),s=n.createBiquadFilter();s.type="highpass",s.frequency.value=120;const i=n.createBiquadFilter();i.type="lowpass",i.frequency.value=8200;const o=n.createDynamicsCompressor();o.threshold.value=-20,o.knee.value=16,o.ratio.value=5,o.attack.value=.01,o.release.value=.25;const l=n.createGain();return l.gain.value=1.08,r.connect(s).connect(i).connect(o).connect(l).connect(n.destination),()=>{r.disconnect(),s.disconnect(),i.disconnect(),o.disconnect(),l.disconnect()}},[t]),g.jsx("audio",{ref:e,autoPlay:!0,playsInline:!0,muted:!0})},m2=({count:t})=>typeof t!="number"||t<=0?null:g.jsxs("span",{className:"view-pill",children:[t," viewers"]}),$h=({formationCode:t,players:e,compact:n=!1,limit:r})=>{const s=Bh(t);if(!s)return null;const i=Kw(s,r??s.slots.length),o=new Map(e.filter(l=>l.slotId).map(l=>[l.slotId,l]));return g.jsxs("div",{className:`soccer-pitch ${n?"compact":""}`,children:[g.jsxs("div",{className:"pitch-lines",children:[g.jsx("span",{className:"pitch-line center-line"}),g.jsx("span",{className:"pitch-line center-circle"}),g.jsx("span",{className:"pitch-line penalty-box top"}),g.jsx("span",{className:"pitch-line penalty-box bottom"})]}),i.map(l=>{const u=o.get(l.id);return g.jsxs("div",{className:`soccer-slot ${u?"filled":""}`,style:{left:`${l.x}%`,top:`${l.y}%`},children:[g.jsx("span",{className:"label",children:l.label}),u&&g.jsx("strong",{children:u.playerName})]},l.id)})]})},zh=({sport:t,slots:e,players:n,compact:r=!1})=>{const s=new Map(n.filter(i=>i.slotId).map(i=>[i.slotId,i]));return g.jsx("div",{className:`sport-board ${t} ${r?"compact":""}`,children:e.map(i=>{const o=s.get(i.id);return g.jsxs("div",{className:`sport-slot ${o?"filled":""}`,style:{left:`${i.x}%`,top:`${i.y}%`},children:[g.jsx("span",{className:"label",children:i.label}),o&&g.jsx("strong",{children:o.playerName})]},i.id)})})},Yw=({sport:t,formationCode:e,players:n,limit:r,compact:s})=>{if(t==="soccer"&&e)return g.jsx($h,{formationCode:e,players:n,compact:s,limit:r});if(t==="cricket")return null;if(t==="basketball"||t==="football"||t==="rugby"){const i=_o(t,r);return g.jsx(zh,{sport:t,slots:i,players:n,compact:s})}return null},fl=({label:t,value:e})=>g.jsxs("div",{className:"info-card",children:[g.jsx("span",{children:t}),g.jsx("strong",{children:e})]}),g2=({auction:t,participants:e,selfParticipant:n,notify:r,voiceControl:s,audioEnabled:i,onToggleAudio:o})=>{var Q,Y,X,me;const l=D.useMemo(()=>Oi(t.categories),[t.categories]),u=D.useMemo(()=>{const N=new Map;return e.forEach(K=>N.set(K.id,Fr(K,t,"default"))),N},[e,t]),c=(n==null?void 0:n.participating)===!1,d=t.manualPlayer??l[t.currentPlayerIndex]??null,p=!!t.manualPlayer,{msRemaining:m}=pP(t.countdownEndsAt),v=D.useMemo(()=>{var N;return d?typeof((N=t.activeBid)==null?void 0:N.amount)=="number"?Math.max(d.basePrice,t.activeBid.amount+1):d.basePrice:0},[d==null?void 0:d.key,d==null?void 0:d.basePrice,(Q=t.activeBid)==null?void 0:Q.amount]),[R,b]=D.useState(()=>d?String(v):"");D.useEffect(()=>{var re;if(!d){b("");return}const N=(re=t.activeBid)==null?void 0:re.amount,K=typeof N=="number"?Math.max(d.basePrice,N+1):d.basePrice;b(String(K))},[d==null?void 0:d.key]),D.useEffect(()=>{d&&b(N=>{if(!N)return N;const K=Number(N);return!Number.isFinite(K)||K<v?String(v):N})},[v,d==null?void 0:d.key]);const V=(n==null?void 0:n.role)==="admin",w=(Y=t.activeBid)==null?void 0:Y.bidderId,E=!!(w&&w===(n==null?void 0:n.id)),x=t.skipVotes??[],L=t.activeBid?x.filter(N=>N!==w).length:x.length,z=t.activeBid?Math.max(t.participantCount-1,1):Math.max(t.participantCount,1),B=t.activeBid?"Pass":"Skip",S=Math.max(z-L,0),_=D.useMemo(()=>{const N=new Map;return(t.completedPlayers??[]).forEach(K=>N.set(K.id,K)),N},[t.completedPlayers]),C=D.useMemo(()=>l.map((N,K)=>{const re=_.get(N.key);if(K<t.currentPlayerIndex){const be=re!=null&&re.winnerId&&u.get(re.winnerId)?u.get(re.winnerId):(re==null?void 0:re.winnerAlias)??(re==null?void 0:re.winnerName)??"Unknown",Jt=(re==null?void 0:re.result)==="sold"?`Sold to ${be} (${We((re==null?void 0:re.finalBid)??0)})`:"Unsold";return{slot:N,status:Jt,tone:(re==null?void 0:re.result)==="sold"?"sold":"unsold"}}return K===t.currentPlayerIndex&&!p?{slot:N,status:t.isPaused?"Paused":"Live now",tone:"live"}:{slot:N,status:K===t.currentPlayerIndex+1?"Next up":"Queued",tone:"upcoming"}}),[l,t.currentPlayerIndex,_,t.isPaused,p]),I=async()=>{if(!(!n||c||!d||t.isPaused))try{const N=Number(R||"0");if(!N||N<v){r("error",`Bid at least ${We(v)}.`);return}await GP({auctionId:t.id,clientId:n.id,bidderName:Fr(n,t,"default"),amount:N})}catch(N){r("error",N.message)}},A=async()=>{if(!(!n||c||!d||t.isPaused))try{await KP({auctionId:t.id,clientId:n.id})}catch(N){r("error",N.message)}},k=async()=>{if(V)try{t.isPaused?await YP(t.id):await QP(t.id)}catch(N){r("error",N.message)}},T=async()=>{if(V)try{await gc({auctionId:t.id,forceUnsold:!t.activeBid})}catch(N){r("error",N.message)}},oe=async()=>{if(!(!V||t.finalizationOpen)){if(t.status!=="ended"){r("error","Finish the auction before opening final teams.");return}try{await ZP(t.id),r("success","Final team selection opened for everyone.")}catch(N){r("error",N.message)}}},G=async N=>{try{await e2({auctionId:t.id,completedPlayerId:N}),r("success","Player moved back to the block.")}catch(K){r("error",K.message)}},ne=(n==null?void 0:n.roster)??[],fe=D.useMemo(()=>ne.map((N,K)=>({...N,key:`${N.playerName}-${K}`})),[ne]),[$,te]=D.useState([]),[H,ce]=D.useState(null);D.useEffect(()=>{te(fe.map(N=>N.key))},[fe]);const le=$.map(N=>fe.find(K=>K.key===N)).filter(Boolean),de=N=>{ce(N)},$e=N=>{N.preventDefault()},At=N=>{!H||H===N||(te(K=>{const re=K.indexOf(H),be=K.indexOf(N);if(re===-1||be===-1)return K;const Jt=[...K],[Ft]=Jt.splice(re,1);return Jt.splice(be,0,Ft),Jt}),ce(null))},gt=e.filter(N=>N.id!==(n==null?void 0:n.id)&&N.participating!==!1),rt=D.useMemo(()=>(t.completedPlayers??[]).filter(N=>N.result==="unsold"),[t.completedPlayers]),gn=D.useMemo(()=>(t.completedPlayers??[]).filter(N=>N.result==="sold"&&typeof N.finalBid=="number"),[t.completedPlayers]),Yt=D.useMemo(()=>gn.length<3?null:gn.reduce((N,K)=>N?K.finalBid>(N.finalBid??0)?K:N:K,gn[0]),[gn]),pe=(Yt==null?void 0:Yt.id)??null,Re=D.useRef(null),bt=D.useRef(null),yt=D.useRef(null),_t=D.useCallback(N=>{i&&Hw(N).catch(()=>{})},[i]);D.useEffect(()=>{!i||!d||d.key!==Re.current&&(Re.current=d.key,bt.current=null,_t(`Now drafting ${d.name}`))},[i,d==null?void 0:d.key,d==null?void 0:d.name,_t]),D.useEffect(()=>{if(!i||!d||!t.activeBid||t.activeBid.bidderId===(n==null?void 0:n.id))return;const N=`${d.key}-${t.activeBid.amount}`;N!==bt.current&&(bt.current=N,_t(`${d.name} going for ${We(t.activeBid.amount)}`))},[i,(X=t.activeBid)==null?void 0:X.amount,(me=t.activeBid)==null?void 0:me.bidderId,d==null?void 0:d.key,_t,n==null?void 0:n.id]),D.useEffect(()=>{i||(Re.current=null,bt.current=null)},[i]);const zn=D.useCallback(N=>{if(!i)return;const K=jh();if(!K)return;const re=K.currentTime;N.forEach((be,Jt)=>{const Ft=K.createOscillator(),kn=K.createGain();Ft.type="sine",Ft.frequency.value=be,Ft.connect(kn).connect(K.destination);const ss=re+Jt*.15,ji=ss+.3;kn.gain.setValueAtTime(1e-4,ss),kn.gain.linearRampToValueAtTime(.08,ss+.05),kn.gain.exponentialRampToValueAtTime(1e-4,ji),Ft.start(ss),Ft.stop(ji)})},[i]);D.useEffect(()=>{if(!i)return;const N=t.completedPlayers??[];if(!N.length)return;const K=N[N.length-1];!K||K.id===yt.current||(K.result==="sold"?zn([720,880,1040]):K.result==="unsold"&&zn([420,310]),yt.current=K.id)},[i,t.completedPlayers,zn]);const cr=t.isPaused||!d?t.isPaused?"PAUSED":"--:--":UP(m),ns=!n||c||!d||t.isPaused||E,rs=D.useMemo(()=>C.map((N,K)=>({...N,queueIndex:K})),[C]),dr=rs.filter(N=>N.queueIndex<t.currentPlayerIndex),Rn=dr.slice(-2),js=dr.slice(0,Math.max(0,dr.length-Rn.length)),Li=Math.max(t.currentPlayerIndex+(p?0:1),0),hr=rs.filter(N=>N.queueIndex>=Li),qn=[];if(d)if(!p&&t.currentPlayerIndex>=0){const N=rs.find(K=>K.queueIndex===t.currentPlayerIndex);N&&qn.push(N)}else qn.push({slot:d,status:t.isPaused?"Paused":"Live now",tone:t.isPaused?"paused":"live",queueIndex:-1});const xn=[],Ve=(N,K)=>{K.length&&(xn.push({kind:"label",text:N}),K.forEach(re=>xn.push({kind:"entry",entry:re})))};Ve("Recent picks",Rn),Ve("Now drafting",qn),Ve("Upcoming",hr),Ve("Earlier picks",js);const M=le.length;return g.jsxs("section",{className:"panel-card live-board",children:[g.jsxs("div",{className:"deck-card",children:[g.jsxs("div",{className:"deck-head",children:[g.jsxs("div",{className:"deck-copy",children:[g.jsx("p",{className:"eyebrow",children:"On deck"}),g.jsxs("div",{className:"deck-title-row",children:[g.jsx("h2",{children:d?d.name:"No players left"}),g.jsx("button",{type:"button",className:`audio-toggle ${i?"active":""}`,onClick:o,"aria-label":i?"Mute auction announcer":"Enable auction announcer",children:g.jsx("span",{"aria-hidden":"true",children:i?"":""})})]}),d&&g.jsxs("p",{children:["Category ",d.categoryLabel," - Base ",We(d.basePrice)]}),p&&g.jsx("p",{className:"muted-label",children:"Re-auctioning an unsold player"})]}),g.jsx(Ts,{control:s,variant:"inline"})]}),g.jsxs("div",{className:"timer-display deck-timer",children:[g.jsx("span",{children:"Time left"}),g.jsx("strong",{children:cr})]}),V&&g.jsxs("div",{className:"admin-controls",children:[g.jsx("button",{className:"btn ghost",onClick:k,children:t.isPaused?"Resume auction":"Pause auction"}),g.jsx("button",{className:"btn text",onClick:T,children:"Next player"}),g.jsx("button",{className:"btn accent",onClick:oe,disabled:t.finalizationOpen||t.status!=="ended",children:t.finalizationOpen?"Final teams live":"Go to final teams"})]})]}),g.jsxs("div",{className:"bid-card",children:[g.jsxs("div",{className:"bid-header",children:[g.jsx("h3",{children:"Current bid"}),t.activeBid?g.jsxs("p",{children:[We(t.activeBid.amount)," by ",t.activeBid.bidderName]}):g.jsx("p",{children:"No bids yet"})]}),g.jsxs("div",{className:"bid-inputs",children:[g.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:d?String(d.basePrice):"",value:d?R:"",disabled:ns,onChange:N=>b(N.target.value.replace(/[^0-9]/g,"").replace(/^0+(?=\d)/,""))}),g.jsx("button",{className:"btn accent",disabled:ns,onClick:I,children:"Place bid"}),g.jsx("button",{className:"btn ghost",disabled:ns,onClick:()=>b(N=>{const K=Number(N),re=v||(d==null?void 0:d.basePrice)||0,be=Number.isFinite(K)&&K>0?K+1:re+1;return String(be)}),children:"+1"}),g.jsx("button",{className:"btn outline",disabled:!n||!d||t.isPaused||E,onClick:A,children:B})]}),g.jsx("p",{className:"muted-label",children:S===0?"Waiting for confirmation...":`${S} more ${B.toLowerCase()}${S===1?"":"s"} needed`}),E&&g.jsx("p",{className:"muted-label",children:"You already hold the top bid. Let someone else raise."}),t.isPaused&&g.jsx("p",{className:"muted-label",children:"Auction is paused."})]}),g.jsxs("div",{className:"roster-grid live-roster",children:[g.jsxs("div",{className:"team-card",children:[g.jsxs("div",{className:"team-card__header",children:[g.jsx("h3",{children:c?"Host mode":"My Team"}),!c&&g.jsxs("span",{children:[We((n==null?void 0:n.budgetRemaining)??0)," left, ",M," signed"]})]}),c?g.jsx("p",{className:"muted-label",children:"You're spectating this auction. Use admin controls to run the show."}):g.jsxs("ul",{className:"team-roster",children:[le.length===0&&g.jsx("li",{children:"No players yet."}),le.map((N,K)=>g.jsxs("li",{draggable:!0,onDragStart:()=>de(N.key),onDragOver:$e,onDrop:()=>At(N.key),className:H===N.key?"dragging":"",children:[g.jsx("span",{className:"player-name",children:N.playerName}),g.jsx("span",{className:"player-price",children:We(N.price)})]},N.key))]})]}),g.jsxs("div",{className:"team-card",children:[g.jsx("div",{className:"team-card__header",children:g.jsx("h3",{children:"Other Teams"})}),g.jsxs("ul",{className:"coach-summary",children:[gt.map(N=>g.jsxs("li",{children:[g.jsx("strong",{children:Fr(N,t,"default")}),g.jsxs("div",{children:[g.jsxs("span",{children:[We(N.budgetRemaining)," left"]}),g.jsxs("span",{children:[Math.max(t.playersPerTeam-N.playersNeeded,0)," signed"]})]})]},N.id)),gt.length===0&&g.jsx("li",{children:"No other teams yet."})]})]})]}),g.jsxs("div",{className:"player-order-card draft-board",children:[g.jsx("div",{className:"draft-header",children:g.jsx("h3",{children:"Full player list"})}),g.jsxs("ol",{className:"player-order-list",children:[xn.length===0&&g.jsx("li",{className:"ledger-label",children:"No players queued."}),xn.map((N,K)=>N.kind==="label"?g.jsx("li",{className:"ledger-label",children:N.text},`label-${K}`):g.jsxs("li",{className:`player-table ${N.entry.tone??""} ${pe&&N.entry.slot.key===pe?"record":""}`,children:[g.jsxs("div",{children:[g.jsxs("strong",{children:[N.entry.queueIndex!=null&&N.entry.queueIndex>=0?`${N.entry.queueIndex+1}. `:"",N.entry.slot.name]}),g.jsxs("p",{children:["Cat ",N.entry.slot.categoryLabel," - Base ",We(N.entry.slot.basePrice)]}),pe&&N.entry.slot.key===pe&&g.jsx("span",{className:"record-flag",children:"Most expensive pick"})]}),g.jsx("span",{children:N.entry.status})]},`${N.entry.slot.key}-${N.entry.queueIndex}`))]})]}),V&&rt.length>0&&g.jsxs("div",{className:"player-order-card",children:[g.jsx("h3",{children:"Unsold players"}),g.jsx("p",{className:"muted-label",children:"Bring someone back for a re-auction."}),g.jsx("ul",{className:"participant-list compact",children:rt.map(N=>g.jsxs("li",{children:[g.jsxs("div",{children:[g.jsx("strong",{children:N.playerName}),g.jsxs("p",{children:["Cat ",N.categoryLabel]})]}),g.jsx("button",{className:"btn outline",disabled:!!t.manualPlayer,onClick:()=>G(N.id),children:"Re-open"})]},N.id))})]})]})},y2=({auction:t,participants:e,selfParticipant:n,notify:r,voiceControl:s})=>{var Ve;const i=(n==null?void 0:n.roster)??[],o=(n==null?void 0:n.finalRoster)??[],l=(n==null?void 0:n.finalRosterSport)??"cricket",u=(n==null?void 0:n.finalRosterFormation)??null,c=t.playersPerTeam,d=D.useMemo(()=>i.map((M,Q)=>({...M,key:`${M.playerName}-${Q}`})),[i]),[p,m]=D.useState(o.length?l:"soccer"),v=[{value:"soccer",label:"Soccer"},{value:"cricket",label:"Cricket"},{value:"basketball",label:"Basketball"},{value:"football",label:"Football"},{value:"rugby",label:"Rugby"}],R=D.useMemo(()=>Array.from({length:c}).map((M,Q)=>({id:`cricket-${Q}`,label:i2[Q]??`Player ${Q+1}`})),[c]),[b,V]=D.useState({}),[w,E]=D.useState(null);D.useEffect(()=>{V(M=>{const Q={};return R.forEach(Y=>{Q[Y.id]=M[Y.id]??null}),Q}),E(M=>M&&R.some(Q=>Q.id===M)?M:null)},[R]);const x=l==="basketball"&&u?u.code:Gn.basketball.formations[0].code,L=l==="football"&&u?u.code:Gn.football.formations[0].code,z=l==="rugby"&&u?u.code:Gn.rugby.formations[0].code,[B,S]=D.useState(x),[_,C]=D.useState(L),[I,A]=D.useState(z),k=D.useMemo(()=>_o("basketball",c,B),[c,B]),T=D.useMemo(()=>_o("football",c,_),[c,_]),oe=D.useMemo(()=>_o("rugby",c,I),[c,I]),[G,ne]=D.useState(()=>qs(k)),[fe,$]=D.useState(()=>qs(T)),[te,H]=D.useState(()=>qs(oe));D.useEffect(()=>{ne(M=>qs(k,M))},[k]),D.useEffect(()=>{$(M=>qs(T,M))},[T]),D.useEffect(()=>{H(M=>qs(oe,M))},[oe]);const ce=(M,Q)=>{V(Y=>{const X={...Y},me=Q||"";return me&&Object.entries(X).forEach(([N,K])=>{N!==M&&K===me&&(X[N]=null)}),X[M]=me||null,X})},le=M=>{E(Q=>Q===M?null:M)},de=D.useMemo(()=>R.every(M=>!!b[M.id]),[R,b]),$e=D.useMemo(()=>k.every(M=>!!G[M.id]),[k,G]),At=D.useMemo(()=>T.every(M=>!!fe[M.id]),[T,fe]),gt=D.useMemo(()=>oe.every(M=>!!te[M.id]),[oe,te]),rt=D.useCallback((M,Q)=>{const Y=Bh(M),X={};return((Y==null?void 0:Y.slots)??[]).forEach(me=>{X[me.id]=(Q==null?void 0:Q[me.id])??null}),X},[]),gn=l==="soccer"&&u?u.code:Fh[0].code,[Yt,pe]=D.useState(gn),[Re,bt]=D.useState(()=>rt(gn));D.useEffect(()=>{bt(M=>rt(Yt,M))},[Yt,rt]);const yt=Bh(Yt),_t=D.useMemo(()=>Kw(yt,c),[yt==null?void 0:yt.code,c]),zn=(M,Q)=>{bt(Y=>{const X={...Y},me=Q||null;return me&&Object.entries(X).forEach(([N,K])=>{N!==M&&K===me&&(X[N]=null)}),X[M]=me,X})},cr=(M,Q,Y)=>{M(X=>{const me={...X},N=Y||"";return N&&Object.entries(me).forEach(([K,re])=>{K!==Q&&re===N&&(me[K]=null)}),me[Q]=N||null,me})},ns=(M,Q,Y)=>{switch(M){case"basketball":cr(ne,Q,Y);break;case"football":cr($,Q,Y);break;case"rugby":cr(H,Q,Y);break}},rs=D.useCallback((M,Q)=>M.map(Y=>{const X=Q[Y.id];if(!X)return null;const me=d.find(N=>N.key===X);return me?{playerName:me.playerName,categoryLabel:me.categoryLabel,price:me.price,slotId:Y.id,slotLabel:Y.label}:null}).filter(Boolean),[d]),dr=M=>{const{slots:Q,assignments:Y,formationCode:X,setFormation:me}=Rn(M),N=rs(Q,Y),K=d.length<Q.length;return g.jsxs("div",{className:"sport-builder",children:[g.jsxs("div",{className:"formation-select",children:[g.jsx("label",{htmlFor:`${M}-formation`,children:"Formation"}),g.jsx("select",{id:`${M}-formation`,value:X,onChange:re=>me(re.target.value),children:Gn[M].formations.map(re=>g.jsx("option",{value:re.code,children:re.label},re.code))})]}),g.jsx(zh,{sport:M,slots:Q,players:N}),g.jsxs("div",{className:"formation-editor",children:[K&&g.jsxs("p",{className:"muted-label warning",children:["Need ",Q.length," players to fill this layout. You currently have ",d.length,"."]}),g.jsx("ul",{children:Q.map(re=>g.jsxs("li",{children:[g.jsx("span",{children:re.label}),g.jsxs("select",{value:Y[re.id]??"",onChange:be=>ns(M,re.id,be.target.value),children:[g.jsx("option",{value:"",children:"Unassigned"}),d.map(be=>{const Jt=Y[re.id]!==be.key&&Object.values(Y).includes(be.key);return g.jsxs("option",{value:be.key,disabled:Jt,children:[be.playerName," - ",We(be.price)]},be.key)})]})]},re.id))})]})]})},Rn=M=>{switch(M){case"basketball":return{slots:k,assignments:G,setAssignments:ne,filled:$e,formationCode:B,setFormation:S};case"football":return{slots:T,assignments:fe,setAssignments:$,filled:At,formationCode:_,setFormation:C};case"rugby":return{slots:oe,assignments:te,setAssignments:H,filled:gt,formationCode:I,setFormation:A};default:return{slots:[],assignments:{},setAssignments:()=>{},filled:!1,formationCode:"",setFormation:()=>{}}}},js=D.useMemo(()=>_t.map(M=>{const Q=Re[M.id];if(!Q)return null;const Y=d.find(X=>X.key===Q);return Y?{playerName:Y.playerName,categoryLabel:Y.categoryLabel,price:Y.price,tag:M.label,slotId:M.id,slotLabel:M.label}:null}).filter(Boolean),[d,Re,yt]),Li=_t.every(M=>!!Re[M.id]),hr=d.length<_t.length,qn=async()=>{if(!n)return;if(p==="soccer"){if(!yt){r("error","Select a formation.");return}if(hr){r("error",`You need ${_t.length} players for this formation.`);return}if(!Li){r("error","Assign every position before submitting.");return}}else if(p==="cricket"){if(!de){r("error","Assign every batting slot before submitting.");return}}else if(!Rn(p).filled){r("error","Assign every position before submitting.");return}let M=[],Q,Y;if(p==="soccer"&&yt)M=_t.map(X=>{const me=Re[X.id],N=d.find(K=>K.key===me);if(!N)throw new Error("Missing player assignment.");return{playerName:N.playerName,categoryLabel:N.categoryLabel,price:N.price,tag:X.label,slotId:X.id,slotLabel:X.label}}),Q=yt.code,Y=yt.label;else if(p==="cricket")M=R.map(X=>{const me=b[X.id],N=d.find(K=>K.key===me);if(!N)throw new Error("Missing player assignment.");return{playerName:N.playerName,categoryLabel:N.categoryLabel,price:N.price,slotId:X.id,slotLabel:X.label,tag:w===X.id?"WK":""}});else{const X=p,{slots:me,assignments:N,formationCode:K}=Rn(X);M=me.map(be=>{const Jt=N[be.id],Ft=d.find(kn=>kn.key===Jt);if(!Ft)throw new Error("Missing player assignment.");return{playerName:Ft.playerName,categoryLabel:Ft.categoryLabel,price:Ft.price,slotId:be.id,slotLabel:be.label}});const re=Qw(X,K);Q=re==null?void 0:re.code,Y=(re==null?void 0:re.label)??Gn[X].displayLabel}try{await XP({auctionId:t.id,clientId:n.id,finalRoster:M,sport:p,formationCode:Q,formationLabel:Y}),r("success","Final squad locked in.")}catch(X){r("error",X.message)}},xn=e.filter(M=>M.id!==(n==null?void 0:n.id)&&M.participating!==!1);if((n==null?void 0:n.participating)===!1)return g.jsxs("section",{className:"panel-card",children:[g.jsx(Ts,{control:s}),g.jsx("h2",{children:"Host overview"}),g.jsx("p",{className:"muted-label",children:"You're running this auction but not submitting a lineup. Track everyone else's picks and wait for them to finish."}),g.jsxs("div",{className:"roster-card",style:{marginTop:"1.5rem"},children:[g.jsx("h3",{children:"Players"}),g.jsx("ul",{className:"participant-list",children:e.filter(M=>M.participating!==!1).map(M=>g.jsx("li",{children:g.jsxs("div",{children:[g.jsx("strong",{children:Fr(M,t,"default")}),g.jsxs("p",{children:[M.roster.length," picks"]})]})},M.id))})]})]});if(o.length>0){const M=l==="soccer"&&u,Q=l!=="soccer"&&l!=="cricket"&&!!o.length;return g.jsxs("section",{className:"panel-card",children:[g.jsx(Ts,{control:s}),g.jsx("h2",{children:"Your final squad"}),M?g.jsxs(g.Fragment,{children:[g.jsx("p",{className:"muted-label",children:u==null?void 0:u.label}),g.jsx($h,{formationCode:u.code,players:o,limit:c}),g.jsx("ul",{className:"mini-roster",children:o.map((Y,X)=>g.jsxs("li",{children:[Y.slotLabel??Y.tag??`#${X+1}`," - ",Y.playerName]},`${Y.playerName}-${X}`))})]}):Q?g.jsxs(g.Fragment,{children:[g.jsx("p",{className:"muted-label",children:((Ve=Gn[l])==null?void 0:Ve.displayLabel)??"Formation"}),g.jsx(zh,{sport:l,slots:_o(l,c),players:o}),g.jsx("ul",{className:"price-list",children:o.map((Y,X)=>g.jsxs("li",{children:[g.jsx("strong",{children:Y.playerName}),g.jsx("span",{className:"price-value",children:We(Y.price)})]},`${Y.playerName}-${X}`))})]}):g.jsx("ul",{className:"price-list",children:o.map((Y,X)=>g.jsxs("li",{children:[g.jsx("strong",{children:Y.playerName}),g.jsxs("span",{className:"price-value",children:[We(Y.price),Y.tag==="WK"&&g.jsx("em",{className:"wk-badge",children:"WK"})]})]},`${Y.playerName}-${X}`))}),g.jsxs("div",{className:"roster-card",style:{marginTop:"1.5rem"},children:[g.jsx("h3",{children:"Others"}),g.jsx("ul",{className:"participant-list",children:xn.map(Y=>{var X,me,N;return g.jsxs("li",{children:[g.jsxs("div",{children:[g.jsx("strong",{children:Fr(Y,t,"default")}),g.jsxs("p",{children:[((X=Y.finalRoster)==null?void 0:X.length)??Y.roster.length," picks"," ",Y.hasSubmittedTeam?"(Submitted)":""]})]}),g.jsx("span",{children:Y.hasSubmittedTeam?Y.finalRosterSport==="soccer"?((me=Y.finalRosterFormation)==null?void 0:me.label)??"Soccer":Y.finalRosterSport==="cricket"?"Cricket":((N=Gn[Y.finalRosterSport])==null?void 0:N.displayLabel)??"Lineup":"Pending"})]},Y.id)})})]})]})}return g.jsxs("section",{className:"panel-card",children:[g.jsx(Ts,{control:s}),g.jsxs("h2",{children:["Lock your final ",c]}),g.jsx("p",{className:"muted-label",children:"Switch between cricket order or stadium boards for other sports."}),g.jsx("div",{className:"sport-toggle",children:v.map(M=>g.jsx("button",{className:`btn ghost ${p===M.value?"active":""}`,onClick:()=>m(M.value),type:"button",children:M.label},M.value))}),p==="cricket"?g.jsxs("div",{className:"cricket-builder",children:[g.jsx("div",{className:"formation-editor",children:g.jsx("ul",{children:R.map(M=>{const Q=b[M.id]??"",Y=X=>Object.entries(b).some(([me,N])=>me!==M.id&&N===X);return g.jsxs("li",{children:[g.jsxs("div",{className:"cricket-slot-head",children:[g.jsx("strong",{children:M.label}),g.jsxs("label",{className:`wk-toggle ${w===M.id?"active":""}`,children:[g.jsx("input",{type:"radio",name:"wk-slot",checked:w===M.id,onChange:()=>le(M.id)}),"WK"]})]}),g.jsxs("select",{value:Q??"",onChange:X=>ce(M.id,X.target.value),children:[g.jsx("option",{value:"",children:"Select player"}),d.map(X=>g.jsxs("option",{value:X.key,disabled:Y(X.key),children:[X.playerName," - ",We(X.price)]},X.key))]})]},M.id)})})}),g.jsxs("div",{className:"player-pool",children:[g.jsx("h3",{children:"Player pool"}),g.jsx("ul",{children:d.map(M=>{const Q=Object.values(b).includes(M.key);return g.jsxs("li",{className:Q?"assigned":"",children:[M.playerName," - ",We(M.price)," ",Q?"(Placed)":""]},M.key)})})]})]}):p==="soccer"?g.jsxs("div",{className:"soccer-builder",children:[g.jsxs("div",{className:"formation-select",children:[g.jsx("label",{htmlFor:"formation-select",children:"Formation"}),g.jsx("select",{id:"formation-select",value:Yt,onChange:M=>pe(M.target.value),children:Fh.map(M=>g.jsx("option",{value:M.code,children:M.label},M.code))}),hr&&g.jsxs("p",{className:"muted-label warning",children:["Need ",_t.length," players to fill this formation. You currently have"," ",d.length,"."]})]}),g.jsxs("div",{className:"soccer-layout",children:[g.jsx($h,{formationCode:Yt,players:js,limit:c}),g.jsx("div",{className:"formation-editor",children:g.jsx("ul",{children:_t.map(M=>g.jsxs("li",{children:[g.jsx("span",{children:M.label}),g.jsxs("select",{value:Re[M.id]??"",onChange:Q=>zn(M.id,Q.target.value),children:[g.jsx("option",{value:"",children:"Unassigned"}),d.map(Q=>{const Y=Re[M.id]!==Q.key&&Object.values(Re).includes(Q.key);return g.jsxs("option",{value:Q.key,disabled:Y,children:[Q.playerName," - ",We(Q.price)]},Q.key)})]})]},M.id))})})]}),g.jsxs("div",{className:"player-pool",children:[g.jsx("h3",{children:"Player pool"}),g.jsx("ul",{children:d.map(M=>{const Q=Object.values(Re).includes(M.key);return g.jsxs("li",{className:Q?"assigned":"",children:[M.playerName," - ",We(M.price)," ",Q?"(Placed)":""]},M.key)})})]})]}):dr(p),g.jsx("button",{className:"btn accent",disabled:n==null?void 0:n.hasSubmittedTeam,onClick:qn,children:n!=null&&n.hasSubmittedTeam?"Submitted":"Submit team"}),g.jsxs("div",{className:"roster-card",style:{marginTop:"1.5rem"},children:[g.jsx("h3",{children:"Others"}),g.jsx("ul",{className:"participant-list",children:xn.map(M=>{var Q,Y,X;return g.jsxs("li",{children:[g.jsxs("div",{children:[g.jsx("strong",{children:Fr(M,t,"default")}),g.jsxs("p",{children:[((Q=M.finalRoster)==null?void 0:Q.length)??M.roster.length," picks"," ",M.hasSubmittedTeam?"(Submitted)":""]})]}),g.jsx("span",{children:M.hasSubmittedTeam?M.finalRosterSport==="soccer"?((Y=M.finalRosterFormation)==null?void 0:Y.label)??"Soccer":M.finalRosterSport==="cricket"?"Cricket":((X=Gn[M.finalRosterSport])==null?void 0:X.displayLabel)??"Lineup":"Pending"})]},M.id)})})]})]})},_2=({auction:t,participants:e,selfParticipant:n,notify:r,voiceControl:s})=>{const i=e.filter(d=>d.id!==(n==null?void 0:n.id)&&d.participating!==!1),[o,l]=D.useState(i.map(d=>d.id));D.useEffect(()=>{l(i.map(d=>d.id))},[i.map(d=>d.id).join(":")]);const u=(d,p)=>{l(m=>{const v=[...m],R=d+p;return R<0||R>=v.length?m:([v[d],v[R]]=[v[R],v[d]],v)})},c=async()=>{if(n)try{await t2({auctionId:t.id,clientId:n.id,rankingOrder:o}),r("success","Ranking submitted.")}catch(d){r("error",d.message)}};return g.jsxs("section",{className:"panel-card",children:[g.jsx(Ts,{control:s}),g.jsx("h2",{children:"Rank others"}),g.jsx("p",{children:"Move cards to reorder. Top pick earns the most points."}),g.jsx("ol",{className:"ranking-list",children:o.map((d,p)=>{var b,V;const m=e.find(w=>w.id===d);if(!m)return null;const v=m.finalRoster&&m.finalRoster.length?m.finalRoster:m.roster,R=m.finalRosterSport!=="cricket"&&!!((b=m.finalRoster)!=null&&b.length);return g.jsxs("li",{children:[g.jsxs("div",{children:[g.jsxs("strong",{children:["#",p+1," ",Fr(m,t,"default")]}),R?g.jsx("div",{className:"ranking-formation",children:g.jsx(Yw,{sport:m.finalRosterSport??"cricket",formationCode:((V=m.finalRosterFormation)==null?void 0:V.code)??null,players:m.finalRoster??[],limit:t.playersPerTeam,compact:m.finalRosterSport!=="soccer"})}):g.jsx("ul",{className:"price-list",children:v.map((w,E)=>g.jsxs("li",{children:[g.jsx("strong",{children:w.playerName}),g.jsxs("span",{className:"price-value",children:[We(w.price),"tag"in w&&w.tag==="WK"&&g.jsx("em",{className:"wk-badge",children:"WK"})]})]},`${w.playerName}-${E}`))})]}),g.jsxs("div",{className:"rank-actions",children:[g.jsx("button",{className:"btn ghost",onClick:()=>u(p,-1),children:"Up"}),g.jsx("button",{className:"btn ghost",onClick:()=>u(p,1),children:"Down"})]})]},d)})}),g.jsx("button",{className:"btn accent",disabled:n==null?void 0:n.rankingSubmitted,onClick:c,children:n!=null&&n.rankingSubmitted?"Submitted":"Submit ranking"}),g.jsxs("div",{className:"ranking-status",children:[g.jsx("h3",{children:"Status"}),g.jsx("ul",{children:e.filter(d=>d.participating!==!1).map(d=>g.jsxs("li",{children:[Fr(d,t,"default")," ","-"," ",d.id===(n==null?void 0:n.id)?n.rankingSubmitted?"Done":"Waiting on you":d.rankingSubmitted?"Submitted":"Pending"]},d.id))})]})]})},v2=({auction:t,participants:e,voiceControl:n})=>{const r=t.results??[];return g.jsxs("section",{className:"panel-card",children:[g.jsx(Ts,{control:n}),g.jsx("h2",{children:"Final leaderboard"}),!r.length&&g.jsx("p",{children:"Waiting for admin to publish results..."}),r.length>0&&g.jsxs("table",{className:"results-table",children:[g.jsx("thead",{children:g.jsxs("tr",{children:[g.jsx("th",{children:"Rank"}),g.jsx("th",{children:"Player"}),g.jsx("th",{children:"Points"}),g.jsx("th",{children:"Budget left"})]})}),g.jsx("tbody",{children:r.map(s=>g.jsxs("tr",{children:[g.jsxs("td",{children:["#",s.rank]}),g.jsx("td",{children:s.name}),g.jsx("td",{children:s.points}),g.jsx("td",{children:We(s.budgetRemaining)})]},s.participantId))})]}),g.jsx("div",{className:"results-rosters",children:e.filter(s=>s.participating!==!1).map(s=>{var l,u;const i=s.finalRoster&&s.finalRoster.length?s.finalRoster:s.roster,o=s.finalRosterSport!=="cricket"&&!!((l=s.finalRoster)!=null&&l.length);return g.jsxs("div",{className:"roster-card",children:[g.jsx("h4",{children:s.name}),g.jsxs("div",{className:`roster-body ${o?"with-board":""}`,children:[o&&s.finalRoster&&g.jsx(Yw,{sport:s.finalRosterSport??"cricket",formationCode:((u=s.finalRosterFormation)==null?void 0:u.code)??null,players:s.finalRoster,limit:t.playersPerTeam}),g.jsx("ul",{className:"price-list",children:i.map((c,d)=>g.jsxs("li",{children:[g.jsx("strong",{children:c.playerName}),g.jsxs("span",{className:"price-value",children:[We(c.price),"tag"in c&&c.tag==="WK"&&g.jsx("em",{className:"wk-badge",children:"WK"})]})]},`${c.playerName}-${d}`))})]})]},s.id)})})]})},E2=(t,e,n,r)=>{const s=(n==null?void 0:n.role)==="admin",i=D.useRef(!1),o=D.useRef(!1),l=D.useRef(!1);D.useEffect(()=>{if(!t||t.status!=="live"||!s)return;const u=setInterval(()=>{!t.countdownEndsAt||i.current||t.countdownEndsAt.toMillis()<=Date.now()&&(i.current=!0,gc({auctionId:t.id,forceUnsold:!t.activeBid}).catch(c=>r("error",c.message)).finally(()=>{i.current=!1}))},1e3);return()=>clearInterval(u)},[t,s,r]),D.useEffect(()=>{if(!t||t.status!=="ended"||!t.finalizationOpen||!s){o.current=!1;return}const u=e.filter(d=>d.participating!==!1);u.length>0&&u.every(d=>d.hasSubmittedTeam)&&!o.current&&(o.current=!0,r2(t.id).catch(d=>r("error",d.message)))},[t,e,s,r]),D.useEffect(()=>{if(!t||t.status!=="ranking"||!s){l.current=!1;return}const u=e.filter(d=>d.participating!==!1);u.length>0&&u.every(d=>d.rankingSubmitted)&&!l.current&&(l.current=!0,n2(t.id).catch(d=>r("error",d.message)))},[t,e,s,r])};md.createRoot(document.getElementById("root")).render(g.jsx(LS.StrictMode,{children:g.jsx(l2,{})}));
